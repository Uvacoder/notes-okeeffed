{"expireTime":9007200849425546000,"key":"gatsby-plugin-mdx-entire-payload-e5b222e28c2592bff0433869b6db637d-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":133,"offset":134},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":136},"end":{"line":5,"column":29,"offset":164},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"USER AUTHENTICATION WITH EXPRESS AND MONGO","position":{"start":{"line":7,"column":1,"offset":166},"end":{"line":7,"column":43,"offset":208},"indent":[]}}],"position":{"start":{"line":7,"column":1,"offset":166},"end":{"line":7,"column":43,"offset":208},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/////////////////////////////////////////////////////////","position":{"start":{"line":9,"column":1,"offset":210},"end":{"line":9,"column":58,"offset":267},"indent":[]}}],"position":{"start":{"line":9,"column":1,"offset":210},"end":{"line":9,"column":58,"offset":267},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"PART 1","position":{"start":{"line":11,"column":1,"offset":269},"end":{"line":11,"column":7,"offset":275},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":269},"end":{"line":11,"column":7,"offset":275},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":13,"column":1,"offset":277},"end":{"line":13,"column":2,"offset":278},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":13,"column":14,"offset":290},"end":{"line":13,"column":18,"offset":294},"indent":[]}}],"position":{"start":{"line":13,"column":12,"offset":288},"end":{"line":13,"column":20,"offset":296},"indent":[]}}],"position":{"start":{"line":13,"column":10,"offset":286},"end":{"line":13,"column":22,"offset":298},"indent":[]}}],"position":{"start":{"line":13,"column":8,"offset":284},"end":{"line":13,"column":24,"offset":300},"indent":[]}}],"position":{"start":{"line":13,"column":6,"offset":282},"end":{"line":13,"column":26,"offset":302},"indent":[]}}],"position":{"start":{"line":13,"column":4,"offset":280},"end":{"line":13,"column":28,"offset":304},"indent":[]}}],"position":{"start":{"line":13,"column":2,"offset":278},"end":{"line":13,"column":30,"offset":306},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":277},"end":{"line":13,"column":30,"offset":306},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":14,"column":3,"offset":309},"end":{"line":14,"column":10,"offset":316},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The Project","position":{"start":{"line":15,"column":7,"offset":323},"end":{"line":15,"column":18,"offset":334},"indent":[]}}],"position":{"start":{"line":15,"column":7,"offset":323},"end":{"line":15,"column":18,"offset":334},"indent":[]}}],"position":{"start":{"line":15,"column":2,"offset":318},"end":{"line":15,"column":18,"offset":334},"indent":[]}}],"position":{"start":{"line":15,"column":2,"offset":318},"end":{"line":15,"column":18,"offset":334},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":307},"end":{"line":15,"column":18,"offset":334},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":16,"column":3,"offset":337},"end":{"line":16,"column":10,"offset":344},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":17,"column":13,"offset":357},"end":{"line":17,"column":17,"offset":361},"indent":[]}}],"position":{"start":{"line":17,"column":11,"offset":355},"end":{"line":17,"column":19,"offset":363},"indent":[]}}],"position":{"start":{"line":17,"column":9,"offset":353},"end":{"line":17,"column":21,"offset":365},"indent":[]}}],"position":{"start":{"line":17,"column":7,"offset":351},"end":{"line":17,"column":23,"offset":367},"indent":[]}}],"position":{"start":{"line":17,"column":5,"offset":349},"end":{"line":17,"column":25,"offset":369},"indent":[]}}],"position":{"start":{"line":17,"column":3,"offset":347},"end":{"line":17,"column":27,"offset":371},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":345},"end":{"line":17,"column":29,"offset":373},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":17,"column":29,"offset":373},"end":{"line":17,"column":30,"offset":374},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":345},"end":{"line":17,"column":30,"offset":374},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":335},"end":{"line":17,"column":30,"offset":374},"indent":[1]}}],"position":{"start":{"line":14,"column":1,"offset":307},"end":{"line":17,"column":30,"offset":374},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Setting up credentials to do what you say you want to do","position":{"start":{"line":19,"column":1,"offset":376},"end":{"line":19,"column":57,"offset":432},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":376},"end":{"line":19,"column":57,"offset":432},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Authentication vs Authorization","position":{"start":{"line":21,"column":1,"offset":434},"end":{"line":21,"column":32,"offset":465},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":434},"end":{"line":21,"column":32,"offset":465},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Authentication: Confirming the user is who they say they are\nAuthorization: Where you are and aren't allow to see certain information","position":{"start":{"line":23,"column":1,"offset":467},"end":{"line":24,"column":73,"offset":600},"indent":[1]}}],"position":{"start":{"line":23,"column":1,"offset":467},"end":{"line":24,"column":73,"offset":600},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Steps:","position":{"start":{"line":26,"column":1,"offset":602},"end":{"line":26,"column":7,"offset":608},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":602},"end":{"line":26,"column":7,"offset":608},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create an account","position":{"start":{"line":28,"column":3,"offset":612},"end":{"line":28,"column":20,"offset":629},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":612},"end":{"line":28,"column":20,"offset":629},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":610},"end":{"line":28,"column":20,"offset":629},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Checks if it matches a record in the database","position":{"start":{"line":29,"column":3,"offset":632},"end":{"line":29,"column":48,"offset":677},"indent":[]}}],"position":{"start":{"line":29,"column":3,"offset":632},"end":{"line":29,"column":48,"offset":677},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":630},"end":{"line":29,"column":48,"offset":677},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":610},"end":{"line":29,"column":48,"offset":677},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"While the user is logged in, they can alter the page depending on the user infomation.","position":{"start":{"line":31,"column":1,"offset":679},"end":{"line":31,"column":87,"offset":765},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":679},"end":{"line":31,"column":87,"offset":765},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Sessions can be used for a db to have \"unique token\" which sticks with you and your device until the end of the session.","position":{"start":{"line":33,"column":1,"offset":767},"end":{"line":33,"column":121,"offset":887},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":767},"end":{"line":33,"column":121,"offset":887},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"//////////////","position":{"start":{"line":35,"column":1,"offset":889},"end":{"line":35,"column":15,"offset":903},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":889},"end":{"line":35,"column":15,"offset":903},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The project uses Express and MongoDB","position":{"start":{"line":37,"column":1,"offset":905},"end":{"line":37,"column":37,"offset":941},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":905},"end":{"line":37,"column":37,"offset":941},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":39,"column":1,"offset":943},"end":{"line":39,"column":2,"offset":944},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":39,"column":14,"offset":956},"end":{"line":39,"column":18,"offset":960},"indent":[]}}],"position":{"start":{"line":39,"column":12,"offset":954},"end":{"line":39,"column":20,"offset":962},"indent":[]}}],"position":{"start":{"line":39,"column":10,"offset":952},"end":{"line":39,"column":22,"offset":964},"indent":[]}}],"position":{"start":{"line":39,"column":8,"offset":950},"end":{"line":39,"column":24,"offset":966},"indent":[]}}],"position":{"start":{"line":39,"column":6,"offset":948},"end":{"line":39,"column":26,"offset":968},"indent":[]}}],"position":{"start":{"line":39,"column":4,"offset":946},"end":{"line":39,"column":28,"offset":970},"indent":[]}}],"position":{"start":{"line":39,"column":2,"offset":944},"end":{"line":39,"column":30,"offset":972},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":943},"end":{"line":39,"column":30,"offset":972},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":40,"column":3,"offset":975},"end":{"line":40,"column":10,"offset":982},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":973},"end":{"line":40,"column":10,"offset":982},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":973},"end":{"line":40,"column":10,"offset":982},"indent":[]}},{"type":"list","ordered":true,"start":2,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Setting up the Project","position":{"start":{"line":41,"column":6,"offset":988},"end":{"line":41,"column":28,"offset":1010},"indent":[]}}],"position":{"start":{"line":41,"column":6,"offset":988},"end":{"line":41,"column":28,"offset":1010},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":983},"end":{"line":41,"column":28,"offset":1010},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":983},"end":{"line":41,"column":28,"offset":1010},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":42,"column":3,"offset":1013},"end":{"line":42,"column":10,"offset":1020},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":43,"column":13,"offset":1033},"end":{"line":43,"column":17,"offset":1037},"indent":[]}}],"position":{"start":{"line":43,"column":11,"offset":1031},"end":{"line":43,"column":19,"offset":1039},"indent":[]}}],"position":{"start":{"line":43,"column":9,"offset":1029},"end":{"line":43,"column":21,"offset":1041},"indent":[]}}],"position":{"start":{"line":43,"column":7,"offset":1027},"end":{"line":43,"column":23,"offset":1043},"indent":[]}}],"position":{"start":{"line":43,"column":5,"offset":1025},"end":{"line":43,"column":25,"offset":1045},"indent":[]}}],"position":{"start":{"line":43,"column":3,"offset":1023},"end":{"line":43,"column":27,"offset":1047},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":1021},"end":{"line":43,"column":29,"offset":1049},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":43,"column":29,"offset":1049},"end":{"line":43,"column":30,"offset":1050},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":1021},"end":{"line":43,"column":30,"offset":1050},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":1011},"end":{"line":43,"column":30,"offset":1050},"indent":[1]}}],"position":{"start":{"line":42,"column":1,"offset":1011},"end":{"line":43,"column":30,"offset":1050},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"npm install body-parser\t\t\t// parsing incoming requests\nnpm install express\nnpm install pug\t\t\t\t\t// used for jade","position":{"start":{"line":45,"column":1,"offset":1052},"end":{"line":47,"column":37,"offset":1163},"indent":[1,1]}}],"position":{"start":{"line":45,"column":1,"offset":1052},"end":{"line":47,"column":37,"offset":1163},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/////////////////////////////////////////////////////////","position":{"start":{"line":49,"column":1,"offset":1165},"end":{"line":49,"column":58,"offset":1222},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":1165},"end":{"line":49,"column":58,"offset":1222},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"PART 2","position":{"start":{"line":51,"column":1,"offset":1224},"end":{"line":51,"column":7,"offset":1230},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":1224},"end":{"line":51,"column":7,"offset":1230},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":53,"column":1,"offset":1232},"end":{"line":53,"column":2,"offset":1233},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":53,"column":14,"offset":1245},"end":{"line":53,"column":18,"offset":1249},"indent":[]}}],"position":{"start":{"line":53,"column":12,"offset":1243},"end":{"line":53,"column":20,"offset":1251},"indent":[]}}],"position":{"start":{"line":53,"column":10,"offset":1241},"end":{"line":53,"column":22,"offset":1253},"indent":[]}}],"position":{"start":{"line":53,"column":8,"offset":1239},"end":{"line":53,"column":24,"offset":1255},"indent":[]}}],"position":{"start":{"line":53,"column":6,"offset":1237},"end":{"line":53,"column":26,"offset":1257},"indent":[]}}],"position":{"start":{"line":53,"column":4,"offset":1235},"end":{"line":53,"column":28,"offset":1259},"indent":[]}}],"position":{"start":{"line":53,"column":2,"offset":1233},"end":{"line":53,"column":30,"offset":1261},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":1232},"end":{"line":53,"column":30,"offset":1261},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":54,"column":3,"offset":1264},"end":{"line":54,"column":10,"offset":1271},"indent":[]}},{"type":"list","ordered":true,"start":3,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Registration","position":{"start":{"line":55,"column":9,"offset":1280},"end":{"line":55,"column":21,"offset":1292},"indent":[]}}],"position":{"start":{"line":55,"column":9,"offset":1280},"end":{"line":55,"column":21,"offset":1292},"indent":[]}}],"position":{"start":{"line":55,"column":4,"offset":1275},"end":{"line":55,"column":21,"offset":1292},"indent":[]}}],"position":{"start":{"line":55,"column":4,"offset":1275},"end":{"line":55,"column":21,"offset":1292},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":1262},"end":{"line":55,"column":21,"offset":1292},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":56,"column":3,"offset":1295},"end":{"line":56,"column":10,"offset":1302},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":57,"column":13,"offset":1315},"end":{"line":57,"column":17,"offset":1319},"indent":[]}}],"position":{"start":{"line":57,"column":11,"offset":1313},"end":{"line":57,"column":19,"offset":1321},"indent":[]}}],"position":{"start":{"line":57,"column":9,"offset":1311},"end":{"line":57,"column":21,"offset":1323},"indent":[]}}],"position":{"start":{"line":57,"column":7,"offset":1309},"end":{"line":57,"column":23,"offset":1325},"indent":[]}}],"position":{"start":{"line":57,"column":5,"offset":1307},"end":{"line":57,"column":25,"offset":1327},"indent":[]}}],"position":{"start":{"line":57,"column":3,"offset":1305},"end":{"line":57,"column":27,"offset":1329},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":1303},"end":{"line":57,"column":29,"offset":1331},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":57,"column":29,"offset":1331},"end":{"line":57,"column":30,"offset":1332},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":1303},"end":{"line":57,"column":30,"offset":1332},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":1293},"end":{"line":57,"column":30,"offset":1332},"indent":[1]}}],"position":{"start":{"line":54,"column":1,"offset":1262},"end":{"line":57,"column":30,"offset":1332},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"// adding routes for registration form","position":{"start":{"line":59,"column":1,"offset":1334},"end":{"line":59,"column":39,"offset":1372},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":1334},"end":{"line":59,"column":39,"offset":1372},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"router.get('/register', function (req, res, next) {\n\treturn res.send('Register today!');\n});","position":{"start":{"line":61,"column":1,"offset":1374},"end":{"line":63,"column":4,"offset":1466},"indent":[1,1]}}],"position":{"start":{"line":61,"column":1,"offset":1374},"end":{"line":63,"column":4,"offset":1466},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"router.post('/register', function (req, res, next) {\n\treturn res.send('User Created!');\n});","position":{"start":{"line":65,"column":1,"offset":1468},"end":{"line":67,"column":4,"offset":1559},"indent":[1,1]}}],"position":{"start":{"line":65,"column":1,"offset":1468},"end":{"line":67,"column":4,"offset":1559},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":69,"column":1,"offset":1561},"end":{"line":69,"column":2,"offset":1562},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":69,"column":14,"offset":1574},"end":{"line":69,"column":18,"offset":1578},"indent":[]}}],"position":{"start":{"line":69,"column":12,"offset":1572},"end":{"line":69,"column":20,"offset":1580},"indent":[]}}],"position":{"start":{"line":69,"column":10,"offset":1570},"end":{"line":69,"column":22,"offset":1582},"indent":[]}}],"position":{"start":{"line":69,"column":8,"offset":1568},"end":{"line":69,"column":24,"offset":1584},"indent":[]}}],"position":{"start":{"line":69,"column":6,"offset":1566},"end":{"line":69,"column":26,"offset":1586},"indent":[]}}],"position":{"start":{"line":69,"column":4,"offset":1564},"end":{"line":69,"column":28,"offset":1588},"indent":[]}}],"position":{"start":{"line":69,"column":2,"offset":1562},"end":{"line":69,"column":30,"offset":1590},"indent":[]}}],"position":{"start":{"line":69,"column":1,"offset":1561},"end":{"line":69,"column":30,"offset":1590},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":70,"column":3,"offset":1593},"end":{"line":70,"column":10,"offset":1600},"indent":[]}},{"type":"list","ordered":true,"start":4,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Nodemon / Pug files","position":{"start":{"line":71,"column":5,"offset":1605},"end":{"line":71,"column":24,"offset":1624},"indent":[]}}],"position":{"start":{"line":71,"column":5,"offset":1605},"end":{"line":71,"column":24,"offset":1624},"indent":[]}}],"position":{"start":{"line":71,"column":2,"offset":1602},"end":{"line":71,"column":24,"offset":1624},"indent":[]}}],"position":{"start":{"line":71,"column":2,"offset":1602},"end":{"line":71,"column":24,"offset":1624},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":1591},"end":{"line":71,"column":24,"offset":1624},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":72,"column":3,"offset":1627},"end":{"line":72,"column":10,"offset":1634},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":73,"column":13,"offset":1647},"end":{"line":73,"column":17,"offset":1651},"indent":[]}}],"position":{"start":{"line":73,"column":11,"offset":1645},"end":{"line":73,"column":19,"offset":1653},"indent":[]}}],"position":{"start":{"line":73,"column":9,"offset":1643},"end":{"line":73,"column":21,"offset":1655},"indent":[]}}],"position":{"start":{"line":73,"column":7,"offset":1641},"end":{"line":73,"column":23,"offset":1657},"indent":[]}}],"position":{"start":{"line":73,"column":5,"offset":1639},"end":{"line":73,"column":25,"offset":1659},"indent":[]}}],"position":{"start":{"line":73,"column":3,"offset":1637},"end":{"line":73,"column":27,"offset":1661},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":1635},"end":{"line":73,"column":29,"offset":1663},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":73,"column":29,"offset":1663},"end":{"line":73,"column":30,"offset":1664},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":1635},"end":{"line":73,"column":30,"offset":1664},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":1625},"end":{"line":73,"column":30,"offset":1664},"indent":[1]}}],"position":{"start":{"line":70,"column":1,"offset":1591},"end":{"line":73,"column":30,"offset":1664},"indent":[1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Starts the app and refreshes each .js save","position":{"start":{"line":75,"column":3,"offset":1668},"end":{"line":75,"column":45,"offset":1710},"indent":[]}}],"position":{"start":{"line":75,"column":3,"offset":1668},"end":{"line":75,"column":45,"offset":1710},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":1666},"end":{"line":75,"column":45,"offset":1710},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Wrapper for node","position":{"start":{"line":76,"column":3,"offset":1713},"end":{"line":76,"column":19,"offset":1729},"indent":[]}}],"position":{"start":{"line":76,"column":3,"offset":1713},"end":{"line":76,"column":19,"offset":1729},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":1711},"end":{"line":76,"column":19,"offset":1729},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":1666},"end":{"line":76,"column":19,"offset":1729},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"PUG FORM - register.pug ","position":{"start":{"line":78,"column":1,"offset":1731},"end":{"line":78,"column":25,"offset":1755},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":1731},"end":{"line":78,"column":25,"offset":1755},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"extends layout","position":{"start":{"line":80,"column":1,"offset":1757},"end":{"line":80,"column":15,"offset":1771},"indent":[]}}],"position":{"start":{"line":80,"column":1,"offset":1757},"end":{"line":80,"column":15,"offset":1771},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"block content\n\t.main.container.row\n\t\t.col-md-6.col-md-offset-3\n\t\t\th1.display-4.m-b-2 Sign Up","position":{"start":{"line":82,"column":1,"offset":1773},"end":{"line":85,"column":30,"offset":1865},"indent":[1,1,1]}}],"position":{"start":{"line":82,"column":1,"offset":1773},"end":{"line":85,"column":30,"offset":1865},"indent":[1,1,1]}},{"type":"code","lang":null,"meta":null,"value":"\t\t//register form\n\t\tform(method='POST' action='/register')\n\t\tdiv.form-group\n\t\t\tlabel(for='name') Name:\n\t\t\tinput#name.form-control(type='text', placeholder='first and last' name='name')\n\t\tdiv.form-group\n\t\t\tlabel(for='email') Email:\n\t\t\tinput#email.form-control(type='email', placeholder='name@email.com' name='email')\n\t\tdiv.form-group\n\t\t\tlabel(for='favoriteBook') Favorite Book:\n\t\t\tinput#favoriteBook.form-control(type='text', placeholder='title of book' name='favoriteBook')\n\t\tdiv.form-group\n\t\t\tlabel(for='pw') Password:\n\t\t\tinput#pw.form-control(type='password' name='password')\n\t\tdiv.form-group\n\t\t\tlabel(for='pw2') Confirm Password:\n\t\t\tinput#pw2.form-control(type='password' name='confirmPassword')\n\t\tbutton.btn.btn-primary(type='submit') Sign up","position":{"start":{"line":87,"column":1,"offset":1867},"end":{"line":104,"column":49,"offset":2631},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":107,"column":1,"offset":2634},"end":{"line":107,"column":2,"offset":2635},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":107,"column":14,"offset":2647},"end":{"line":107,"column":18,"offset":2651},"indent":[]}}],"position":{"start":{"line":107,"column":12,"offset":2645},"end":{"line":107,"column":20,"offset":2653},"indent":[]}}],"position":{"start":{"line":107,"column":10,"offset":2643},"end":{"line":107,"column":22,"offset":2655},"indent":[]}}],"position":{"start":{"line":107,"column":8,"offset":2641},"end":{"line":107,"column":24,"offset":2657},"indent":[]}}],"position":{"start":{"line":107,"column":6,"offset":2639},"end":{"line":107,"column":26,"offset":2659},"indent":[]}}],"position":{"start":{"line":107,"column":4,"offset":2637},"end":{"line":107,"column":28,"offset":2661},"indent":[]}}],"position":{"start":{"line":107,"column":2,"offset":2635},"end":{"line":107,"column":30,"offset":2663},"indent":[]}}],"position":{"start":{"line":107,"column":1,"offset":2634},"end":{"line":107,"column":30,"offset":2663},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":108,"column":3,"offset":2666},"end":{"line":108,"column":10,"offset":2673},"indent":[]}},{"type":"list","ordered":true,"start":5,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Setting up MongoDB","position":{"start":{"line":109,"column":8,"offset":2681},"end":{"line":109,"column":26,"offset":2699},"indent":[]}}],"position":{"start":{"line":109,"column":8,"offset":2681},"end":{"line":109,"column":26,"offset":2699},"indent":[]}}],"position":{"start":{"line":109,"column":5,"offset":2678},"end":{"line":109,"column":26,"offset":2699},"indent":[]}}],"position":{"start":{"line":109,"column":5,"offset":2678},"end":{"line":109,"column":26,"offset":2699},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":2664},"end":{"line":109,"column":26,"offset":2699},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":110,"column":3,"offset":2702},"end":{"line":110,"column":10,"offset":2709},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":111,"column":13,"offset":2722},"end":{"line":111,"column":17,"offset":2726},"indent":[]}}],"position":{"start":{"line":111,"column":11,"offset":2720},"end":{"line":111,"column":19,"offset":2728},"indent":[]}}],"position":{"start":{"line":111,"column":9,"offset":2718},"end":{"line":111,"column":21,"offset":2730},"indent":[]}}],"position":{"start":{"line":111,"column":7,"offset":2716},"end":{"line":111,"column":23,"offset":2732},"indent":[]}}],"position":{"start":{"line":111,"column":5,"offset":2714},"end":{"line":111,"column":25,"offset":2734},"indent":[]}}],"position":{"start":{"line":111,"column":3,"offset":2712},"end":{"line":111,"column":27,"offset":2736},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":2710},"end":{"line":111,"column":29,"offset":2738},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":111,"column":29,"offset":2738},"end":{"line":111,"column":30,"offset":2739},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":2710},"end":{"line":111,"column":30,"offset":2739},"indent":[]}}],"position":{"start":{"line":110,"column":1,"offset":2700},"end":{"line":111,"column":30,"offset":2739},"indent":[1]}}],"position":{"start":{"line":108,"column":1,"offset":2664},"end":{"line":111,"column":30,"offset":2739},"indent":[1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Mongoose is the most used for Express applications","position":{"start":{"line":113,"column":3,"offset":2743},"end":{"line":113,"column":53,"offset":2793},"indent":[]}}],"position":{"start":{"line":113,"column":3,"offset":2743},"end":{"line":113,"column":53,"offset":2793},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":2741},"end":{"line":113,"column":53,"offset":2793},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":2741},"end":{"line":113,"column":53,"offset":2793},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"npm install --save mongoose","position":{"start":{"line":115,"column":1,"offset":2795},"end":{"line":115,"column":28,"offset":2822},"indent":[]}}],"position":{"start":{"line":115,"column":1,"offset":2795},"end":{"line":115,"column":28,"offset":2822},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// in the app.js","position":{"start":{"line":117,"column":1,"offset":2824},"end":{"line":117,"column":17,"offset":2840},"indent":[]}}],"position":{"start":{"line":117,"column":1,"offset":2824},"end":{"line":117,"column":17,"offset":2840},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var mongoose = require('mongoose');","position":{"start":{"line":119,"column":1,"offset":2842},"end":{"line":119,"column":36,"offset":2877},"indent":[]}}],"position":{"start":{"line":119,"column":1,"offset":2842},"end":{"line":119,"column":36,"offset":2877},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"mongoose.connect(\"mongodb://localhost:27017/bookworm\");","position":{"start":{"line":121,"column":1,"offset":2879},"end":{"line":121,"column":56,"offset":2934},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":2879},"end":{"line":121,"column":56,"offset":2934},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var db = mongoose.connection;","position":{"start":{"line":123,"column":1,"offset":2936},"end":{"line":123,"column":30,"offset":2965},"indent":[]}}],"position":{"start":{"line":123,"column":1,"offset":2936},"end":{"line":123,"column":30,"offset":2965},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"db.on('error', console.error.bind(console, 'connection error:')); ","position":{"start":{"line":125,"column":1,"offset":2967},"end":{"line":125,"column":67,"offset":3033},"indent":[]}}],"position":{"start":{"line":125,"column":1,"offset":2967},"end":{"line":125,"column":67,"offset":3033},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// running mongo","position":{"start":{"line":127,"column":1,"offset":3035},"end":{"line":127,"column":17,"offset":3051},"indent":[]}}],"position":{"start":{"line":127,"column":1,"offset":3035},"end":{"line":127,"column":17,"offset":3051},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"mongod","position":{"start":{"line":129,"column":1,"offset":3053},"end":{"line":129,"column":7,"offset":3059},"indent":[]}}],"position":{"start":{"line":129,"column":1,"offset":3053},"end":{"line":129,"column":7,"offset":3059},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":131,"column":1,"offset":3061},"end":{"line":131,"column":2,"offset":3062},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":131,"column":14,"offset":3074},"end":{"line":131,"column":18,"offset":3078},"indent":[]}}],"position":{"start":{"line":131,"column":12,"offset":3072},"end":{"line":131,"column":20,"offset":3080},"indent":[]}}],"position":{"start":{"line":131,"column":10,"offset":3070},"end":{"line":131,"column":22,"offset":3082},"indent":[]}}],"position":{"start":{"line":131,"column":8,"offset":3068},"end":{"line":131,"column":24,"offset":3084},"indent":[]}}],"position":{"start":{"line":131,"column":6,"offset":3066},"end":{"line":131,"column":26,"offset":3086},"indent":[]}}],"position":{"start":{"line":131,"column":4,"offset":3064},"end":{"line":131,"column":28,"offset":3088},"indent":[]}}],"position":{"start":{"line":131,"column":2,"offset":3062},"end":{"line":131,"column":30,"offset":3090},"indent":[]}}],"position":{"start":{"line":131,"column":1,"offset":3061},"end":{"line":131,"column":30,"offset":3090},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":132,"column":3,"offset":3093},"end":{"line":132,"column":10,"offset":3100},"indent":[]}},{"type":"list","ordered":true,"start":6,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Defining the Mongo \n\tSchema","position":{"start":{"line":133,"column":6,"offset":3106},"end":{"line":134,"column":11,"offset":3136},"indent":[4]}}],"position":{"start":{"line":133,"column":6,"offset":3106},"end":{"line":134,"column":11,"offset":3136},"indent":[4]}}],"position":{"start":{"line":133,"column":3,"offset":3103},"end":{"line":134,"column":11,"offset":3136},"indent":[3]}}],"position":{"start":{"line":133,"column":3,"offset":3103},"end":{"line":134,"column":11,"offset":3136},"indent":[3]}}],"position":{"start":{"line":132,"column":1,"offset":3091},"end":{"line":134,"column":11,"offset":3136},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":135,"column":3,"offset":3139},"end":{"line":135,"column":10,"offset":3146},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":136,"column":13,"offset":3159},"end":{"line":136,"column":17,"offset":3163},"indent":[]}}],"position":{"start":{"line":136,"column":11,"offset":3157},"end":{"line":136,"column":19,"offset":3165},"indent":[]}}],"position":{"start":{"line":136,"column":9,"offset":3155},"end":{"line":136,"column":21,"offset":3167},"indent":[]}}],"position":{"start":{"line":136,"column":7,"offset":3153},"end":{"line":136,"column":23,"offset":3169},"indent":[]}}],"position":{"start":{"line":136,"column":5,"offset":3151},"end":{"line":136,"column":25,"offset":3171},"indent":[]}}],"position":{"start":{"line":136,"column":3,"offset":3149},"end":{"line":136,"column":27,"offset":3173},"indent":[]}}],"position":{"start":{"line":136,"column":1,"offset":3147},"end":{"line":136,"column":29,"offset":3175},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":136,"column":29,"offset":3175},"end":{"line":136,"column":30,"offset":3176},"indent":[]}}],"position":{"start":{"line":136,"column":1,"offset":3147},"end":{"line":136,"column":30,"offset":3176},"indent":[]}}],"position":{"start":{"line":135,"column":1,"offset":3137},"end":{"line":136,"column":30,"offset":3176},"indent":[1]}}],"position":{"start":{"line":132,"column":1,"offset":3091},"end":{"line":136,"column":30,"offset":3176},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Store: name, email, password etc.","position":{"start":{"line":138,"column":1,"offset":3178},"end":{"line":138,"column":34,"offset":3211},"indent":[]}}],"position":{"start":{"line":138,"column":1,"offset":3178},"end":{"line":138,"column":34,"offset":3211},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"in models, created user.js","position":{"start":{"line":140,"column":1,"offset":3213},"end":{"line":140,"column":27,"offset":3239},"indent":[]}}],"position":{"start":{"line":140,"column":1,"offset":3213},"end":{"line":140,"column":27,"offset":3239},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// user.js","position":{"start":{"line":142,"column":1,"offset":3241},"end":{"line":142,"column":11,"offset":3251},"indent":[]}}],"position":{"start":{"line":142,"column":1,"offset":3241},"end":{"line":142,"column":11,"offset":3251},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var mongoose = require('mongoose');","position":{"start":{"line":144,"column":1,"offset":3253},"end":{"line":144,"column":36,"offset":3288},"indent":[]}}],"position":{"start":{"line":144,"column":1,"offset":3253},"end":{"line":144,"column":36,"offset":3288},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var UserSchema = new mongoose.Schema({\n  email: {\n    type: String,\n    required: true,\n    trim: true,\n    unique: true,\n  },\n  name: {\n    type: String,\n    required: true,\n    trim: true,\n  },\n  favoriteBook: {\n    type: String,\n    required: true,\n    trim: true\n  },\n  password: {\n    type: String,\n    required: true\n  }\n});","position":{"start":{"line":146,"column":1,"offset":3290},"end":{"line":167,"column":4,"offset":3620},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":146,"column":1,"offset":3290},"end":{"line":167,"column":4,"offset":3620},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"var User = mongoose.model('User', UserSchema);\nmodule.exports = User;","position":{"start":{"line":169,"column":1,"offset":3622},"end":{"line":170,"column":23,"offset":3691},"indent":[1]}}],"position":{"start":{"line":169,"column":1,"offset":3622},"end":{"line":170,"column":23,"offset":3691},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":172,"column":1,"offset":3693},"end":{"line":172,"column":2,"offset":3694},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":172,"column":14,"offset":3706},"end":{"line":172,"column":18,"offset":3710},"indent":[]}}],"position":{"start":{"line":172,"column":12,"offset":3704},"end":{"line":172,"column":20,"offset":3712},"indent":[]}}],"position":{"start":{"line":172,"column":10,"offset":3702},"end":{"line":172,"column":22,"offset":3714},"indent":[]}}],"position":{"start":{"line":172,"column":8,"offset":3700},"end":{"line":172,"column":24,"offset":3716},"indent":[]}}],"position":{"start":{"line":172,"column":6,"offset":3698},"end":{"line":172,"column":26,"offset":3718},"indent":[]}}],"position":{"start":{"line":172,"column":4,"offset":3696},"end":{"line":172,"column":28,"offset":3720},"indent":[]}}],"position":{"start":{"line":172,"column":2,"offset":3694},"end":{"line":172,"column":30,"offset":3722},"indent":[]}}],"position":{"start":{"line":172,"column":1,"offset":3693},"end":{"line":172,"column":30,"offset":3722},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":173,"column":3,"offset":3725},"end":{"line":173,"column":10,"offset":3732},"indent":[]}},{"type":"list","ordered":true,"start":7,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Adding the Data","position":{"start":{"line":174,"column":6,"offset":3738},"end":{"line":174,"column":21,"offset":3753},"indent":[]}}],"position":{"start":{"line":174,"column":6,"offset":3738},"end":{"line":174,"column":21,"offset":3753},"indent":[]}}],"position":{"start":{"line":174,"column":3,"offset":3735},"end":{"line":174,"column":21,"offset":3753},"indent":[]}}],"position":{"start":{"line":174,"column":3,"offset":3735},"end":{"line":174,"column":21,"offset":3753},"indent":[]}}],"position":{"start":{"line":173,"column":1,"offset":3723},"end":{"line":174,"column":21,"offset":3753},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":175,"column":3,"offset":3756},"end":{"line":175,"column":10,"offset":3763},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":176,"column":13,"offset":3776},"end":{"line":176,"column":17,"offset":3780},"indent":[]}}],"position":{"start":{"line":176,"column":11,"offset":3774},"end":{"line":176,"column":19,"offset":3782},"indent":[]}}],"position":{"start":{"line":176,"column":9,"offset":3772},"end":{"line":176,"column":21,"offset":3784},"indent":[]}}],"position":{"start":{"line":176,"column":7,"offset":3770},"end":{"line":176,"column":23,"offset":3786},"indent":[]}}],"position":{"start":{"line":176,"column":5,"offset":3768},"end":{"line":176,"column":25,"offset":3788},"indent":[]}}],"position":{"start":{"line":176,"column":3,"offset":3766},"end":{"line":176,"column":27,"offset":3790},"indent":[]}}],"position":{"start":{"line":176,"column":1,"offset":3764},"end":{"line":176,"column":29,"offset":3792},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":176,"column":29,"offset":3792},"end":{"line":176,"column":30,"offset":3793},"indent":[]}}],"position":{"start":{"line":176,"column":1,"offset":3764},"end":{"line":176,"column":30,"offset":3793},"indent":[]}}],"position":{"start":{"line":175,"column":1,"offset":3754},"end":{"line":176,"column":30,"offset":3793},"indent":[1]}}],"position":{"start":{"line":173,"column":1,"offset":3723},"end":{"line":176,"column":30,"offset":3793},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"// in app.js","position":{"start":{"line":178,"column":1,"offset":3795},"end":{"line":178,"column":13,"offset":3807},"indent":[]}}],"position":{"start":{"line":178,"column":1,"offset":3795},"end":{"line":178,"column":13,"offset":3807},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var User = require('../models/user');","position":{"start":{"line":180,"column":1,"offset":3809},"end":{"line":180,"column":38,"offset":3846},"indent":[]}}],"position":{"start":{"line":180,"column":1,"offset":3809},"end":{"line":180,"column":38,"offset":3846},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"...","position":{"start":{"line":182,"column":1,"offset":3848},"end":{"line":182,"column":4,"offset":3851},"indent":[]}}],"position":{"start":{"line":182,"column":1,"offset":3848},"end":{"line":182,"column":4,"offset":3851},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"router.post('/register', function(req,res,next) {\n\tif (req.body.email &&\n\t\treq.body.name &&\n\t\treq.body.favoriteBook &&\n\t\treq.body.password &&\n\t\treq.body.confirmPassword) {","position":{"start":{"line":184,"column":1,"offset":3853},"end":{"line":189,"column":30,"offset":4024},"indent":[1,1,1,1,1]}}],"position":{"start":{"line":184,"column":1,"offset":3853},"end":{"line":189,"column":30,"offset":4024},"indent":[1,1,1,1,1]}},{"type":"code","lang":null,"meta":null,"value":"\tif (req.body.password !== req.body.confirmPassword) {\n\t\tvar err = new Error('Passwords do not match.');\n\t\terr.status = 400;\n\t\treturn next(err);\n\t}\n\n\t// create object with form input\n\n\tvar userData = {\n\t\temail: req.body.email\n\t\tname: req.body.name\n\t\tfavouriteBook: req.body.favouriteBook,\n\t\tpassword: req.body.password\n\t};\n\n\t// use schema's create method to insert document\n\tUser.create(userData, function (error, user) {\n\t\tif (error) {\n\t\t\treturn next(error);\n\t\t} else {\n\t\t\treturn res.redirect('/profile');\n\t\t}\n\t});\n\n} else {\n\tvar err = new Error('All fields required');\n\terr.status = 400;\n\treturn next(err);\n}","position":{"start":{"line":191,"column":1,"offset":4026},"end":{"line":219,"column":3,"offset":4661},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"});","position":{"start":{"line":220,"column":1,"offset":4662},"end":{"line":220,"column":4,"offset":4665},"indent":[]}}],"position":{"start":{"line":220,"column":1,"offset":4662},"end":{"line":220,"column":4,"offset":4665},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":222,"column":1,"offset":4667},"end":{"line":222,"column":2,"offset":4668},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":222,"column":14,"offset":4680},"end":{"line":222,"column":18,"offset":4684},"indent":[]}}],"position":{"start":{"line":222,"column":12,"offset":4678},"end":{"line":222,"column":20,"offset":4686},"indent":[]}}],"position":{"start":{"line":222,"column":10,"offset":4676},"end":{"line":222,"column":22,"offset":4688},"indent":[]}}],"position":{"start":{"line":222,"column":8,"offset":4674},"end":{"line":222,"column":24,"offset":4690},"indent":[]}}],"position":{"start":{"line":222,"column":6,"offset":4672},"end":{"line":222,"column":26,"offset":4692},"indent":[]}}],"position":{"start":{"line":222,"column":4,"offset":4670},"end":{"line":222,"column":28,"offset":4694},"indent":[]}}],"position":{"start":{"line":222,"column":2,"offset":4668},"end":{"line":222,"column":30,"offset":4696},"indent":[]}}],"position":{"start":{"line":222,"column":1,"offset":4667},"end":{"line":222,"column":30,"offset":4696},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":223,"column":3,"offset":4699},"end":{"line":223,"column":10,"offset":4706},"indent":[]}},{"type":"list","ordered":true,"start":8,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Hashing and Salting","position":{"start":{"line":224,"column":6,"offset":4712},"end":{"line":224,"column":25,"offset":4731},"indent":[]}}],"position":{"start":{"line":224,"column":6,"offset":4712},"end":{"line":224,"column":25,"offset":4731},"indent":[]}}],"position":{"start":{"line":224,"column":3,"offset":4709},"end":{"line":224,"column":25,"offset":4731},"indent":[]}}],"position":{"start":{"line":224,"column":3,"offset":4709},"end":{"line":224,"column":25,"offset":4731},"indent":[]}}],"position":{"start":{"line":223,"column":1,"offset":4697},"end":{"line":224,"column":25,"offset":4731},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":225,"column":3,"offset":4734},"end":{"line":225,"column":10,"offset":4741},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":226,"column":13,"offset":4754},"end":{"line":226,"column":17,"offset":4758},"indent":[]}}],"position":{"start":{"line":226,"column":11,"offset":4752},"end":{"line":226,"column":19,"offset":4760},"indent":[]}}],"position":{"start":{"line":226,"column":9,"offset":4750},"end":{"line":226,"column":21,"offset":4762},"indent":[]}}],"position":{"start":{"line":226,"column":7,"offset":4748},"end":{"line":226,"column":23,"offset":4764},"indent":[]}}],"position":{"start":{"line":226,"column":5,"offset":4746},"end":{"line":226,"column":25,"offset":4766},"indent":[]}}],"position":{"start":{"line":226,"column":3,"offset":4744},"end":{"line":226,"column":27,"offset":4768},"indent":[]}}],"position":{"start":{"line":226,"column":1,"offset":4742},"end":{"line":226,"column":29,"offset":4770},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":226,"column":29,"offset":4770},"end":{"line":226,"column":30,"offset":4771},"indent":[]}}],"position":{"start":{"line":226,"column":1,"offset":4742},"end":{"line":226,"column":30,"offset":4771},"indent":[]}}],"position":{"start":{"line":225,"column":1,"offset":4732},"end":{"line":226,"column":30,"offset":4771},"indent":[1]}}],"position":{"start":{"line":223,"column":1,"offset":4697},"end":{"line":226,"column":30,"offset":4771},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"npm install bcrypt --save","position":{"start":{"line":228,"column":1,"offset":4773},"end":{"line":228,"column":26,"offset":4798},"indent":[]}}],"position":{"start":{"line":228,"column":1,"offset":4773},"end":{"line":228,"column":26,"offset":4798},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// in use ","position":{"start":{"line":230,"column":1,"offset":4800},"end":{"line":230,"column":11,"offset":4810},"indent":[]}}],"position":{"start":{"line":230,"column":1,"offset":4800},"end":{"line":230,"column":11,"offset":4810},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// in User.js","position":{"start":{"line":232,"column":1,"offset":4812},"end":{"line":232,"column":14,"offset":4825},"indent":[]}}],"position":{"start":{"line":232,"column":1,"offset":4812},"end":{"line":232,"column":14,"offset":4825},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var bcrypt = require('bcrypt');","position":{"start":{"line":234,"column":1,"offset":4827},"end":{"line":234,"column":32,"offset":4858},"indent":[]}}],"position":{"start":{"line":234,"column":1,"offset":4827},"end":{"line":234,"column":32,"offset":4858},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// MONGOOSE PRESAVE HOOK\nUserSchema.pre('save', function(next) {\n\tvar user = this;\n\tbcrypt.hash(user.password, 10, function(err, hash) {\n\t\tif (err) {\n\t\t\treturn next(err);\n\t\t}\n\t\tuser.password = hash;\n\t\tnext();\n\t})\n});","position":{"start":{"line":236,"column":1,"offset":4860},"end":{"line":246,"column":4,"offset":5076},"indent":[1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":236,"column":1,"offset":4860},"end":{"line":246,"column":4,"offset":5076},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/////////////////////////////////////////////////////////","position":{"start":{"line":248,"column":1,"offset":5078},"end":{"line":248,"column":58,"offset":5135},"indent":[]}}],"position":{"start":{"line":248,"column":1,"offset":5078},"end":{"line":248,"column":58,"offset":5135},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"PART 3: Sessions and Cookies","position":{"start":{"line":250,"column":1,"offset":5137},"end":{"line":250,"column":29,"offset":5165},"indent":[]}}],"position":{"start":{"line":250,"column":1,"offset":5137},"end":{"line":250,"column":29,"offset":5165},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":252,"column":1,"offset":5167},"end":{"line":252,"column":2,"offset":5168},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":252,"column":14,"offset":5180},"end":{"line":252,"column":18,"offset":5184},"indent":[]}}],"position":{"start":{"line":252,"column":12,"offset":5178},"end":{"line":252,"column":20,"offset":5186},"indent":[]}}],"position":{"start":{"line":252,"column":10,"offset":5176},"end":{"line":252,"column":22,"offset":5188},"indent":[]}}],"position":{"start":{"line":252,"column":8,"offset":5174},"end":{"line":252,"column":24,"offset":5190},"indent":[]}}],"position":{"start":{"line":252,"column":6,"offset":5172},"end":{"line":252,"column":26,"offset":5192},"indent":[]}}],"position":{"start":{"line":252,"column":4,"offset":5170},"end":{"line":252,"column":28,"offset":5194},"indent":[]}}],"position":{"start":{"line":252,"column":2,"offset":5168},"end":{"line":252,"column":30,"offset":5196},"indent":[]}}],"position":{"start":{"line":252,"column":1,"offset":5167},"end":{"line":252,"column":30,"offset":5196},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*\n9. User Login ","position":{"start":{"line":253,"column":3,"offset":5199},"end":{"line":254,"column":17,"offset":5223},"indent":[2]}},{"type":"paragraph","children":[{"type":"text","value":"   Functionalities","position":{"start":{"line":255,"column":2,"offset":5225},"end":{"line":255,"column":20,"offset":5243},"indent":[]}}],"position":{"start":{"line":255,"column":2,"offset":5225},"end":{"line":255,"column":20,"offset":5243},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Sessions & Cookies","position":{"start":{"line":256,"column":5,"offset":5248},"end":{"line":256,"column":23,"offset":5266},"indent":[]}}],"position":{"start":{"line":256,"column":5,"offset":5248},"end":{"line":256,"column":23,"offset":5266},"indent":[]}}],"position":{"start":{"line":256,"column":2,"offset":5245},"end":{"line":256,"column":23,"offset":5266},"indent":[]}}],"position":{"start":{"line":256,"column":2,"offset":5245},"end":{"line":256,"column":23,"offset":5266},"indent":[]}}],"position":{"start":{"line":253,"column":1,"offset":5197},"end":{"line":256,"column":23,"offset":5266},"indent":[1,1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":257,"column":3,"offset":5269},"end":{"line":257,"column":10,"offset":5276},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":258,"column":13,"offset":5289},"end":{"line":258,"column":17,"offset":5293},"indent":[]}}],"position":{"start":{"line":258,"column":11,"offset":5287},"end":{"line":258,"column":19,"offset":5295},"indent":[]}}],"position":{"start":{"line":258,"column":9,"offset":5285},"end":{"line":258,"column":21,"offset":5297},"indent":[]}}],"position":{"start":{"line":258,"column":7,"offset":5283},"end":{"line":258,"column":23,"offset":5299},"indent":[]}}],"position":{"start":{"line":258,"column":5,"offset":5281},"end":{"line":258,"column":25,"offset":5301},"indent":[]}}],"position":{"start":{"line":258,"column":3,"offset":5279},"end":{"line":258,"column":27,"offset":5303},"indent":[]}}],"position":{"start":{"line":258,"column":1,"offset":5277},"end":{"line":258,"column":29,"offset":5305},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":258,"column":29,"offset":5305},"end":{"line":258,"column":30,"offset":5306},"indent":[]}}],"position":{"start":{"line":258,"column":1,"offset":5277},"end":{"line":258,"column":30,"offset":5306},"indent":[]}}],"position":{"start":{"line":257,"column":1,"offset":5267},"end":{"line":258,"column":30,"offset":5306},"indent":[1]}}],"position":{"start":{"line":253,"column":1,"offset":5197},"end":{"line":258,"column":30,"offset":5306},"indent":[1,1,1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"http stateless protocol for cookies and sessions","position":{"start":{"line":260,"column":3,"offset":5310},"end":{"line":260,"column":51,"offset":5358},"indent":[]}}],"position":{"start":{"line":260,"column":3,"offset":5310},"end":{"line":260,"column":51,"offset":5358},"indent":[]}}],"position":{"start":{"line":260,"column":1,"offset":5308},"end":{"line":260,"column":51,"offset":5358},"indent":[]}}],"position":{"start":{"line":260,"column":1,"offset":5308},"end":{"line":260,"column":51,"offset":5358},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Http is a stateless protocol itself","position":{"start":{"line":262,"column":1,"offset":5360},"end":{"line":262,"column":36,"offset":5395},"indent":[]}}],"position":{"start":{"line":262,"column":1,"offset":5360},"end":{"line":262,"column":36,"offset":5395},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"server doesn't keep track of when a user changes pages","position":{"start":{"line":263,"column":3,"offset":5398},"end":{"line":263,"column":57,"offset":5452},"indent":[]}}],"position":{"start":{"line":263,"column":3,"offset":5398},"end":{"line":263,"column":57,"offset":5452},"indent":[]}}],"position":{"start":{"line":263,"column":1,"offset":5396},"end":{"line":263,"column":57,"offset":5452},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"need to create a session id - usually set time too","position":{"start":{"line":264,"column":3,"offset":5455},"end":{"line":264,"column":53,"offset":5505},"indent":[]}}],"position":{"start":{"line":264,"column":3,"offset":5455},"end":{"line":264,"column":53,"offset":5505},"indent":[]}}],"position":{"start":{"line":264,"column":1,"offset":5453},"end":{"line":264,"column":53,"offset":5505},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"need session ID and user ID","position":{"start":{"line":265,"column":3,"offset":5508},"end":{"line":265,"column":30,"offset":5535},"indent":[]}}],"position":{"start":{"line":265,"column":3,"offset":5508},"end":{"line":265,"column":30,"offset":5535},"indent":[]}}],"position":{"start":{"line":265,"column":1,"offset":5506},"end":{"line":265,"column":30,"offset":5535},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"cookies is a key/value pair that a server wants to create","position":{"start":{"line":266,"column":3,"offset":5538},"end":{"line":266,"column":60,"offset":5595},"indent":[]}}],"position":{"start":{"line":266,"column":3,"offset":5538},"end":{"line":266,"column":60,"offset":5595},"indent":[]}}],"position":{"start":{"line":266,"column":1,"offset":5536},"end":{"line":266,"column":60,"offset":5595},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"we will create a cookie with a session ID","position":{"start":{"line":267,"column":3,"offset":5598},"end":{"line":267,"column":44,"offset":5639},"indent":[]}}],"position":{"start":{"line":267,"column":3,"offset":5598},"end":{"line":267,"column":44,"offset":5639},"indent":[]}}],"position":{"start":{"line":267,"column":1,"offset":5596},"end":{"line":267,"column":44,"offset":5639},"indent":[]}}],"position":{"start":{"line":263,"column":1,"offset":5396},"end":{"line":267,"column":44,"offset":5639},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"npm install express-session --save","position":{"start":{"line":269,"column":1,"offset":5641},"end":{"line":269,"column":35,"offset":5675},"indent":[]}}],"position":{"start":{"line":269,"column":1,"offset":5641},"end":{"line":269,"column":35,"offset":5675},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// in app.js","position":{"start":{"line":271,"column":1,"offset":5677},"end":{"line":271,"column":13,"offset":5689},"indent":[]}}],"position":{"start":{"line":271,"column":1,"offset":5677},"end":{"line":271,"column":13,"offset":5689},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var session = require('express-session');","position":{"start":{"line":273,"column":1,"offset":5691},"end":{"line":273,"column":42,"offset":5732},"indent":[]}}],"position":{"start":{"line":273,"column":1,"offset":5691},"end":{"line":273,"column":42,"offset":5732},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// use sessions for tracking logins - check more in the readme\napp.use(session({\n\tsecret: 'treehouse loves you',\n\tresave: true,\n\tsaveUninitialized: false\n}));","position":{"start":{"line":275,"column":1,"offset":5734},"end":{"line":280,"column":5,"offset":5892},"indent":[1,1,1,1,1]}}],"position":{"start":{"line":275,"column":1,"offset":5734},"end":{"line":280,"column":5,"offset":5892},"indent":[1,1,1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"not useful when in production. check ","position":{"start":{"line":282,"column":3,"offset":5896},"end":{"line":282,"column":40,"offset":5933},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/expressjs/session#compatible-session-stores","children":[{"type":"text","value":"https://github.com/expressjs/session#compatible-session-stores","position":{"start":{"line":282,"column":40,"offset":5933},"end":{"line":282,"column":102,"offset":5995},"indent":[]}}],"position":{"start":{"line":282,"column":40,"offset":5933},"end":{"line":282,"column":102,"offset":5995},"indent":[]}}],"position":{"start":{"line":282,"column":3,"offset":5896},"end":{"line":282,"column":102,"offset":5995},"indent":[]}}],"position":{"start":{"line":282,"column":1,"offset":5894},"end":{"line":282,"column":102,"offset":5995},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"secret is used to sign a cookie, to ensure that only the application created the cookie.","position":{"start":{"line":283,"column":3,"offset":5998},"end":{"line":283,"column":91,"offset":6086},"indent":[]}}],"position":{"start":{"line":283,"column":3,"offset":5998},"end":{"line":283,"column":91,"offset":6086},"indent":[]}}],"position":{"start":{"line":283,"column":1,"offset":5996},"end":{"line":283,"column":91,"offset":6086},"indent":[]}}],"position":{"start":{"line":282,"column":1,"offset":5894},"end":{"line":283,"column":91,"offset":6086},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":285,"column":1,"offset":6088},"end":{"line":285,"column":2,"offset":6089},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"**","position":{"start":{"line":285,"column":14,"offset":6101},"end":{"line":285,"column":16,"offset":6103},"indent":[]}}],"position":{"start":{"line":285,"column":12,"offset":6099},"end":{"line":285,"column":18,"offset":6105},"indent":[]}}],"position":{"start":{"line":285,"column":10,"offset":6097},"end":{"line":285,"column":20,"offset":6107},"indent":[]}}],"position":{"start":{"line":285,"column":8,"offset":6095},"end":{"line":285,"column":22,"offset":6109},"indent":[]}}],"position":{"start":{"line":285,"column":6,"offset":6093},"end":{"line":285,"column":24,"offset":6111},"indent":[]}}],"position":{"start":{"line":285,"column":4,"offset":6091},"end":{"line":285,"column":26,"offset":6113},"indent":[]}}],"position":{"start":{"line":285,"column":2,"offset":6089},"end":{"line":285,"column":28,"offset":6115},"indent":[]}}],"position":{"start":{"line":285,"column":1,"offset":6088},"end":{"line":285,"column":28,"offset":6115},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t  *","position":{"start":{"line":286,"column":3,"offset":6118},"end":{"line":286,"column":11,"offset":6126},"indent":[]}},{"type":"list","ordered":true,"start":10,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Adding login \nto routes","position":{"start":{"line":287,"column":6,"offset":6132},"end":{"line":288,"column":12,"offset":6157},"indent":[3]}}],"position":{"start":{"line":287,"column":6,"offset":6132},"end":{"line":288,"column":12,"offset":6157},"indent":[3]}}],"position":{"start":{"line":287,"column":2,"offset":6128},"end":{"line":288,"column":12,"offset":6157},"indent":[2]}}],"position":{"start":{"line":287,"column":2,"offset":6128},"end":{"line":288,"column":12,"offset":6157},"indent":[2]}}],"position":{"start":{"line":286,"column":1,"offset":6116},"end":{"line":288,"column":12,"offset":6157},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t  *","position":{"start":{"line":289,"column":3,"offset":6160},"end":{"line":289,"column":11,"offset":6168},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"**","position":{"start":{"line":290,"column":13,"offset":6181},"end":{"line":290,"column":15,"offset":6183},"indent":[]}}],"position":{"start":{"line":290,"column":11,"offset":6179},"end":{"line":290,"column":17,"offset":6185},"indent":[]}}],"position":{"start":{"line":290,"column":9,"offset":6177},"end":{"line":290,"column":19,"offset":6187},"indent":[]}}],"position":{"start":{"line":290,"column":7,"offset":6175},"end":{"line":290,"column":21,"offset":6189},"indent":[]}}],"position":{"start":{"line":290,"column":5,"offset":6173},"end":{"line":290,"column":23,"offset":6191},"indent":[]}}],"position":{"start":{"line":290,"column":3,"offset":6171},"end":{"line":290,"column":25,"offset":6193},"indent":[]}}],"position":{"start":{"line":290,"column":1,"offset":6169},"end":{"line":290,"column":27,"offset":6195},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":290,"column":27,"offset":6195},"end":{"line":290,"column":28,"offset":6196},"indent":[]}}],"position":{"start":{"line":290,"column":1,"offset":6169},"end":{"line":290,"column":28,"offset":6196},"indent":[]}}],"position":{"start":{"line":289,"column":1,"offset":6158},"end":{"line":290,"column":28,"offset":6196},"indent":[1]}}],"position":{"start":{"line":286,"column":1,"offset":6116},"end":{"line":290,"column":28,"offset":6196},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"// in app.js","position":{"start":{"line":292,"column":1,"offset":6198},"end":{"line":292,"column":13,"offset":6210},"indent":[]}}],"position":{"start":{"line":292,"column":1,"offset":6198},"end":{"line":292,"column":13,"offset":6210},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"router.get('/login', function(req, res, next) {\n\treturn res.render('login', { title: 'Log In' });\n});","position":{"start":{"line":294,"column":1,"offset":6212},"end":{"line":296,"column":4,"offset":6313},"indent":[1,1]}}],"position":{"start":{"line":294,"column":1,"offset":6212},"end":{"line":296,"column":4,"offset":6313},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"router.post('/login', function(req, res, next) {\n\treturn res.send('Logged in!');\n});","position":{"start":{"line":298,"column":1,"offset":6315},"end":{"line":300,"column":4,"offset":6399},"indent":[1,1]}}],"position":{"start":{"line":298,"column":1,"offset":6315},"end":{"line":300,"column":4,"offset":6399},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":302,"column":1,"offset":6401},"end":{"line":302,"column":2,"offset":6402},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"**","position":{"start":{"line":302,"column":14,"offset":6414},"end":{"line":302,"column":16,"offset":6416},"indent":[]}}],"position":{"start":{"line":302,"column":12,"offset":6412},"end":{"line":302,"column":18,"offset":6418},"indent":[]}}],"position":{"start":{"line":302,"column":10,"offset":6410},"end":{"line":302,"column":20,"offset":6420},"indent":[]}}],"position":{"start":{"line":302,"column":8,"offset":6408},"end":{"line":302,"column":22,"offset":6422},"indent":[]}}],"position":{"start":{"line":302,"column":6,"offset":6406},"end":{"line":302,"column":24,"offset":6424},"indent":[]}}],"position":{"start":{"line":302,"column":4,"offset":6404},"end":{"line":302,"column":26,"offset":6426},"indent":[]}}],"position":{"start":{"line":302,"column":2,"offset":6402},"end":{"line":302,"column":28,"offset":6428},"indent":[]}}],"position":{"start":{"line":302,"column":1,"offset":6401},"end":{"line":302,"column":28,"offset":6428},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t  *","position":{"start":{"line":303,"column":3,"offset":6431},"end":{"line":303,"column":11,"offset":6439},"indent":[]}},{"type":"list","ordered":true,"start":11,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Pug login form","position":{"start":{"line":304,"column":6,"offset":6445},"end":{"line":304,"column":20,"offset":6459},"indent":[]}}],"position":{"start":{"line":304,"column":6,"offset":6445},"end":{"line":304,"column":20,"offset":6459},"indent":[]}}],"position":{"start":{"line":304,"column":2,"offset":6441},"end":{"line":304,"column":20,"offset":6459},"indent":[]}}],"position":{"start":{"line":304,"column":2,"offset":6441},"end":{"line":304,"column":20,"offset":6459},"indent":[]}}],"position":{"start":{"line":303,"column":1,"offset":6429},"end":{"line":304,"column":20,"offset":6459},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t  *","position":{"start":{"line":305,"column":3,"offset":6462},"end":{"line":305,"column":11,"offset":6470},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"**","position":{"start":{"line":306,"column":13,"offset":6483},"end":{"line":306,"column":15,"offset":6485},"indent":[]}}],"position":{"start":{"line":306,"column":11,"offset":6481},"end":{"line":306,"column":17,"offset":6487},"indent":[]}}],"position":{"start":{"line":306,"column":9,"offset":6479},"end":{"line":306,"column":19,"offset":6489},"indent":[]}}],"position":{"start":{"line":306,"column":7,"offset":6477},"end":{"line":306,"column":21,"offset":6491},"indent":[]}}],"position":{"start":{"line":306,"column":5,"offset":6475},"end":{"line":306,"column":23,"offset":6493},"indent":[]}}],"position":{"start":{"line":306,"column":3,"offset":6473},"end":{"line":306,"column":25,"offset":6495},"indent":[]}}],"position":{"start":{"line":306,"column":1,"offset":6471},"end":{"line":306,"column":27,"offset":6497},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":306,"column":27,"offset":6497},"end":{"line":306,"column":28,"offset":6498},"indent":[]}}],"position":{"start":{"line":306,"column":1,"offset":6471},"end":{"line":306,"column":28,"offset":6498},"indent":[]}}],"position":{"start":{"line":305,"column":1,"offset":6460},"end":{"line":306,"column":28,"offset":6498},"indent":[1]}}],"position":{"start":{"line":303,"column":1,"offset":6429},"end":{"line":306,"column":28,"offset":6498},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"// pug login form!","position":{"start":{"line":308,"column":1,"offset":6500},"end":{"line":308,"column":19,"offset":6518},"indent":[]}}],"position":{"start":{"line":308,"column":1,"offset":6500},"end":{"line":308,"column":19,"offset":6518},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// views/login.pug","position":{"start":{"line":310,"column":1,"offset":6520},"end":{"line":310,"column":19,"offset":6538},"indent":[]}}],"position":{"start":{"line":310,"column":1,"offset":6520},"end":{"line":310,"column":19,"offset":6538},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"extends layout","position":{"start":{"line":312,"column":1,"offset":6540},"end":{"line":312,"column":15,"offset":6554},"indent":[]}}],"position":{"start":{"line":312,"column":1,"offset":6540},"end":{"line":312,"column":15,"offset":6554},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"block content\n  .main.container\n    .row\n      .col-md-6.col-md-offset-3\n        h1.display-4.m-b-2 Log In\n        form(method='POST' action='/login')\n          div.form-group\n            label(for='email') Email\n            input.form-control(type='text' id='email' placeholder='email' name='email')\n          div.form-group\n            label(for='password') Password\n            input.form-control(type='password' id='password' placeholder='password' name='password')\n          button.btn.btn-primary(type='submit') Log in","position":{"start":{"line":314,"column":1,"offset":6556},"end":{"line":326,"column":55,"offset":7080},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":314,"column":1,"offset":6556},"end":{"line":326,"column":55,"offset":7080},"indent":[1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":328,"column":1,"offset":7082},"end":{"line":328,"column":2,"offset":7083},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"**","position":{"start":{"line":328,"column":14,"offset":7095},"end":{"line":328,"column":16,"offset":7097},"indent":[]}}],"position":{"start":{"line":328,"column":12,"offset":7093},"end":{"line":328,"column":18,"offset":7099},"indent":[]}}],"position":{"start":{"line":328,"column":10,"offset":7091},"end":{"line":328,"column":20,"offset":7101},"indent":[]}}],"position":{"start":{"line":328,"column":8,"offset":7089},"end":{"line":328,"column":22,"offset":7103},"indent":[]}}],"position":{"start":{"line":328,"column":6,"offset":7087},"end":{"line":328,"column":24,"offset":7105},"indent":[]}}],"position":{"start":{"line":328,"column":4,"offset":7085},"end":{"line":328,"column":26,"offset":7107},"indent":[]}}],"position":{"start":{"line":328,"column":2,"offset":7083},"end":{"line":328,"column":28,"offset":7109},"indent":[]}}],"position":{"start":{"line":328,"column":1,"offset":7082},"end":{"line":328,"column":28,"offset":7109},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t  *","position":{"start":{"line":329,"column":3,"offset":7112},"end":{"line":329,"column":11,"offset":7120},"indent":[]}}],"position":{"start":{"line":329,"column":1,"offset":7110},"end":{"line":329,"column":11,"offset":7120},"indent":[]}}],"position":{"start":{"line":329,"column":1,"offset":7110},"end":{"line":329,"column":11,"offset":7120},"indent":[]}},{"type":"list","ordered":true,"start":12,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Auth the Username\nand Password","position":{"start":{"line":330,"column":8,"offset":7128},"end":{"line":331,"column":17,"offset":7162},"indent":[5]}}],"position":{"start":{"line":330,"column":8,"offset":7128},"end":{"line":331,"column":17,"offset":7162},"indent":[5]}}],"position":{"start":{"line":330,"column":1,"offset":7121},"end":{"line":331,"column":17,"offset":7162},"indent":[1]}}],"position":{"start":{"line":330,"column":1,"offset":7121},"end":{"line":331,"column":17,"offset":7162},"indent":[1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t  *","position":{"start":{"line":332,"column":3,"offset":7165},"end":{"line":332,"column":11,"offset":7173},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"**","position":{"start":{"line":333,"column":13,"offset":7186},"end":{"line":333,"column":15,"offset":7188},"indent":[]}}],"position":{"start":{"line":333,"column":11,"offset":7184},"end":{"line":333,"column":17,"offset":7190},"indent":[]}}],"position":{"start":{"line":333,"column":9,"offset":7182},"end":{"line":333,"column":19,"offset":7192},"indent":[]}}],"position":{"start":{"line":333,"column":7,"offset":7180},"end":{"line":333,"column":21,"offset":7194},"indent":[]}}],"position":{"start":{"line":333,"column":5,"offset":7178},"end":{"line":333,"column":23,"offset":7196},"indent":[]}}],"position":{"start":{"line":333,"column":3,"offset":7176},"end":{"line":333,"column":25,"offset":7198},"indent":[]}}],"position":{"start":{"line":333,"column":1,"offset":7174},"end":{"line":333,"column":27,"offset":7200},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":333,"column":27,"offset":7200},"end":{"line":333,"column":28,"offset":7201},"indent":[]}}],"position":{"start":{"line":333,"column":1,"offset":7174},"end":{"line":333,"column":28,"offset":7201},"indent":[]}}],"position":{"start":{"line":332,"column":1,"offset":7163},"end":{"line":333,"column":28,"offset":7201},"indent":[1]}}],"position":{"start":{"line":332,"column":1,"offset":7163},"end":{"line":333,"column":28,"offset":7201},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"// Example in app.js for Express","position":{"start":{"line":335,"column":1,"offset":7203},"end":{"line":335,"column":33,"offset":7235},"indent":[]}}],"position":{"start":{"line":335,"column":1,"offset":7203},"end":{"line":335,"column":33,"offset":7235},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"router.post('/login', function(req, res, next) {\n\tif (req.body.email && req.body.password) {\n\t\tUser.authenticate(req.body.email, req.body.password, function (error, user) {\n\t\t\tif (error || !user) {\n\t\t\t\tvar err = new Error('Wrong email or password.');\n\t\t\t\terr.status = 401;\n\t\t\t\treturn next(err);\n\t\t\t} else {\n\t\t\t\treq.session.userId = user._id;\n\t\t\t\treturn res.redirect('/profile');\n\t\t\t}\n\t\t});\n\t} else {\n\t\tvar err = new Error('Email and password are required.');\n\t\terr.status = 401;\n\t\treturn next(err);\n\t}\n});","position":{"start":{"line":337,"column":1,"offset":7237},"end":{"line":354,"column":4,"offset":7742},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":337,"column":1,"offset":7237},"end":{"line":354,"column":4,"offset":7742},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"// in user.js","position":{"start":{"line":356,"column":1,"offset":7744},"end":{"line":356,"column":14,"offset":7757},"indent":[]}}],"position":{"start":{"line":356,"column":1,"offset":7744},"end":{"line":356,"column":14,"offset":7757},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"UserSchema.statics.authenticate = function(email, password, callback) {\n\tUser.findOne({ email: email })\n\t\t.exec(function (error, user) {\n\t\t\tif (error) {\n\t\t\t\treturn callback(error);\n\t\t\t} else if (!user) {\n\t\t\t\tvar err = new Error('User not found.');\n\t\t\t\terr.status = 401;\n\t\t\t\treturn callback(err);\n\t\t\t}\n\t\t\tbcrypt.compare(password, user.password, function (error, result) {\n\t\t\t\tif (result === true) {\n\t\t\t\t\treturn callback(null, user);\n\t\t\t\t} else {\n\t\t\t\t\treturn callback();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n}","position":{"start":{"line":358,"column":1,"offset":7759},"end":{"line":376,"column":2,"offset":8248},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":358,"column":1,"offset":7759},"end":{"line":376,"column":2,"offset":8248},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":378,"column":1,"offset":8250},"end":{"line":378,"column":2,"offset":8251},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":378,"column":12,"offset":8261},"end":{"line":378,"column":16,"offset":8265},"indent":[]}}],"position":{"start":{"line":378,"column":10,"offset":8259},"end":{"line":378,"column":18,"offset":8267},"indent":[]}}],"position":{"start":{"line":378,"column":8,"offset":8257},"end":{"line":378,"column":20,"offset":8269},"indent":[]}}],"position":{"start":{"line":378,"column":6,"offset":8255},"end":{"line":378,"column":22,"offset":8271},"indent":[]}}],"position":{"start":{"line":378,"column":4,"offset":8253},"end":{"line":378,"column":24,"offset":8273},"indent":[]}}],"position":{"start":{"line":378,"column":2,"offset":8251},"end":{"line":378,"column":26,"offset":8275},"indent":[]}}],"position":{"start":{"line":378,"column":1,"offset":8250},"end":{"line":378,"column":26,"offset":8275},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t*","position":{"start":{"line":379,"column":3,"offset":8278},"end":{"line":379,"column":9,"offset":8284},"indent":[]}}],"position":{"start":{"line":379,"column":1,"offset":8276},"end":{"line":379,"column":9,"offset":8284},"indent":[]}}],"position":{"start":{"line":379,"column":1,"offset":8276},"end":{"line":379,"column":9,"offset":8284},"indent":[]}},{"type":"list","ordered":true,"start":13,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Profile Route\n\t\tand Page","position":{"start":{"line":380,"column":8,"offset":8292},"end":{"line":381,"column":14,"offset":8319},"indent":[4]}}],"position":{"start":{"line":380,"column":8,"offset":8292},"end":{"line":381,"column":14,"offset":8319},"indent":[4]}}],"position":{"start":{"line":380,"column":1,"offset":8285},"end":{"line":381,"column":14,"offset":8319},"indent":[1]}}],"position":{"start":{"line":380,"column":1,"offset":8285},"end":{"line":381,"column":14,"offset":8319},"indent":[1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t*","position":{"start":{"line":382,"column":3,"offset":8322},"end":{"line":382,"column":9,"offset":8328},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":383,"column":11,"offset":8339},"end":{"line":383,"column":15,"offset":8343},"indent":[]}}],"position":{"start":{"line":383,"column":9,"offset":8337},"end":{"line":383,"column":17,"offset":8345},"indent":[]}}],"position":{"start":{"line":383,"column":7,"offset":8335},"end":{"line":383,"column":19,"offset":8347},"indent":[]}}],"position":{"start":{"line":383,"column":5,"offset":8333},"end":{"line":383,"column":21,"offset":8349},"indent":[]}}],"position":{"start":{"line":383,"column":3,"offset":8331},"end":{"line":383,"column":23,"offset":8351},"indent":[]}}],"position":{"start":{"line":383,"column":1,"offset":8329},"end":{"line":383,"column":25,"offset":8353},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":383,"column":25,"offset":8353},"end":{"line":383,"column":26,"offset":8354},"indent":[]}}],"position":{"start":{"line":383,"column":1,"offset":8329},"end":{"line":383,"column":26,"offset":8354},"indent":[]}}],"position":{"start":{"line":382,"column":1,"offset":8320},"end":{"line":383,"column":26,"offset":8354},"indent":[1]}}],"position":{"start":{"line":382,"column":1,"offset":8320},"end":{"line":383,"column":26,"offset":8354},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"profile.pug","position":{"start":{"line":385,"column":1,"offset":8356},"end":{"line":385,"column":12,"offset":8367},"indent":[]}}],"position":{"start":{"line":385,"column":1,"offset":8356},"end":{"line":385,"column":12,"offset":8367},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"extends layout","position":{"start":{"line":387,"column":1,"offset":8369},"end":{"line":387,"column":15,"offset":8383},"indent":[]}}],"position":{"start":{"line":387,"column":1,"offset":8369},"end":{"line":387,"column":15,"offset":8383},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"block content\n  .main.container.clearfix\n    .row\n      .col-md-8.col-md-offset-2\n        h1.display-4\n          img.avatar.img-circle.hidden-xs-down(src='/images/avatar.png', alt='avatar')\n          | #{name}\n        h2.favorite-book Favorite Book\n        | #{favorite}","position":{"start":{"line":389,"column":1,"offset":8385},"end":{"line":397,"column":22,"offset":8655},"indent":[1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":389,"column":1,"offset":8385},"end":{"line":397,"column":22,"offset":8655},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"// GET /profile","position":{"start":{"line":399,"column":1,"offset":8657},"end":{"line":399,"column":16,"offset":8672},"indent":[]}}],"position":{"start":{"line":399,"column":1,"offset":8657},"end":{"line":399,"column":16,"offset":8672},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"router.get('/profile', function(req, res, next) {\n  if (! req.session.userId ) {\n    var err = new Error(\"You are not authorized to view this page.\");\n    err.status = 403;\n    return next(err);\n  }\n  User.findById(req.session.userId)\n      .exec(function (error, user) {\n        if (error) {\n          return next(error);\n        } else {\n          return res.render('profile', { title: 'Profile', name: user.name, favorite: user.favoriteBook });\n        }\n      });\n});","position":{"start":{"line":401,"column":1,"offset":8674},"end":{"line":415,"column":4,"offset":9145},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":401,"column":1,"offset":8674},"end":{"line":415,"column":4,"offset":9145},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/////////////////////////////////////////////////////////","position":{"start":{"line":417,"column":1,"offset":9147},"end":{"line":417,"column":58,"offset":9204},"indent":[]}}],"position":{"start":{"line":417,"column":1,"offset":9147},"end":{"line":417,"column":58,"offset":9204},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"PART 4","position":{"start":{"line":419,"column":1,"offset":9206},"end":{"line":419,"column":7,"offset":9212},"indent":[]}}],"position":{"start":{"line":419,"column":1,"offset":9206},"end":{"line":419,"column":7,"offset":9212},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":421,"column":1,"offset":9214},"end":{"line":421,"column":2,"offset":9215},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":421,"column":14,"offset":9227},"end":{"line":421,"column":18,"offset":9231},"indent":[]}}],"position":{"start":{"line":421,"column":12,"offset":9225},"end":{"line":421,"column":20,"offset":9233},"indent":[]}}],"position":{"start":{"line":421,"column":10,"offset":9223},"end":{"line":421,"column":22,"offset":9235},"indent":[]}}],"position":{"start":{"line":421,"column":8,"offset":9221},"end":{"line":421,"column":24,"offset":9237},"indent":[]}}],"position":{"start":{"line":421,"column":6,"offset":9219},"end":{"line":421,"column":26,"offset":9239},"indent":[]}}],"position":{"start":{"line":421,"column":4,"offset":9217},"end":{"line":421,"column":28,"offset":9241},"indent":[]}}],"position":{"start":{"line":421,"column":2,"offset":9215},"end":{"line":421,"column":30,"offset":9243},"indent":[]}}],"position":{"start":{"line":421,"column":1,"offset":9214},"end":{"line":421,"column":30,"offset":9243},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*\n\t  14. Using Session","position":{"start":{"line":422,"column":3,"offset":9246},"end":{"line":423,"column":21,"offset":9274},"indent":[0]}},{"type":"paragraph","children":[{"type":"text","value":"Vars to Customize Content","position":{"start":{"line":424,"column":3,"offset":9277},"end":{"line":424,"column":28,"offset":9302},"indent":[]}}],"position":{"start":{"line":424,"column":3,"offset":9277},"end":{"line":424,"column":28,"offset":9302},"indent":[]}}],"position":{"start":{"line":422,"column":1,"offset":9244},"end":{"line":424,"column":28,"offset":9302},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":425,"column":3,"offset":9305},"end":{"line":425,"column":10,"offset":9312},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":426,"column":13,"offset":9325},"end":{"line":426,"column":17,"offset":9329},"indent":[]}}],"position":{"start":{"line":426,"column":11,"offset":9323},"end":{"line":426,"column":19,"offset":9331},"indent":[]}}],"position":{"start":{"line":426,"column":9,"offset":9321},"end":{"line":426,"column":21,"offset":9333},"indent":[]}}],"position":{"start":{"line":426,"column":7,"offset":9319},"end":{"line":426,"column":23,"offset":9335},"indent":[]}}],"position":{"start":{"line":426,"column":5,"offset":9317},"end":{"line":426,"column":25,"offset":9337},"indent":[]}}],"position":{"start":{"line":426,"column":3,"offset":9315},"end":{"line":426,"column":27,"offset":9339},"indent":[]}}],"position":{"start":{"line":426,"column":1,"offset":9313},"end":{"line":426,"column":29,"offset":9341},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":426,"column":29,"offset":9341},"end":{"line":426,"column":30,"offset":9342},"indent":[]}}],"position":{"start":{"line":426,"column":1,"offset":9313},"end":{"line":426,"column":30,"offset":9342},"indent":[]}}],"position":{"start":{"line":425,"column":1,"offset":9303},"end":{"line":426,"column":30,"offset":9342},"indent":[1]}}],"position":{"start":{"line":422,"column":1,"offset":9244},"end":{"line":426,"column":30,"offset":9342},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"To make user id global","position":{"start":{"line":428,"column":1,"offset":9344},"end":{"line":428,"column":23,"offset":9366},"indent":[]}}],"position":{"start":{"line":428,"column":1,"offset":9344},"end":{"line":428,"column":23,"offset":9366},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// in app.js","position":{"start":{"line":430,"column":1,"offset":9368},"end":{"line":430,"column":13,"offset":9380},"indent":[]}}],"position":{"start":{"line":430,"column":1,"offset":9368},"end":{"line":430,"column":13,"offset":9380},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// make user id available to templates\napp.use(function (req,res,next) {\n\tres.locals.currentUser = req.session.userId;\n\tnext();\n});","position":{"start":{"line":432,"column":1,"offset":9382},"end":{"line":436,"column":4,"offset":9513},"indent":[1,1,1,1]}}],"position":{"start":{"line":432,"column":1,"offset":9382},"end":{"line":436,"column":4,"offset":9513},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"For the new logout route","position":{"start":{"line":438,"column":1,"offset":9515},"end":{"line":438,"column":25,"offset":9539},"indent":[]}}],"position":{"start":{"line":438,"column":1,"offset":9515},"end":{"line":438,"column":25,"offset":9539},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"router.get('/logout', function (req, res, next) {\n\tif (req.session) {\n\t\treq.session.destroy(function(err) {\n\t\t\tif (err) {\n\t\t\t\treturn next(err);\n\t\t\t} else {\n\t\t\t\treturn res.redirect('/');\n\t\t\t}\n\t\t});\t\n\t}\n});","position":{"start":{"line":440,"column":1,"offset":9541},"end":{"line":450,"column":4,"offset":9745},"indent":[1,1,1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":440,"column":1,"offset":9541},"end":{"line":450,"column":4,"offset":9745},"indent":[1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":452,"column":1,"offset":9747},"end":{"line":452,"column":2,"offset":9748},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":452,"column":14,"offset":9760},"end":{"line":452,"column":18,"offset":9764},"indent":[]}}],"position":{"start":{"line":452,"column":12,"offset":9758},"end":{"line":452,"column":20,"offset":9766},"indent":[]}}],"position":{"start":{"line":452,"column":10,"offset":9756},"end":{"line":452,"column":22,"offset":9768},"indent":[]}}],"position":{"start":{"line":452,"column":8,"offset":9754},"end":{"line":452,"column":24,"offset":9770},"indent":[]}}],"position":{"start":{"line":452,"column":6,"offset":9752},"end":{"line":452,"column":26,"offset":9772},"indent":[]}}],"position":{"start":{"line":452,"column":4,"offset":9750},"end":{"line":452,"column":28,"offset":9774},"indent":[]}}],"position":{"start":{"line":452,"column":2,"offset":9748},"end":{"line":452,"column":30,"offset":9776},"indent":[]}}],"position":{"start":{"line":452,"column":1,"offset":9747},"end":{"line":452,"column":30,"offset":9776},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":453,"column":3,"offset":9779},"end":{"line":453,"column":10,"offset":9786},"indent":[]}},{"type":"list","ordered":true,"start":15,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Understanding\nMiddleware","position":{"start":{"line":454,"column":8,"offset":9794},"end":{"line":455,"column":17,"offset":9824},"indent":[7]}}],"position":{"start":{"line":454,"column":8,"offset":9794},"end":{"line":455,"column":17,"offset":9824},"indent":[7]}}],"position":{"start":{"line":454,"column":2,"offset":9788},"end":{"line":455,"column":17,"offset":9824},"indent":[2]}}],"position":{"start":{"line":454,"column":2,"offset":9788},"end":{"line":455,"column":17,"offset":9824},"indent":[2]}}],"position":{"start":{"line":453,"column":1,"offset":9777},"end":{"line":455,"column":17,"offset":9824},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":456,"column":3,"offset":9827},"end":{"line":456,"column":10,"offset":9834},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":457,"column":13,"offset":9847},"end":{"line":457,"column":17,"offset":9851},"indent":[]}}],"position":{"start":{"line":457,"column":11,"offset":9845},"end":{"line":457,"column":19,"offset":9853},"indent":[]}}],"position":{"start":{"line":457,"column":9,"offset":9843},"end":{"line":457,"column":21,"offset":9855},"indent":[]}}],"position":{"start":{"line":457,"column":7,"offset":9841},"end":{"line":457,"column":23,"offset":9857},"indent":[]}}],"position":{"start":{"line":457,"column":5,"offset":9839},"end":{"line":457,"column":25,"offset":9859},"indent":[]}}],"position":{"start":{"line":457,"column":3,"offset":9837},"end":{"line":457,"column":27,"offset":9861},"indent":[]}}],"position":{"start":{"line":457,"column":1,"offset":9835},"end":{"line":457,"column":29,"offset":9863},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":457,"column":29,"offset":9863},"end":{"line":457,"column":30,"offset":9864},"indent":[]}}],"position":{"start":{"line":457,"column":1,"offset":9835},"end":{"line":457,"column":30,"offset":9864},"indent":[]}}],"position":{"start":{"line":456,"column":1,"offset":9825},"end":{"line":457,"column":30,"offset":9864},"indent":[1]}}],"position":{"start":{"line":453,"column":1,"offset":9777},"end":{"line":457,"column":30,"offset":9864},"indent":[1,1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"between requests and responses ","position":{"start":{"line":459,"column":3,"offset":9868},"end":{"line":459,"column":34,"offset":9899},"indent":[]}}],"position":{"start":{"line":459,"column":3,"offset":9868},"end":{"line":459,"column":34,"offset":9899},"indent":[]}}],"position":{"start":{"line":459,"column":1,"offset":9866},"end":{"line":459,"column":34,"offset":9899},"indent":[]}}],"position":{"start":{"line":459,"column":1,"offset":9866},"end":{"line":459,"column":34,"offset":9899},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"app.use //middleware","position":{"start":{"line":461,"column":1,"offset":9901},"end":{"line":461,"column":21,"offset":9921},"indent":[]}}],"position":{"start":{"line":461,"column":1,"offset":9901},"end":{"line":461,"column":21,"offset":9921},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"//session middleware\napp.use(session({\n\tsecret: 'treehouse loves you',\n\tresave: true,\n\tsaveUninitialized: false\n}));","position":{"start":{"line":463,"column":1,"offset":9923},"end":{"line":468,"column":5,"offset":10039},"indent":[1,1,1,1,1]}}],"position":{"start":{"line":463,"column":1,"offset":9923},"end":{"line":468,"column":5,"offset":10039},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Request/Response Cycle","position":{"start":{"line":470,"column":1,"offset":10041},"end":{"line":470,"column":23,"offset":10063},"indent":[]}}],"position":{"start":{"line":470,"column":1,"offset":10041},"end":{"line":470,"column":23,"offset":10063},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"app.use(function (req,res,next) {\n\t...\n\tnext(); //custom middleware ALWAYS needs call to next\n});","position":{"start":{"line":472,"column":1,"offset":10065},"end":{"line":475,"column":4,"offset":10162},"indent":[1,1,1]}}],"position":{"start":{"line":472,"column":1,"offset":10065},"end":{"line":475,"column":4,"offset":10162},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"// CUSTOM MIDDLEWARE","position":{"start":{"line":479,"column":1,"offset":10166},"end":{"line":479,"column":21,"offset":10186},"indent":[]}}],"position":{"start":{"line":479,"column":1,"offset":10166},"end":{"line":479,"column":21,"offset":10186},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"create middleware folder","position":{"start":{"line":481,"column":1,"offset":10188},"end":{"line":481,"column":25,"offset":10212},"indent":[]}}],"position":{"start":{"line":481,"column":1,"offset":10188},"end":{"line":481,"column":25,"offset":10212},"indent":[]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"index.js","position":{"start":{"line":482,"column":3,"offset":10215},"end":{"line":482,"column":11,"offset":10223},"indent":[]}}],"position":{"start":{"line":482,"column":3,"offset":10215},"end":{"line":482,"column":11,"offset":10223},"indent":[]}}],"position":{"start":{"line":482,"column":1,"offset":10213},"end":{"line":482,"column":11,"offset":10223},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"function loggedOut(req, res, next) {\n\tif (req.session && req.session.userId) {\n\t\treturn res.redirect('profile');\n\t}\n\treturn next();\n}","position":{"start":{"line":484,"column":1,"offset":10225},"end":{"line":489,"column":2,"offset":10358},"indent":[1,1,1,1,1]}}],"position":{"start":{"line":484,"column":1,"offset":10225},"end":{"line":489,"column":2,"offset":10358},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"module.exports.loggedOut = loggedOut;","position":{"start":{"line":491,"column":1,"offset":10360},"end":{"line":491,"column":38,"offset":10397},"indent":[]}}],"position":{"start":{"line":491,"column":1,"offset":10360},"end":{"line":491,"column":38,"offset":10397},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"var mid = require('../middleware');","position":{"start":{"line":493,"column":1,"offset":10399},"end":{"line":493,"column":36,"offset":10434},"indent":[]}}],"position":{"start":{"line":493,"column":1,"offset":10399},"end":{"line":493,"column":36,"offset":10434},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"now we can reference the function by mid.loggedOut","position":{"start":{"line":495,"column":3,"offset":10438},"end":{"line":495,"column":53,"offset":10488},"indent":[]}}],"position":{"start":{"line":495,"column":3,"offset":10438},"end":{"line":495,"column":53,"offset":10488},"indent":[]}}],"position":{"start":{"line":495,"column":1,"offset":10436},"end":{"line":495,"column":53,"offset":10488},"indent":[]}}],"position":{"start":{"line":495,"column":1,"offset":10436},"end":{"line":495,"column":53,"offset":10488},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Now, in the routes we want to double check... we can put the func in.","position":{"start":{"line":497,"column":1,"offset":10490},"end":{"line":497,"column":70,"offset":10559},"indent":[]}}],"position":{"start":{"line":497,"column":1,"offset":10490},"end":{"line":497,"column":70,"offset":10559},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"eg.\nrouter.get('/register', mid.loggedOut, function(req, res, next) {\n\treturn res.render('register', { title: 'Sign up' });\n});","position":{"start":{"line":499,"column":1,"offset":10561},"end":{"line":502,"column":4,"offset":10688},"indent":[1,1,1]}}],"position":{"start":{"line":499,"column":1,"offset":10561},"end":{"line":502,"column":4,"offset":10688},"indent":[1,1,1]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"index.js","position":{"start":{"line":504,"column":3,"offset":10692},"end":{"line":504,"column":11,"offset":10700},"indent":[]}}],"position":{"start":{"line":504,"column":3,"offset":10692},"end":{"line":504,"column":11,"offset":10700},"indent":[]}}],"position":{"start":{"line":504,"column":1,"offset":10690},"end":{"line":504,"column":11,"offset":10700},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"function requiresLogin(req, res, next) {\n\tif (req.session && req.session.userId) {\n\t\tnext();\n\t} else {\n\t\tvar err = new Error('You do not have permission to see this.');\n\t\terr.status = 401;\n\t\treturn next(err);\n\t}\n}","position":{"start":{"line":506,"column":1,"offset":10702},"end":{"line":514,"column":2,"offset":10915},"indent":[1,1,1,1,1,1,1,1]}}],"position":{"start":{"line":506,"column":1,"offset":10702},"end":{"line":514,"column":2,"offset":10915},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"module.exports.requiresLogin = requiresLogin;","position":{"start":{"line":516,"column":1,"offset":10917},"end":{"line":516,"column":46,"offset":10962},"indent":[]}}],"position":{"start":{"line":516,"column":1,"offset":10917},"end":{"line":516,"column":46,"offset":10962},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"/","position":{"start":{"line":518,"column":1,"offset":10964},"end":{"line":518,"column":2,"offset":10965},"indent":[]}},{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":518,"column":14,"offset":10977},"end":{"line":518,"column":18,"offset":10981},"indent":[]}}],"position":{"start":{"line":518,"column":12,"offset":10975},"end":{"line":518,"column":20,"offset":10983},"indent":[]}}],"position":{"start":{"line":518,"column":10,"offset":10973},"end":{"line":518,"column":22,"offset":10985},"indent":[]}}],"position":{"start":{"line":518,"column":8,"offset":10971},"end":{"line":518,"column":24,"offset":10987},"indent":[]}}],"position":{"start":{"line":518,"column":6,"offset":10969},"end":{"line":518,"column":26,"offset":10989},"indent":[]}}],"position":{"start":{"line":518,"column":4,"offset":10967},"end":{"line":518,"column":28,"offset":10991},"indent":[]}}],"position":{"start":{"line":518,"column":2,"offset":10965},"end":{"line":518,"column":30,"offset":10993},"indent":[]}}],"position":{"start":{"line":518,"column":1,"offset":10964},"end":{"line":518,"column":30,"offset":10993},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":519,"column":3,"offset":10996},"end":{"line":519,"column":10,"offset":11003},"indent":[]}},{"type":"list","ordered":true,"start":16,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Using MongoDB\nas a Session Store","position":{"start":{"line":520,"column":8,"offset":11011},"end":{"line":521,"column":21,"offset":11045},"indent":[3]}}],"position":{"start":{"line":520,"column":8,"offset":11011},"end":{"line":521,"column":21,"offset":11045},"indent":[3]}}],"position":{"start":{"line":520,"column":2,"offset":11005},"end":{"line":521,"column":21,"offset":11045},"indent":[2]}}],"position":{"start":{"line":520,"column":2,"offset":11005},"end":{"line":521,"column":21,"offset":11045},"indent":[2]}}],"position":{"start":{"line":519,"column":1,"offset":10994},"end":{"line":521,"column":21,"offset":11045},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"code","lang":null,"meta":null,"value":"\t\t\t\t\t*","position":{"start":{"line":522,"column":3,"offset":11048},"end":{"line":522,"column":10,"offset":11055},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"strong","children":[{"type":"text","value":"****","position":{"start":{"line":523,"column":13,"offset":11068},"end":{"line":523,"column":17,"offset":11072},"indent":[]}}],"position":{"start":{"line":523,"column":11,"offset":11066},"end":{"line":523,"column":19,"offset":11074},"indent":[]}}],"position":{"start":{"line":523,"column":9,"offset":11064},"end":{"line":523,"column":21,"offset":11076},"indent":[]}}],"position":{"start":{"line":523,"column":7,"offset":11062},"end":{"line":523,"column":23,"offset":11078},"indent":[]}}],"position":{"start":{"line":523,"column":5,"offset":11060},"end":{"line":523,"column":25,"offset":11080},"indent":[]}}],"position":{"start":{"line":523,"column":3,"offset":11058},"end":{"line":523,"column":27,"offset":11082},"indent":[]}}],"position":{"start":{"line":523,"column":1,"offset":11056},"end":{"line":523,"column":29,"offset":11084},"indent":[]}},{"type":"text","value":"/","position":{"start":{"line":523,"column":29,"offset":11084},"end":{"line":523,"column":30,"offset":11085},"indent":[]}}],"position":{"start":{"line":523,"column":1,"offset":11056},"end":{"line":523,"column":30,"offset":11085},"indent":[]}}],"position":{"start":{"line":522,"column":1,"offset":11046},"end":{"line":523,"column":30,"offset":11085},"indent":[1]}}],"position":{"start":{"line":519,"column":1,"offset":10994},"end":{"line":523,"column":30,"offset":11085},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"connect-mongo is a middleware already written for us!","position":{"start":{"line":525,"column":1,"offset":11087},"end":{"line":525,"column":54,"offset":11140},"indent":[]}}],"position":{"start":{"line":525,"column":1,"offset":11087},"end":{"line":525,"column":54,"offset":11140},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"npm install connect-mongo --save","position":{"start":{"line":527,"column":1,"offset":11142},"end":{"line":527,"column":33,"offset":11174},"indent":[]}}],"position":{"start":{"line":527,"column":1,"offset":11142},"end":{"line":527,"column":33,"offset":11174},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"require MongoStore = require('connect-mongo')(session);","position":{"start":{"line":529,"column":1,"offset":11176},"end":{"line":529,"column":56,"offset":11231},"indent":[]}}],"position":{"start":{"line":529,"column":1,"offset":11176},"end":{"line":529,"column":56,"offset":11231},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"// in app.js","position":{"start":{"line":531,"column":1,"offset":11233},"end":{"line":531,"column":13,"offset":11245},"indent":[]}}],"position":{"start":{"line":531,"column":1,"offset":11233},"end":{"line":531,"column":13,"offset":11245},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"app.use(session({\n\tsecret: 'treehouse loves you',\n\tresave: true,\n\tsaveUninitialized: false\n\tstore: new MongoStore({\n\t\tmongooseConnection: db \n\t})\n}));","position":{"start":{"line":533,"column":1,"offset":11247},"end":{"line":540,"column":5,"offset":11397},"indent":[1,1,1,1,1,1,1]}}],"position":{"start":{"line":533,"column":1,"offset":11247},"end":{"line":540,"column":5,"offset":11397},"indent":[1,1,1,1,1,1,1]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":546,"column":1,"offset":11403},"end":{"line":546,"column":31,"offset":11433},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":546,"column":31,"offset":11433}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <p>{`USER AUTHENTICATION WITH EXPRESS AND MONGO`}</p>\n    <p>{`/////////////////////////////////////////////////////////`}</p>\n    <p>{`PART 1`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\">\n          <li parentName=\"ol\">{`The Project`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`Setting up credentials to do what you say you want to do`}</p>\n    <p>{`Authentication vs Authorization`}</p>\n    <p>{`Authentication: Confirming the user is who they say they are\nAuthorization: Where you are and aren't allow to see certain information`}</p>\n    <p>{`Steps:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Create an account`}</li>\n      <li parentName=\"ul\">{`Checks if it matches a record in the database`}</li>\n    </ul>\n    <p>{`While the user is logged in, they can alter the page depending on the user infomation.`}</p>\n    <p>{`Sessions can be used for a db to have \"unique token\" which sticks with you and your device until the end of the session.`}</p>\n    <p>{`//////////////`}</p>\n    <p>{`The project uses Express and MongoDB`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre></li>\n    </ul>\n    <ol {...{\n      \"start\": 2\n    }}>\n      <li parentName=\"ol\">{`Setting up the Project`}</li>\n    </ol>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`npm install body-parser\t\t\t// parsing incoming requests\nnpm install express\nnpm install pug\t\t\t\t\t// used for jade`}</p>\n    <p>{`/////////////////////////////////////////////////////////`}</p>\n    <p>{`PART 2`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 3\n        }}>\n          <li parentName=\"ol\">{`Registration`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`// adding routes for registration form`}</p>\n    <p>{`router.get('/register', function (req, res, next) {\nreturn res.send('Register today!');\n});`}</p>\n    <p>{`router.post('/register', function (req, res, next) {\nreturn res.send('User Created!');\n});`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 4\n        }}>\n          <li parentName=\"ol\">{`Nodemon / Pug files`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <ul>\n      <li parentName=\"ul\">{`Starts the app and refreshes each .js save`}</li>\n      <li parentName=\"ul\">{`Wrapper for node`}</li>\n    </ul>\n    <p>{`PUG FORM - register.pug `}</p>\n    <p>{`extends layout`}</p>\n    <p>{`block content\n.main.container.row\n.col-md-6.col-md-offset-3\nh1.display-4.m-b-2 Sign Up`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`        //register form\n        form(method='POST' action='/register')\n        div.form-group\n            label(for='name') Name:\n            input#name.form-control(type='text', placeholder='first and last' name='name')\n        div.form-group\n            label(for='email') Email:\n            input#email.form-control(type='email', placeholder='name@email.com' name='email')\n        div.form-group\n            label(for='favoriteBook') Favorite Book:\n            input#favoriteBook.form-control(type='text', placeholder='title of book' name='favoriteBook')\n        div.form-group\n            label(for='pw') Password:\n            input#pw.form-control(type='password' name='password')\n        div.form-group\n            label(for='pw2') Confirm Password:\n            input#pw2.form-control(type='password' name='confirmPassword')\n        button.btn.btn-primary(type='submit') Sign up\n`}</code></pre>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 5\n        }}>\n          <li parentName=\"ol\">{`Setting up MongoDB`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <ul>\n      <li parentName=\"ul\">{`Mongoose is the most used for Express applications`}</li>\n    </ul>\n    <p>{`npm install --save mongoose`}</p>\n    <p>{`// in the app.js`}</p>\n    <p>{`var mongoose = require('mongoose');`}</p>\n    <p>{`mongoose.connect(\"mongodb://localhost:27017/bookworm\");`}</p>\n    <p>{`var db = mongoose.connection;`}</p>\n    <p>{`db.on('error', console.error.bind(console, 'connection error:')); `}</p>\n    <p>{`// running mongo`}</p>\n    <p>{`mongod`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 6\n        }}>\n          <li parentName=\"ol\">{`Defining the Mongo\nSchema`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`Store: name, email, password etc.`}</p>\n    <p>{`in models, created user.js`}</p>\n    <p>{`// user.js`}</p>\n    <p>{`var mongoose = require('mongoose');`}</p>\n    <p>{`var UserSchema = new mongoose.Schema({\nemail: {\ntype: String,\nrequired: true,\ntrim: true,\nunique: true,\n},\nname: {\ntype: String,\nrequired: true,\ntrim: true,\n},\nfavoriteBook: {\ntype: String,\nrequired: true,\ntrim: true\n},\npassword: {\ntype: String,\nrequired: true\n}\n});`}</p>\n    <p>{`var User = mongoose.model('User', UserSchema);\nmodule.exports = User;`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 7\n        }}>\n          <li parentName=\"ol\">{`Adding the Data`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`// in app.js`}</p>\n    <p>{`var User = require('../models/user');`}</p>\n    <p>{`...`}</p>\n    <p>{`router.post('/register', function(req,res,next) {\nif (req.body.email &&\nreq.body.name &&\nreq.body.favoriteBook &&\nreq.body.password &&\nreq.body.confirmPassword) {`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`    if (req.body.password !== req.body.confirmPassword) {\n        var err = new Error('Passwords do not match.');\n        err.status = 400;\n        return next(err);\n    }\n\n    // create object with form input\n\n    var userData = {\n        email: req.body.email\n        name: req.body.name\n        favouriteBook: req.body.favouriteBook,\n        password: req.body.password\n    };\n\n    // use schema's create method to insert document\n    User.create(userData, function (error, user) {\n        if (error) {\n            return next(error);\n        } else {\n            return res.redirect('/profile');\n        }\n    });\n\n} else {\n    var err = new Error('All fields required');\n    err.status = 400;\n    return next(err);\n}\n`}</code></pre>\n    <p>{`});`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 8\n        }}>\n          <li parentName=\"ol\">{`Hashing and Salting`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`npm install bcrypt --save`}</p>\n    <p>{`// in use `}</p>\n    <p>{`// in User.js`}</p>\n    <p>{`var bcrypt = require('bcrypt');`}</p>\n    <p>{`// MONGOOSE PRESAVE HOOK\nUserSchema.pre('save', function(next) {\nvar user = this;\nbcrypt.hash(user.password, 10, function(err, hash) {\nif (err) {\nreturn next(err);\n}\nuser.password = hash;\nnext();\n})\n});`}</p>\n    <p>{`/////////////////////////////////////////////////////////`}</p>\n    <p>{`PART 3: Sessions and Cookies`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n9. User Login \n`}</code></pre>{`   Functionalities`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Sessions & Cookies`}</li>\n        </ul></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <ul>\n      <li parentName=\"ul\">{`http stateless protocol for cookies and sessions`}</li>\n    </ul>\n    <p>{`Http is a stateless protocol itself`}</p>\n    <ul>\n      <li parentName=\"ul\">{`server doesn't keep track of when a user changes pages`}</li>\n      <li parentName=\"ul\">{`need to create a session id - usually set time too`}</li>\n      <li parentName=\"ul\">{`need session ID and user ID`}</li>\n      <li parentName=\"ul\">{`cookies is a key/value pair that a server wants to create`}</li>\n      <li parentName=\"ul\">{`we will create a cookie with a session ID`}</li>\n    </ul>\n    <p>{`npm install express-session --save`}</p>\n    <p>{`// in app.js`}</p>\n    <p>{`var session = require('express-session');`}</p>\n    <p>{`// use sessions for tracking logins - check more in the readme\napp.use(session({\nsecret: 'treehouse loves you',\nresave: true,\nsaveUninitialized: false\n}));`}</p>\n    <ul>\n      <li parentName=\"ul\">{`not useful when in production. check `}<a parentName=\"li\" {...{\n          \"href\": \"https://github.com/expressjs/session#compatible-session-stores\"\n        }}>{`https://github.com/expressjs/session#compatible-session-stores`}</a></li>\n      <li parentName=\"ul\">{`secret is used to sign a cookie, to ensure that only the application created the cookie.`}</li>\n    </ul>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`**`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                  *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 10\n        }}>\n          <li parentName=\"ol\">{`Adding login\nto routes`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                  *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`**`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`// in app.js`}</p>\n    <p>{`router.get('/login', function(req, res, next) {\nreturn res.render('login', { title: 'Log In' });\n});`}</p>\n    <p>{`router.post('/login', function(req, res, next) {\nreturn res.send('Logged in!');\n});`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`**`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                  *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 11\n        }}>\n          <li parentName=\"ol\">{`Pug login form`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                  *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`**`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`// pug login form!`}</p>\n    <p>{`// views/login.pug`}</p>\n    <p>{`extends layout`}</p>\n    <p>{`block content\n.main.container\n.row\n.col-md-6.col-md-offset-3\nh1.display-4.m-b-2 Log In\nform(method='POST' action='/login')\ndiv.form-group\nlabel(for='email') Email\ninput.form-control(type='text' id='email' placeholder='email' name='email')\ndiv.form-group\nlabel(for='password') Password\ninput.form-control(type='password' id='password' placeholder='password' name='password')\nbutton.btn.btn-primary(type='submit') Log in`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`**`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                  *\n`}</code></pre></li>\n    </ul>\n    <ol {...{\n      \"start\": 12\n    }}>\n      <li parentName=\"ol\">{`Auth the Username\nand Password`}</li>\n    </ol>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                  *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`**`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`// Example in app.js for Express`}</p>\n    <p>{`router.post('/login', function(req, res, next) {\nif (req.body.email && req.body.password) {\nUser.authenticate(req.body.email, req.body.password, function (error, user) {\nif (error || !user) {\nvar err = new Error('Wrong email or password.');\nerr.status = 401;\nreturn next(err);\n} else {\nreq.session.userId = user._id;\nreturn res.redirect('/profile');\n}\n});\n} else {\nvar err = new Error('Email and password are required.');\nerr.status = 401;\nreturn next(err);\n}\n});`}</p>\n    <p>{`// in user.js`}</p>\n    <p>{`UserSchema.statics.authenticate = function(email, password, callback) {\nUser.findOne({ email: email })\n.exec(function (error, user) {\nif (error) {\nreturn callback(error);\n} else if (!user) {\nvar err = new Error('User not found.');\nerr.status = 401;\nreturn callback(err);\n}\nbcrypt.compare(password, user.password, function (error, result) {\nif (result === true) {\nreturn callback(null, user);\n} else {\nreturn callback();\n}\n});\n});\n}`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                *\n`}</code></pre></li>\n    </ul>\n    <ol {...{\n      \"start\": 13\n    }}>\n      <li parentName=\"ol\">{`Profile Route\nand Page`}</li>\n    </ol>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`profile.pug`}</p>\n    <p>{`extends layout`}</p>\n    <p>{`block content\n.main.container.clearfix\n.row\n.col-md-8.col-md-offset-2\nh1.display-4\nimg.avatar.img-circle.hidden-xs-down(src='/images/avatar.png', alt='avatar')\n| #{name}\nh2.favorite-book Favorite Book\n| #{favorite}`}</p>\n    <p>{`// GET /profile`}</p>\n    <p>{`router.get('/profile', function(req, res, next) {\nif (! req.session.userId ) {\nvar err = new Error(\"You are not authorized to view this page.\");\nerr.status = 403;\nreturn next(err);\n}\nUser.findById(req.session.userId)\n.exec(function (error, user) {\nif (error) {\nreturn next(error);\n} else {\nreturn res.render('profile', { title: 'Profile', name: user.name, favorite: user.favoriteBook });\n}\n});\n});`}</p>\n    <p>{`/////////////////////////////////////////////////////////`}</p>\n    <p>{`PART 4`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n      14. Using Session\n`}</code></pre>{`Vars to Customize Content`}</li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`To make user id global`}</p>\n    <p>{`// in app.js`}</p>\n    <p>{`// make user id available to templates\napp.use(function (req,res,next) {\nres.locals.currentUser = req.session.userId;\nnext();\n});`}</p>\n    <p>{`For the new logout route`}</p>\n    <p>{`router.get('/logout', function (req, res, next) {\nif (req.session) {\nreq.session.destroy(function(err) {\nif (err) {\nreturn next(err);\n} else {\nreturn res.redirect('/');\n}\n});\n}\n});`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 15\n        }}>\n          <li parentName=\"ol\">{`Understanding\nMiddleware`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <ul>\n      <li parentName=\"ul\">{`between requests and responses `}</li>\n    </ul>\n    <p>{`app.use //middleware`}</p>\n    <p>{`//session middleware\napp.use(session({\nsecret: 'treehouse loves you',\nresave: true,\nsaveUninitialized: false\n}));`}</p>\n    <p>{`Request/Response Cycle`}</p>\n    <p>{`app.use(function (req,res,next) {\n...\nnext(); //custom middleware ALWAYS needs call to next\n});`}</p>\n    <p>{`// CUSTOM MIDDLEWARE`}</p>\n    <p>{`create middleware folder`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\">{`index.js`}</p>\n    </blockquote>\n    <p>{`function loggedOut(req, res, next) {\nif (req.session && req.session.userId) {\nreturn res.redirect('profile');\n}\nreturn next();\n}`}</p>\n    <p>{`module.exports.loggedOut = loggedOut;`}</p>\n    <p>{`var mid = require('../middleware');`}</p>\n    <ul>\n      <li parentName=\"ul\">{`now we can reference the function by mid.loggedOut`}</li>\n    </ul>\n    <p>{`Now, in the routes we want to double check... we can put the func in.`}</p>\n    <p>{`eg.\nrouter.get('/register', mid.loggedOut, function(req, res, next) {\nreturn res.render('register', { title: 'Sign up' });\n});`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\">{`index.js`}</p>\n    </blockquote>\n    <p>{`function requiresLogin(req, res, next) {\nif (req.session && req.session.userId) {\nnext();\n} else {\nvar err = new Error('You do not have permission to see this.');\nerr.status = 401;\nreturn next(err);\n}\n}`}</p>\n    <p>{`module.exports.requiresLogin = requiresLogin;`}</p>\n    <p>{`/`}<strong parentName=\"p\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong></p>\n    <ul>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><ol parentName=\"li\" {...{\n          \"start\": 16\n        }}>\n          <li parentName=\"ol\">{`Using MongoDB\nas a Session Store`}</li>\n        </ol></li>\n      <li parentName=\"ul\"><pre parentName=\"li\"><code parentName=\"pre\" {...{}}>{`                    *\n`}</code></pre><strong parentName=\"li\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\"><strong parentName=\"strong\">{`****`}</strong></strong></strong></strong></strong></strong>{`/`}</li>\n    </ul>\n    <p>{`connect-mongo is a middleware already written for us!`}</p>\n    <p>{`npm install connect-mongo --save`}</p>\n    <p>{`require MongoStore = require('connect-mongo')(session);`}</p>\n    <p>{`// in app.js`}</p>\n    <p>{`app.use(session({\nsecret: 'treehouse loves you',\nresave: true,\nsaveUninitialized: false\nstore: new MongoStore({\nmongooseConnection: db\n})\n}));`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}