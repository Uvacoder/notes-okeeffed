{"expireTime":9007200848610875000,"key":"gatsby-plugin-mdx-entire-payload-780ba0fe40b907ec5330a6491849de64-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":133,"offset":134},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":136},"end":{"line":5,"column":29,"offset":164},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Resources","position":{"start":{"line":8,"column":4,"offset":170},"end":{"line":8,"column":13,"offset":179},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":167},"end":{"line":8,"column":13,"offset":179},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://nextjs.org/docs/getting-started","children":[{"type":"text","value":"Next.js - Getting Started","position":{"start":{"line":10,"column":5,"offset":185},"end":{"line":10,"column":30,"offset":210},"indent":[]}}],"position":{"start":{"line":10,"column":4,"offset":184},"end":{"line":10,"column":72,"offset":252},"indent":[]}}],"position":{"start":{"line":10,"column":4,"offset":184},"end":{"line":10,"column":72,"offset":252},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":181},"end":{"line":10,"column":72,"offset":252},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://next-auth.js.org/providers/credentials","children":[{"type":"text","value":"Next Auth","position":{"start":{"line":11,"column":5,"offset":257},"end":{"line":11,"column":14,"offset":266},"indent":[]}}],"position":{"start":{"line":11,"column":4,"offset":256},"end":{"line":11,"column":63,"offset":315},"indent":[]}}],"position":{"start":{"line":11,"column":4,"offset":256},"end":{"line":11,"column":63,"offset":315},"indent":[]}}],"position":{"start":{"line":11,"column":1,"offset":253},"end":{"line":11,"column":63,"offset":315},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/","children":[{"type":"text","value":"Set up a GitHub OAuth Application","position":{"start":{"line":12,"column":5,"offset":320},"end":{"line":12,"column":38,"offset":353},"indent":[]}}],"position":{"start":{"line":12,"column":4,"offset":319},"end":{"line":12,"column":118,"offset":433},"indent":[]}}],"position":{"start":{"line":12,"column":4,"offset":319},"end":{"line":12,"column":118,"offset":433},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":316},"end":{"line":12,"column":118,"offset":433},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://pagekite.net/","children":[{"type":"text","value":"Ngrok alternative - PageKite","position":{"start":{"line":13,"column":5,"offset":438},"end":{"line":13,"column":33,"offset":466},"indent":[]}}],"position":{"start":{"line":13,"column":4,"offset":437},"end":{"line":13,"column":57,"offset":490},"indent":[]}}],"position":{"start":{"line":13,"column":4,"offset":437},"end":{"line":13,"column":57,"offset":490},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":434},"end":{"line":13,"column":57,"offset":490},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://hub.docker.com/r/mysql/mysql-server/","children":[{"type":"text","value":"Docker - mysql/mysql-server","position":{"start":{"line":14,"column":5,"offset":495},"end":{"line":14,"column":32,"offset":522},"indent":[]}}],"position":{"start":{"line":14,"column":4,"offset":494},"end":{"line":14,"column":79,"offset":569},"indent":[]}}],"position":{"start":{"line":14,"column":4,"offset":494},"end":{"line":14,"column":79,"offset":569},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":491},"end":{"line":14,"column":79,"offset":569},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":181},"end":{"line":14,"column":79,"offset":569},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Setting up MySQL with Docker","position":{"start":{"line":16,"column":4,"offset":574},"end":{"line":16,"column":32,"offset":602},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":571},"end":{"line":16,"column":32,"offset":602},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This example demonstrates a setup and expects you to understand some basics behind Docker containers.","position":{"start":{"line":18,"column":1,"offset":604},"end":{"line":18,"column":102,"offset":705},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":604},"end":{"line":18,"column":102,"offset":705},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"docker pull mysql/mysql-server\ndocker run --name sql-test -e MYSQL_ROOT_PASSWORD=password -p 6000:3306 -d mysql/mysql-server:latest\n# confirm container running\ndocker ps","position":{"start":{"line":20,"column":1,"offset":707},"end":{"line":25,"column":4,"offset":889},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"You should see something like the following:","position":{"start":{"line":27,"column":1,"offset":891},"end":{"line":27,"column":45,"offset":935},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":891},"end":{"line":27,"column":45,"offset":935},"indent":[]}},{"type":"code","lang":"s","meta":null,"value":"CONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS                            PORTS                               NAMES\n30be83a35610        mysql/mysql-server:latest   \"/entrypoint.sh mysqâ€¦\"   6 seconds ago       Up 2 seconds (health: starting)   33060/tcp, 0.0.0.0:6000->3306/tcp   sql-test","position":{"start":{"line":29,"column":1,"offset":937},"end":{"line":32,"column":4,"offset":1286},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"We have the server port forwarding from 3306 on the container to 6000 for us to access on localhost.","position":{"start":{"line":34,"column":1,"offset":1288},"end":{"line":34,"column":101,"offset":1388},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1288},"end":{"line":34,"column":101,"offset":1388},"indent":[]}},{"type":"code","lang":"s","meta":null,"value":"# where 30be83a35610 is there CONTAINER ID\ndocker exec 30be83a35610 -it /bin/bash","position":{"start":{"line":36,"column":1,"offset":1390},"end":{"line":39,"column":4,"offset":1480},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This will take you into the Docker container shell, where we can login into MySQL.","position":{"start":{"line":41,"column":1,"offset":1482},"end":{"line":41,"column":83,"offset":1564},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":1482},"end":{"line":41,"column":83,"offset":1564},"indent":[]}},{"type":"code","lang":"s","meta":null,"value":"mysql -u root -p\n# enter \"password\" when prompted","position":{"start":{"line":43,"column":1,"offset":1566},"end":{"line":46,"column":4,"offset":1624},"indent":[1,1,1]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"You can go straight into mysql from the docker exec, but I thought going the long way might be more fun for those playing around with containers.","position":{"start":{"line":48,"column":3,"offset":1628},"end":{"line":48,"column":148,"offset":1773},"indent":[]}}],"position":{"start":{"line":48,"column":3,"offset":1628},"end":{"line":48,"column":148,"offset":1773},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1626},"end":{"line":48,"column":148,"offset":1773},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Now we can create a database to use for this example.","position":{"start":{"line":50,"column":1,"offset":1775},"end":{"line":50,"column":54,"offset":1828},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":1775},"end":{"line":50,"column":54,"offset":1828},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"create database next_auth;\nshow databases;\n-- you should now be able to see \"next_auth\"","position":{"start":{"line":52,"column":1,"offset":1830},"end":{"line":56,"column":4,"offset":1928},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In order to get things going, you may need to make some changes. I had to do the following.","position":{"start":{"line":58,"column":1,"offset":1930},"end":{"line":58,"column":92,"offset":2021},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":1930},"end":{"line":58,"column":92,"offset":2021},"indent":[]}},{"type":"code","lang":"sql","meta":null,"value":"UPDATE mysql.user SET Host='%' WHERE Host='localhost' AND User='root';\nALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'password';\nFLUSH PRIVILEGES;","position":{"start":{"line":60,"column":1,"offset":2023},"end":{"line":64,"column":4,"offset":2197},"indent":[1,1,1,1]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"Note: Using the root isn't a great idea, but this is simply for demonstration purposes and to get things up and running.","position":{"start":{"line":66,"column":3,"offset":2201},"end":{"line":66,"column":123,"offset":2321},"indent":[]}}],"position":{"start":{"line":66,"column":3,"offset":2201},"end":{"line":66,"column":123,"offset":2321},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":2199},"end":{"line":66,"column":123,"offset":2321},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For here, you can ","position":{"start":{"line":68,"column":1,"offset":2323},"end":{"line":68,"column":19,"offset":2341},"indent":[]}},{"type":"inlineCode","value":"exit","position":{"start":{"line":68,"column":19,"offset":2341},"end":{"line":68,"column":25,"offset":2347},"indent":[]}},{"type":"text","value":" the MySQL shell and run ","position":{"start":{"line":68,"column":25,"offset":2347},"end":{"line":68,"column":50,"offset":2372},"indent":[]}},{"type":"inlineCode","value":"exit","position":{"start":{"line":68,"column":50,"offset":2372},"end":{"line":68,"column":56,"offset":2378},"indent":[]}},{"type":"text","value":" it again to leave the Docker container.","position":{"start":{"line":68,"column":56,"offset":2378},"end":{"line":68,"column":96,"offset":2418},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":2323},"end":{"line":68,"column":96,"offset":2418},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Setting up Next.js","position":{"start":{"line":70,"column":5,"offset":2424},"end":{"line":70,"column":23,"offset":2442},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":2420},"end":{"line":70,"column":23,"offset":2442},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"npx create-next-app","position":{"start":{"line":72,"column":1,"offset":2444},"end":{"line":74,"column":4,"offset":2476},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Fill out the defaults for it and get it loading.","position":{"start":{"line":76,"column":1,"offset":2478},"end":{"line":76,"column":49,"offset":2526},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":2478},"end":{"line":76,"column":49,"offset":2526},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"yarn add next-auth mysql dotenv","position":{"start":{"line":78,"column":1,"offset":2528},"end":{"line":80,"column":4,"offset":2572},"indent":[1,1]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"We are using \"dotenv\" for loading a local ","position":{"start":{"line":82,"column":3,"offset":2576},"end":{"line":82,"column":45,"offset":2618},"indent":[]}},{"type":"inlineCode","value":".env","position":{"start":{"line":82,"column":45,"offset":2618},"end":{"line":82,"column":51,"offset":2624},"indent":[]}},{"type":"text","value":" file for local development.","position":{"start":{"line":82,"column":51,"offset":2624},"end":{"line":82,"column":79,"offset":2652},"indent":[]}}],"position":{"start":{"line":82,"column":3,"offset":2576},"end":{"line":82,"column":79,"offset":2652},"indent":[]}}],"position":{"start":{"line":82,"column":1,"offset":2574},"end":{"line":82,"column":79,"offset":2652},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Here, we are just going to use ","position":{"start":{"line":84,"column":1,"offset":2654},"end":{"line":84,"column":32,"offset":2685},"indent":[]}},{"type":"link","title":null,"url":"https://next-auth.js.org/providers/github","children":[{"type":"text","value":"GitHub OAuth","position":{"start":{"line":84,"column":33,"offset":2686},"end":{"line":84,"column":45,"offset":2698},"indent":[]}}],"position":{"start":{"line":84,"column":32,"offset":2685},"end":{"line":84,"column":89,"offset":2742},"indent":[]}},{"type":"text","value":" for logging in.","position":{"start":{"line":84,"column":89,"offset":2742},"end":{"line":84,"column":105,"offset":2758},"indent":[]}}],"position":{"start":{"line":84,"column":1,"offset":2654},"end":{"line":84,"column":105,"offset":2758},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Setting up Next Auth in the application","position":{"start":{"line":86,"column":4,"offset":2763},"end":{"line":86,"column":43,"offset":2802},"indent":[]}}],"position":{"start":{"line":86,"column":1,"offset":2760},"end":{"line":86,"column":43,"offset":2802},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Create a file ","position":{"start":{"line":88,"column":1,"offset":2804},"end":{"line":88,"column":15,"offset":2818},"indent":[]}},{"type":"inlineCode","value":"pages/api/auth/[...nextauth].js","position":{"start":{"line":88,"column":15,"offset":2818},"end":{"line":88,"column":48,"offset":2851},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":88,"column":48,"offset":2851},"end":{"line":88,"column":49,"offset":2852},"indent":[]}}],"position":{"start":{"line":88,"column":1,"offset":2804},"end":{"line":88,"column":49,"offset":2852},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Add the following:","position":{"start":{"line":90,"column":1,"offset":2854},"end":{"line":90,"column":19,"offset":2872},"indent":[]}}],"position":{"start":{"line":90,"column":1,"offset":2854},"end":{"line":90,"column":19,"offset":2872},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"import NextAuth from 'next-auth';\nimport Providers from 'next-auth/providers';\n\nrequire('dotenv').config();\n\nconst options = {\n  site: process.env.SITE || 'http://localhost:3000',\n\n  // Configure one or more authentication providers\n  providers: [\n    Providers.GitHub({\n      clientId: process.env.GITHUB_ID,\n      clientSecret: process.env.GITHUB_SECRET,\n    }),\n  ],\n\n  // A database is optional, but required to persist accounts in a database\n  database: process.env.DATABASE_URL,\n};\n\nexport default (req, res) => NextAuth(req, res, options);","position":{"start":{"line":92,"column":1,"offset":2874},"end":{"line":114,"column":4,"offset":3438},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Create a page ","position":{"start":{"line":116,"column":1,"offset":3440},"end":{"line":116,"column":15,"offset":3454},"indent":[]}},{"type":"inlineCode","value":"pages/index.js","position":{"start":{"line":116,"column":15,"offset":3454},"end":{"line":116,"column":31,"offset":3470},"indent":[]}},{"type":"text","value":":","position":{"start":{"line":116,"column":31,"offset":3470},"end":{"line":116,"column":32,"offset":3471},"indent":[]}}],"position":{"start":{"line":116,"column":1,"offset":3440},"end":{"line":116,"column":32,"offset":3471},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"import React from 'react';\nimport { useSession } from 'next-auth/client';\n\nexport default () => {\n  const [session, loading] = useSession();\n\n  return (\n    <p>\n      {!session && (\n        <>\n          Not signed in <br />\n          <a href=\"/api/auth/signin\">Sign in</a>\n        </>\n      )}\n      {session && (\n        <>\n          Signed in as {session.user.email} <br />\n          <a href=\"/api/auth/signout\">Sign out</a>\n        </>\n      )}\n    </p>\n  );\n};","position":{"start":{"line":118,"column":1,"offset":3473},"end":{"line":142,"column":4,"offset":3955},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"That is all we need to do for the application! We won't start running anything just yet","position":{"start":{"line":144,"column":1,"offset":3957},"end":{"line":144,"column":88,"offset":4044},"indent":[]}}],"position":{"start":{"line":144,"column":1,"offset":3957},"end":{"line":144,"column":88,"offset":4044},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Setting up ngrok","position":{"start":{"line":146,"column":4,"offset":4049},"end":{"line":146,"column":20,"offset":4065},"indent":[]}}],"position":{"start":{"line":146,"column":1,"offset":4046},"end":{"line":146,"column":20,"offset":4065},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"We are using tunneling to forward our localhost address out to the big, bad world.","position":{"start":{"line":148,"column":1,"offset":4067},"end":{"line":148,"column":83,"offset":4149},"indent":[]}}],"position":{"start":{"line":148,"column":1,"offset":4067},"end":{"line":148,"column":83,"offset":4149},"indent":[]}},{"type":"code","lang":"s","meta":null,"value":"ngrok http 3000 # will forward 3000 out","position":{"start":{"line":150,"column":1,"offset":4151},"end":{"line":152,"column":4,"offset":4199},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Once you run that, you will get an address to use.","position":{"start":{"line":154,"column":1,"offset":4201},"end":{"line":154,"column":51,"offset":4251},"indent":[]}}],"position":{"start":{"line":154,"column":1,"offset":4201},"end":{"line":154,"column":51,"offset":4251},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Setting up GitHub OAuth","position":{"start":{"line":156,"column":4,"offset":4256},"end":{"line":156,"column":27,"offset":4279},"indent":[]}}],"position":{"start":{"line":156,"column":1,"offset":4253},"end":{"line":156,"column":27,"offset":4279},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Follow the guide on how to set up a ","position":{"start":{"line":158,"column":1,"offset":4281},"end":{"line":158,"column":37,"offset":4317},"indent":[]}},{"type":"link","title":null,"url":"https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/","children":[{"type":"text","value":"GitHub OAuth Application","position":{"start":{"line":158,"column":38,"offset":4318},"end":{"line":158,"column":62,"offset":4342},"indent":[]}}],"position":{"start":{"line":158,"column":37,"offset":4317},"end":{"line":158,"column":142,"offset":4422},"indent":[]}}],"position":{"start":{"line":158,"column":1,"offset":4281},"end":{"line":158,"column":142,"offset":4422},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"We will need to grab both the ID and the token given back.","position":{"start":{"line":160,"column":1,"offset":4424},"end":{"line":160,"column":59,"offset":4482},"indent":[]}}],"position":{"start":{"line":160,"column":1,"offset":4424},"end":{"line":160,"column":59,"offset":4482},"indent":[]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"Note: For the authentication callback, you will need to keep the format ","position":{"start":{"line":162,"column":3,"offset":4486},"end":{"line":162,"column":75,"offset":4558},"indent":[]}},{"type":"inlineCode","value":"{server}/api/auth/callback/{provider}","position":{"start":{"line":162,"column":75,"offset":4558},"end":{"line":162,"column":114,"offset":4597},"indent":[]}},{"type":"text","value":". This will be the ngrok server address.","position":{"start":{"line":162,"column":114,"offset":4597},"end":{"line":162,"column":154,"offset":4637},"indent":[]}}],"position":{"start":{"line":162,"column":3,"offset":4486},"end":{"line":162,"column":154,"offset":4637},"indent":[]}}],"position":{"start":{"line":162,"column":1,"offset":4484},"end":{"line":162,"column":154,"offset":4637},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Env Variables","position":{"start":{"line":164,"column":4,"offset":4642},"end":{"line":164,"column":17,"offset":4655},"indent":[]}}],"position":{"start":{"line":164,"column":1,"offset":4639},"end":{"line":164,"column":17,"offset":4655},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"GITHUB_ID=<from-github>\nGITHUB_SECRET=<from-github>\n# The MySQL database being forwarded from Docker,\n# where 'next_auth' is the database we created\nDATABASE_URL=\"mysql://root:password@127.0.0.1:6000/next_auth?synchronize=true\"\nSITE=<ngrok-server>","position":{"start":{"line":166,"column":1,"offset":4657},"end":{"line":173,"column":4,"offset":4917},"indent":[1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Running Dev","position":{"start":{"line":175,"column":4,"offset":4922},"end":{"line":175,"column":15,"offset":4933},"indent":[]}}],"position":{"start":{"line":175,"column":1,"offset":4919},"end":{"line":175,"column":15,"offset":4933},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Now is the fun part.","position":{"start":{"line":177,"column":1,"offset":4935},"end":{"line":177,"column":21,"offset":4955},"indent":[]}}],"position":{"start":{"line":177,"column":1,"offset":4935},"end":{"line":177,"column":21,"offset":4955},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"yarn dev","position":{"start":{"line":179,"column":1,"offset":4957},"end":{"line":181,"column":4,"offset":4978},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"If we head to ","position":{"start":{"line":183,"column":1,"offset":4980},"end":{"line":183,"column":15,"offset":4994},"indent":[]}},{"type":"inlineCode","value":"http://localhost:3000","position":{"start":{"line":183,"column":15,"offset":4994},"end":{"line":183,"column":38,"offset":5017},"indent":[]}},{"type":"text","value":", we will see the application, however we want to head to the ngrok address instead in our case.","position":{"start":{"line":183,"column":38,"offset":5017},"end":{"line":183,"column":134,"offset":5113},"indent":[]}}],"position":{"start":{"line":183,"column":1,"offset":4980},"end":{"line":183,"column":134,"offset":5113},"indent":[]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":186,"column":1,"offset":5116},"end":{"line":186,"column":31,"offset":5146},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":186,"column":31,"offset":5146}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h2 {...{\n      \"id\": \"resources\"\n    }}>{`Resources`}</h2>\n    <ol>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://nextjs.org/docs/getting-started\"\n        }}>{`Next.js - Getting Started`}</a></li>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://next-auth.js.org/providers/credentials\"\n        }}>{`Next Auth`}</a></li>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/\"\n        }}>{`Set up a GitHub OAuth Application`}</a></li>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://pagekite.net/\"\n        }}>{`Ngrok alternative - PageKite`}</a></li>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://hub.docker.com/r/mysql/mysql-server/\"\n        }}>{`Docker - mysql/mysql-server`}</a></li>\n    </ol>\n    <h2 {...{\n      \"id\": \"setting-up-mysql-with-docker\"\n    }}>{`Setting up MySQL with Docker`}</h2>\n    <p>{`This example demonstrates a setup and expects you to understand some basics behind Docker containers.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`docker pull mysql/mysql-server\ndocker run --name sql-test -e MYSQL_ROOT_PASSWORD=password -p 6000:3306 -d mysql/mysql-server:latest\n# confirm container running\ndocker ps\n`}</code></pre>\n    <p>{`You should see something like the following:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`CONTAINER ID        IMAGE                       COMMAND                  CREATED             STATUS                            PORTS                               NAMES\n30be83a35610        mysql/mysql-server:latest   \"/entrypoint.sh mysqâ€¦\"   6 seconds ago       Up 2 seconds (health: starting)   33060/tcp, 0.0.0.0:6000->3306/tcp   sql-test\n`}</code></pre>\n    <p>{`We have the server port forwarding from 3306 on the container to 6000 for us to access on localhost.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`# where 30be83a35610 is there CONTAINER ID\ndocker exec 30be83a35610 -it /bin/bash\n`}</code></pre>\n    <p>{`This will take you into the Docker container shell, where we can login into MySQL.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`mysql -u root -p\n# enter \"password\" when prompted\n`}</code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\">{`You can go straight into mysql from the docker exec, but I thought going the long way might be more fun for those playing around with containers.`}</p>\n    </blockquote>\n    <p>{`Now we can create a database to use for this example.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`create database next_auth;\nshow databases;\n-- you should now be able to see \"next_auth\"\n`}</code></pre>\n    <p>{`In order to get things going, you may need to make some changes. I had to do the following.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-sql\"\n      }}>{`UPDATE mysql.user SET Host='%' WHERE Host='localhost' AND User='root';\nALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'password';\nFLUSH PRIVILEGES;\n`}</code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\">{`Note: Using the root isn't a great idea, but this is simply for demonstration purposes and to get things up and running.`}</p>\n    </blockquote>\n    <p>{`For here, you can `}<inlineCode parentName=\"p\">{`exit`}</inlineCode>{` the MySQL shell and run `}<inlineCode parentName=\"p\">{`exit`}</inlineCode>{` it again to leave the Docker container.`}</p>\n    <h3 {...{\n      \"id\": \"setting-up-nextjs\"\n    }}>{`Setting up Next.js`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`npx create-next-app\n`}</code></pre>\n    <p>{`Fill out the defaults for it and get it loading.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`yarn add next-auth mysql dotenv\n`}</code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\">{`We are using \"dotenv\" for loading a local `}<inlineCode parentName=\"p\">{`.env`}</inlineCode>{` file for local development.`}</p>\n    </blockquote>\n    <p>{`Here, we are just going to use `}<a parentName=\"p\" {...{\n        \"href\": \"https://next-auth.js.org/providers/github\"\n      }}>{`GitHub OAuth`}</a>{` for logging in.`}</p>\n    <h2 {...{\n      \"id\": \"setting-up-next-auth-in-the-application\"\n    }}>{`Setting up Next Auth in the application`}</h2>\n    <p>{`Create a file `}<inlineCode parentName=\"p\">{`pages/api/auth/[...nextauth].js`}</inlineCode>{`.`}</p>\n    <p>{`Add the following:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`import NextAuth from 'next-auth';\nimport Providers from 'next-auth/providers';\n\nrequire('dotenv').config();\n\nconst options = {\n  site: process.env.SITE || 'http://localhost:3000',\n\n  // Configure one or more authentication providers\n  providers: [\n    Providers.GitHub({\n      clientId: process.env.GITHUB_ID,\n      clientSecret: process.env.GITHUB_SECRET,\n    }),\n  ],\n\n  // A database is optional, but required to persist accounts in a database\n  database: process.env.DATABASE_URL,\n};\n\nexport default (req, res) => NextAuth(req, res, options);\n`}</code></pre>\n    <p>{`Create a page `}<inlineCode parentName=\"p\">{`pages/index.js`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`import React from 'react';\nimport { useSession } from 'next-auth/client';\n\nexport default () => {\n  const [session, loading] = useSession();\n\n  return (\n    <p>\n      {!session && (\n        <>\n          Not signed in <br />\n          <a href=\"/api/auth/signin\">Sign in</a>\n        </>\n      )}\n      {session && (\n        <>\n          Signed in as {session.user.email} <br />\n          <a href=\"/api/auth/signout\">Sign out</a>\n        </>\n      )}\n    </p>\n  );\n};\n`}</code></pre>\n    <p>{`That is all we need to do for the application! We won't start running anything just yet`}</p>\n    <h2 {...{\n      \"id\": \"setting-up-ngrok\"\n    }}>{`Setting up ngrok`}</h2>\n    <p>{`We are using tunneling to forward our localhost address out to the big, bad world.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`ngrok http 3000 # will forward 3000 out\n`}</code></pre>\n    <p>{`Once you run that, you will get an address to use.`}</p>\n    <h2 {...{\n      \"id\": \"setting-up-github-oauth\"\n    }}>{`Setting up GitHub OAuth`}</h2>\n    <p>{`Follow the guide on how to set up a `}<a parentName=\"p\" {...{\n        \"href\": \"https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/\"\n      }}>{`GitHub OAuth Application`}</a></p>\n    <p>{`We will need to grab both the ID and the token given back.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\">{`Note: For the authentication callback, you will need to keep the format `}<inlineCode parentName=\"p\">{`{server}/api/auth/callback/{provider}`}</inlineCode>{`. This will be the ngrok server address.`}</p>\n    </blockquote>\n    <h2 {...{\n      \"id\": \"env-variables\"\n    }}>{`Env Variables`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`GITHUB_ID=<from-github>\nGITHUB_SECRET=<from-github>\n# The MySQL database being forwarded from Docker,\n# where 'next_auth' is the database we created\nDATABASE_URL=\"mysql://root:password@127.0.0.1:6000/next_auth?synchronize=true\"\nSITE=<ngrok-server>\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"running-dev\"\n    }}>{`Running Dev`}</h2>\n    <p>{`Now is the fun part.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`yarn dev\n`}</code></pre>\n    <p>{`If we head to `}<inlineCode parentName=\"p\">{`http://localhost:3000`}</inlineCode>{`, we will see the application, however we want to head to the ngrok address instead in our case.`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}