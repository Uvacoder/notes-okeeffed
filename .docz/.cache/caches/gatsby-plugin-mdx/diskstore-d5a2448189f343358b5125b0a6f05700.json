{"expireTime":9007200849425545000,"key":"gatsby-plugin-mdx-entire-payload-9ee7fb3419d8f804610ba5ab83763edc-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":133,"offset":134},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":136},"end":{"line":5,"column":29,"offset":164},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Kafka Advanced Config","position":{"start":{"line":8,"column":3,"offset":169},"end":{"line":8,"column":24,"offset":190},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":167},"end":{"line":8,"column":24,"offset":190},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Advanced Producers","position":{"start":{"line":10,"column":4,"offset":195},"end":{"line":10,"column":22,"offset":213},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":192},"end":{"line":10,"column":22,"offset":213},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Topics on advanced use for producers.","position":{"start":{"line":12,"column":1,"offset":215},"end":{"line":12,"column":38,"offset":252},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":215},"end":{"line":12,"column":38,"offset":252},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Idempotent Producers","position":{"start":{"line":14,"column":4,"offset":257},"end":{"line":14,"column":24,"offset":277},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":254},"end":{"line":14,"column":24,"offset":277},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To eliminate the possibility of duplicate messages, you cam set ","position":{"start":{"line":16,"column":1,"offset":279},"end":{"line":16,"column":65,"offset":343},"indent":[]}},{"type":"inlineCode","value":"enable.idempotence","position":{"start":{"line":16,"column":65,"offset":343},"end":{"line":16,"column":85,"offset":363},"indent":[]}},{"type":"text","value":" to ","position":{"start":{"line":16,"column":85,"offset":363},"end":{"line":16,"column":89,"offset":367},"indent":[]}},{"type":"inlineCode","value":"true","position":{"start":{"line":16,"column":89,"offset":367},"end":{"line":16,"column":95,"offset":373},"indent":[]}},{"type":"text","value":" and the consumer will delete duplicate messages.","position":{"start":{"line":16,"column":95,"offset":373},"end":{"line":16,"column":144,"offset":422},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":279},"end":{"line":16,"column":144,"offset":422},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Impotent Producer Config","position":{"start":{"line":18,"column":5,"offset":428},"end":{"line":18,"column":29,"offset":452},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":424},"end":{"line":18,"column":29,"offset":452},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"ENABLE_IDEMPOTENCE=TRUE","position":{"start":{"line":20,"column":3,"offset":456},"end":{"line":20,"column":26,"offset":479},"indent":[]}}],"position":{"start":{"line":20,"column":3,"offset":456},"end":{"line":20,"column":26,"offset":479},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":454},"end":{"line":20,"column":26,"offset":479},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"ACKS=ALL","position":{"start":{"line":21,"column":3,"offset":482},"end":{"line":21,"column":11,"offset":490},"indent":[]}}],"position":{"start":{"line":21,"column":3,"offset":482},"end":{"line":21,"column":11,"offset":490},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":480},"end":{"line":21,"column":11,"offset":490},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"RETRIES=MAX_VALUE","position":{"start":{"line":22,"column":3,"offset":493},"end":{"line":22,"column":20,"offset":510},"indent":[]}}],"position":{"start":{"line":22,"column":3,"offset":493},"end":{"line":22,"column":20,"offset":510},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":491},"end":{"line":22,"column":20,"offset":510},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"MAX_IN_FLIGHT_REQUESTS=5","position":{"start":{"line":23,"column":3,"offset":513},"end":{"line":23,"column":27,"offset":537},"indent":[]}}],"position":{"start":{"line":23,"column":3,"offset":513},"end":{"line":23,"column":27,"offset":537},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":511},"end":{"line":23,"column":27,"offset":537},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":454},"end":{"line":23,"column":27,"offset":537},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"There are over 50 producer configs. Kafka docs indicates whether certain configurations are high importance or low.","position":{"start":{"line":25,"column":1,"offset":539},"end":{"line":25,"column":116,"offset":654},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":539},"end":{"line":25,"column":116,"offset":654},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Idempotence is listed as low importance due to its effect on efficiency. However, you can use this to ensure your messages arrive in their entirety if safety is a concern.","position":{"start":{"line":27,"column":1,"offset":656},"end":{"line":27,"column":172,"offset":827},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":656},"end":{"line":27,"column":172,"offset":827},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Batch Compression","position":{"start":{"line":29,"column":4,"offset":832},"end":{"line":29,"column":21,"offset":849},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":829},"end":{"line":29,"column":21,"offset":849},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Sending a batch as opposed to individual messages is very important in Kafka. Sending larger batches with compression will significantly improve throughput.","position":{"start":{"line":31,"column":1,"offset":851},"end":{"line":31,"column":157,"offset":1007},"indent":[]}}],"position":{"start":{"line":31,"column":1,"offset":851},"end":{"line":31,"column":157,"offset":1007},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Batch Size and Timing","position":{"start":{"line":33,"column":5,"offset":1013},"end":{"line":33,"column":26,"offset":1034},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":1009},"end":{"line":33,"column":26,"offset":1034},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When multiple records are sent to the same partition, the producer can batch them together. The ","position":{"start":{"line":35,"column":1,"offset":1036},"end":{"line":35,"column":97,"offset":1132},"indent":[]}},{"type":"inlineCode","value":"batch.size","position":{"start":{"line":35,"column":97,"offset":1132},"end":{"line":35,"column":109,"offset":1144},"indent":[]}},{"type":"text","value":" config controls the amount of memory used for each batch. The ","position":{"start":{"line":35,"column":109,"offset":1144},"end":{"line":35,"column":172,"offset":1207},"indent":[]}},{"type":"inlineCode","value":"linger.ms","position":{"start":{"line":35,"column":172,"offset":1207},"end":{"line":35,"column":183,"offset":1218},"indent":[]}},{"type":"text","value":" config will help increase the batch size to get the best compression and throughput.","position":{"start":{"line":35,"column":183,"offset":1218},"end":{"line":35,"column":268,"offset":1303},"indent":[]}}],"position":{"start":{"line":35,"column":1,"offset":1036},"end":{"line":35,"column":268,"offset":1303},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Serializer","position":{"start":{"line":37,"column":4,"offset":1308},"end":{"line":37,"column":14,"offset":1318},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1305},"end":{"line":37,"column":14,"offset":1318},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Custom serialization can be used to translate your data in a format that can be stored, transmitted and retrieved.","position":{"start":{"line":39,"column":1,"offset":1320},"end":{"line":39,"column":115,"offset":1434},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":1320},"end":{"line":39,"column":115,"offset":1434},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Avro serializer: io.confluent.kafka.serializers.KafkaAvroSerializer","position":{"start":{"line":41,"column":3,"offset":1438},"end":{"line":41,"column":70,"offset":1505},"indent":[]}}],"position":{"start":{"line":41,"column":3,"offset":1438},"end":{"line":41,"column":70,"offset":1505},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":1436},"end":{"line":41,"column":70,"offset":1505},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"org.apachage.kafka.common.serialization.StringSerializer","position":{"start":{"line":42,"column":3,"offset":1508},"end":{"line":42,"column":59,"offset":1564},"indent":[]}}],"position":{"start":{"line":42,"column":3,"offset":1508},"end":{"line":42,"column":59,"offset":1564},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":1506},"end":{"line":42,"column":59,"offset":1564},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":1436},"end":{"line":42,"column":59,"offset":1564},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"The producer serializers, while the consumer deserializers.","position":{"start":{"line":44,"column":1,"offset":1566},"end":{"line":44,"column":60,"offset":1625},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":1566},"end":{"line":44,"column":60,"offset":1625},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Producer Buffer Memory","position":{"start":{"line":46,"column":4,"offset":1630},"end":{"line":46,"column":26,"offset":1652},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":1627},"end":{"line":46,"column":26,"offset":1652},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If producer is producing messages faster than the broker can receive those messages, the messages will be sent to a bugger memory on the producer.","position":{"start":{"line":48,"column":1,"offset":1654},"end":{"line":48,"column":147,"offset":1800},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1654},"end":{"line":48,"column":147,"offset":1800},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"max.block.ms: IF producer is sending messages to the broke and the broker is not responding for 60 seconds, you will receive an exception error. This can occur if the broker's buffer is filled or the broker is down.","position":{"start":{"line":50,"column":3,"offset":1804},"end":{"line":50,"column":218,"offset":2019},"indent":[]}}],"position":{"start":{"line":50,"column":3,"offset":1804},"end":{"line":50,"column":218,"offset":2019},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":1802},"end":{"line":50,"column":218,"offset":2019},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":1802},"end":{"line":50,"column":218,"offset":2019},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Advanced Consumers","position":{"start":{"line":52,"column":4,"offset":2024},"end":{"line":52,"column":22,"offset":2042},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2021},"end":{"line":52,"column":22,"offset":2042},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Topics on advanced use for consumers.","position":{"start":{"line":54,"column":1,"offset":2044},"end":{"line":54,"column":38,"offset":2081},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":2044},"end":{"line":54,"column":38,"offset":2081},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Reading Duplicate Messages","position":{"start":{"line":56,"column":4,"offset":2086},"end":{"line":56,"column":30,"offset":2112},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":2083},"end":{"line":56,"column":30,"offset":2112},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"fetch.min.bytes/fetch.max.bytes: Min and max batch size of the request from the consumer. The default are 1 byte and 50 MB.","position":{"start":{"line":58,"column":3,"offset":2116},"end":{"line":58,"column":126,"offset":2239},"indent":[]}}],"position":{"start":{"line":58,"column":3,"offset":2116},"end":{"line":58,"column":126,"offset":2239},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":2114},"end":{"line":58,"column":126,"offset":2239},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"max.poll.records: The maximum number of messages the consumer receives when polling. The default is 500.","position":{"start":{"line":59,"column":3,"offset":2242},"end":{"line":59,"column":107,"offset":2346},"indent":[]}}],"position":{"start":{"line":59,"column":3,"offset":2242},"end":{"line":59,"column":107,"offset":2346},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":2240},"end":{"line":59,"column":107,"offset":2346},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"max.partition.fetch.bytes: The max amount of data the broker returns to the consumer. The default is 1MB.","position":{"start":{"line":60,"column":3,"offset":2349},"end":{"line":60,"column":108,"offset":2454},"indent":[]}}],"position":{"start":{"line":60,"column":3,"offset":2349},"end":{"line":60,"column":108,"offset":2454},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":2347},"end":{"line":60,"column":108,"offset":2454},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":2114},"end":{"line":60,"column":108,"offset":2454},"indent":[1,1]}},{"type":"code","lang":"java","meta":null,"value":"// enable.auto.commit=true\nwhile (true) {\n  List<Records> batch = consumer.poll(Duration.ofMillis(100));\n  doSomethingSynchronous(batch);\n}\n\n// enable.auto.commit=false\nwhile (true) {\n  batch += consumer.poll(Duration.ofMillis(100));\n  if (isReady(batch)) {\n    doSomethingSynchronous(batch);\n    consumer.commitSync();\n  }\n}","position":{"start":{"line":62,"column":1,"offset":2456},"end":{"line":77,"column":4,"offset":2793},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Tracking Offsets","position":{"start":{"line":79,"column":4,"offset":2798},"end":{"line":79,"column":20,"offset":2814},"indent":[]}}],"position":{"start":{"line":79,"column":1,"offset":2795},"end":{"line":79,"column":20,"offset":2814},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When a consumer updates its current position in the partition, it's called a ","position":{"start":{"line":81,"column":1,"offset":2816},"end":{"line":81,"column":78,"offset":2893},"indent":[]}},{"type":"inlineCode","value":"commit","position":{"start":{"line":81,"column":78,"offset":2893},"end":{"line":81,"column":86,"offset":2901},"indent":[]}},{"type":"text","value":". A consumer produces a message to the ","position":{"start":{"line":81,"column":86,"offset":2901},"end":{"line":81,"column":125,"offset":2940},"indent":[]}},{"type":"inlineCode","value":"__consumer_offsets","position":{"start":{"line":81,"column":125,"offset":2940},"end":{"line":81,"column":145,"offset":2960},"indent":[]}},{"type":"text","value":" topic. If the consumer crashes, it triggers a rebalance and the consumer may be assigned a new set of partitions.","position":{"start":{"line":81,"column":145,"offset":2960},"end":{"line":81,"column":259,"offset":3074},"indent":[]}}],"position":{"start":{"line":81,"column":1,"offset":2816},"end":{"line":81,"column":259,"offset":3074},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Partition Rebalancing","position":{"start":{"line":83,"column":4,"offset":3079},"end":{"line":83,"column":25,"offset":3100},"indent":[]}}],"position":{"start":{"line":83,"column":1,"offset":3076},"end":{"line":83,"column":25,"offset":3100},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Types for a topic with 8 partitions could be ","position":{"start":{"line":85,"column":1,"offset":3102},"end":{"line":85,"column":46,"offset":3147},"indent":[]}},{"type":"inlineCode","value":"Round Robin","position":{"start":{"line":85,"column":46,"offset":3147},"end":{"line":85,"column":59,"offset":3160},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":85,"column":59,"offset":3160},"end":{"line":85,"column":63,"offset":3164},"indent":[]}},{"type":"inlineCode","value":"Range","position":{"start":{"line":85,"column":63,"offset":3164},"end":{"line":85,"column":70,"offset":3171},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":85,"column":70,"offset":3171},"end":{"line":85,"column":71,"offset":3172},"indent":[]}}],"position":{"start":{"line":85,"column":1,"offset":3102},"end":{"line":85,"column":71,"offset":3172},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Moving partition ownership from one consumer to another is called a rebalance. This allows us to easily and safely add and remove consumers. Outside of adding or removing consumers, we don't want to to rebalance.","position":{"start":{"line":87,"column":1,"offset":3174},"end":{"line":87,"column":213,"offset":3386},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":3174},"end":{"line":87,"column":213,"offset":3386},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Consumer Group Coordinator","position":{"start":{"line":89,"column":4,"offset":3391},"end":{"line":89,"column":30,"offset":3417},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":3388},"end":{"line":89,"column":30,"offset":3417},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"One of the brokers in the Kafka cluster is established as a consumer group coordinator. That broker continuously reaches out to all consumers and checks if they have a heartbeat.","position":{"start":{"line":91,"column":1,"offset":3419},"end":{"line":91,"column":179,"offset":3597},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":3419},"end":{"line":91,"column":179,"offset":3597},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This broker is also responsible for making the appropriate adjustments when a consumer fails or a new consumer joins the group.","position":{"start":{"line":93,"column":1,"offset":3599},"end":{"line":93,"column":128,"offset":3726},"indent":[]}}],"position":{"start":{"line":93,"column":1,"offset":3599},"end":{"line":93,"column":128,"offset":3726},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Example could be that the first consumer reads messages on brokers 1 & 3 while another consumer reads from broker 2. Broker 3 coordinates all of this.","position":{"start":{"line":95,"column":1,"offset":3728},"end":{"line":95,"column":151,"offset":3878},"indent":[]}}],"position":{"start":{"line":95,"column":1,"offset":3728},"end":{"line":95,"column":151,"offset":3878},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Advanced Topics","position":{"start":{"line":97,"column":4,"offset":3883},"end":{"line":97,"column":19,"offset":3898},"indent":[]}}],"position":{"start":{"line":97,"column":1,"offset":3880},"end":{"line":97,"column":19,"offset":3898},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Topics for Kakfa Advanced Topics:","position":{"start":{"line":99,"column":1,"offset":3900},"end":{"line":99,"column":34,"offset":3933},"indent":[]}}],"position":{"start":{"line":99,"column":1,"offset":3900},"end":{"line":99,"column":34,"offset":3933},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Topic Design","position":{"start":{"line":101,"column":4,"offset":3938},"end":{"line":101,"column":16,"offset":3950},"indent":[]}}],"position":{"start":{"line":101,"column":1,"offset":3935},"end":{"line":101,"column":16,"offset":3950},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"For an example topic of ","position":{"start":{"line":103,"column":1,"offset":3952},"end":{"line":103,"column":25,"offset":3976},"indent":[]}},{"type":"inlineCode","value":"helloworld","position":{"start":{"line":103,"column":25,"offset":3976},"end":{"line":103,"column":37,"offset":3988},"indent":[]}},{"type":"text","value":" that has 3 partitions and 3 brokers listening to each partition respectively in the Kafka Cluster, there are some design considerations:","position":{"start":{"line":103,"column":37,"offset":3988},"end":{"line":103,"column":174,"offset":4125},"indent":[]}}],"position":{"start":{"line":103,"column":1,"offset":3952},"end":{"line":103,"column":174,"offset":4125},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Data accuracy","position":{"start":{"line":105,"column":4,"offset":4130},"end":{"line":105,"column":17,"offset":4143},"indent":[]}}],"position":{"start":{"line":105,"column":4,"offset":4130},"end":{"line":105,"column":17,"offset":4143},"indent":[]}}],"position":{"start":{"line":105,"column":1,"offset":4127},"end":{"line":105,"column":17,"offset":4143},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Popularity of events","position":{"start":{"line":106,"column":4,"offset":4147},"end":{"line":106,"column":24,"offset":4167},"indent":[]}}],"position":{"start":{"line":106,"column":4,"offset":4147},"end":{"line":106,"column":24,"offset":4167},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":4144},"end":{"line":106,"column":24,"offset":4167},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Amount of data to process","position":{"start":{"line":107,"column":4,"offset":4171},"end":{"line":107,"column":29,"offset":4196},"indent":[]}}],"position":{"start":{"line":107,"column":4,"offset":4171},"end":{"line":107,"column":29,"offset":4196},"indent":[]}}],"position":{"start":{"line":107,"column":1,"offset":4168},"end":{"line":107,"column":29,"offset":4196},"indent":[]}}],"position":{"start":{"line":105,"column":1,"offset":4127},"end":{"line":107,"column":29,"offset":4196},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"There are also topic options that come in the form of command line argument flags.","position":{"start":{"line":109,"column":1,"offset":4198},"end":{"line":109,"column":83,"offset":4280},"indent":[]}}],"position":{"start":{"line":109,"column":1,"offset":4198},"end":{"line":109,"column":83,"offset":4280},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Topic Alterations","position":{"start":{"line":111,"column":4,"offset":4285},"end":{"line":111,"column":21,"offset":4302},"indent":[]}}],"position":{"start":{"line":111,"column":1,"offset":4282},"end":{"line":111,"column":21,"offset":4302},"indent":[]}},{"type":"paragraph","children":[{"type":"inlineCode","value":"Log Segment","position":{"start":{"line":113,"column":1,"offset":4304},"end":{"line":113,"column":14,"offset":4317},"indent":[]}},{"type":"text","value":" vs ","position":{"start":{"line":113,"column":14,"offset":4317},"end":{"line":113,"column":18,"offset":4321},"indent":[]}},{"type":"inlineCode","value":"Compacted Topic","position":{"start":{"line":113,"column":18,"offset":4321},"end":{"line":113,"column":35,"offset":4338},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":113,"column":35,"offset":4338},"end":{"line":113,"column":36,"offset":4339},"indent":[]}}],"position":{"start":{"line":113,"column":1,"offset":4304},"end":{"line":113,"column":36,"offset":4339},"indent":[]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":116,"column":1,"offset":4342},"end":{"line":116,"column":31,"offset":4372},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":116,"column":31,"offset":4372}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"kafka-advanced-config\"\n    }}>{`Kafka Advanced Config`}</h1>\n    <h2 {...{\n      \"id\": \"advanced-producers\"\n    }}>{`Advanced Producers`}</h2>\n    <p>{`Topics on advanced use for producers.`}</p>\n    <h2 {...{\n      \"id\": \"idempotent-producers\"\n    }}>{`Idempotent Producers`}</h2>\n    <p>{`To eliminate the possibility of duplicate messages, you cam set `}<inlineCode parentName=\"p\">{`enable.idempotence`}</inlineCode>{` to `}<inlineCode parentName=\"p\">{`true`}</inlineCode>{` and the consumer will delete duplicate messages.`}</p>\n    <h3 {...{\n      \"id\": \"impotent-producer-config\"\n    }}>{`Impotent Producer Config`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`ENABLE_IDEMPOTENCE=TRUE`}</li>\n      <li parentName=\"ul\">{`ACKS=ALL`}</li>\n      <li parentName=\"ul\">{`RETRIES=MAX_VALUE`}</li>\n      <li parentName=\"ul\">{`MAX_IN_FLIGHT_REQUESTS=5`}</li>\n    </ul>\n    <p>{`There are over 50 producer configs. Kafka docs indicates whether certain configurations are high importance or low.`}</p>\n    <p>{`Idempotence is listed as low importance due to its effect on efficiency. However, you can use this to ensure your messages arrive in their entirety if safety is a concern.`}</p>\n    <h2 {...{\n      \"id\": \"batch-compression\"\n    }}>{`Batch Compression`}</h2>\n    <p>{`Sending a batch as opposed to individual messages is very important in Kafka. Sending larger batches with compression will significantly improve throughput.`}</p>\n    <h3 {...{\n      \"id\": \"batch-size-and-timing\"\n    }}>{`Batch Size and Timing`}</h3>\n    <p>{`When multiple records are sent to the same partition, the producer can batch them together. The `}<inlineCode parentName=\"p\">{`batch.size`}</inlineCode>{` config controls the amount of memory used for each batch. The `}<inlineCode parentName=\"p\">{`linger.ms`}</inlineCode>{` config will help increase the batch size to get the best compression and throughput.`}</p>\n    <h2 {...{\n      \"id\": \"serializer\"\n    }}>{`Serializer`}</h2>\n    <p>{`Custom serialization can be used to translate your data in a format that can be stored, transmitted and retrieved.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Avro serializer: io.confluent.kafka.serializers.KafkaAvroSerializer`}</li>\n      <li parentName=\"ul\">{`org.apachage.kafka.common.serialization.StringSerializer`}</li>\n    </ul>\n    <p>{`The producer serializers, while the consumer deserializers.`}</p>\n    <h2 {...{\n      \"id\": \"producer-buffer-memory\"\n    }}>{`Producer Buffer Memory`}</h2>\n    <p>{`If producer is producing messages faster than the broker can receive those messages, the messages will be sent to a bugger memory on the producer.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`max.block.ms: IF producer is sending messages to the broke and the broker is not responding for 60 seconds, you will receive an exception error. This can occur if the broker's buffer is filled or the broker is down.`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"advanced-consumers\"\n    }}>{`Advanced Consumers`}</h2>\n    <p>{`Topics on advanced use for consumers.`}</p>\n    <h2 {...{\n      \"id\": \"reading-duplicate-messages\"\n    }}>{`Reading Duplicate Messages`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`fetch.min.bytes/fetch.max.bytes: Min and max batch size of the request from the consumer. The default are 1 byte and 50 MB.`}</li>\n      <li parentName=\"ul\">{`max.poll.records: The maximum number of messages the consumer receives when polling. The default is 500.`}</li>\n      <li parentName=\"ul\">{`max.partition.fetch.bytes: The max amount of data the broker returns to the consumer. The default is 1MB.`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`// enable.auto.commit=true\nwhile (true) {\n  List<Records> batch = consumer.poll(Duration.ofMillis(100));\n  doSomethingSynchronous(batch);\n}\n\n// enable.auto.commit=false\nwhile (true) {\n  batch += consumer.poll(Duration.ofMillis(100));\n  if (isReady(batch)) {\n    doSomethingSynchronous(batch);\n    consumer.commitSync();\n  }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"tracking-offsets\"\n    }}>{`Tracking Offsets`}</h2>\n    <p>{`When a consumer updates its current position in the partition, it's called a `}<inlineCode parentName=\"p\">{`commit`}</inlineCode>{`. A consumer produces a message to the `}<inlineCode parentName=\"p\">{`__consumer_offsets`}</inlineCode>{` topic. If the consumer crashes, it triggers a rebalance and the consumer may be assigned a new set of partitions.`}</p>\n    <h2 {...{\n      \"id\": \"partition-rebalancing\"\n    }}>{`Partition Rebalancing`}</h2>\n    <p>{`Types for a topic with 8 partitions could be `}<inlineCode parentName=\"p\">{`Round Robin`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`Range`}</inlineCode>{`.`}</p>\n    <p>{`Moving partition ownership from one consumer to another is called a rebalance. This allows us to easily and safely add and remove consumers. Outside of adding or removing consumers, we don't want to to rebalance.`}</p>\n    <h2 {...{\n      \"id\": \"consumer-group-coordinator\"\n    }}>{`Consumer Group Coordinator`}</h2>\n    <p>{`One of the brokers in the Kafka cluster is established as a consumer group coordinator. That broker continuously reaches out to all consumers and checks if they have a heartbeat.`}</p>\n    <p>{`This broker is also responsible for making the appropriate adjustments when a consumer fails or a new consumer joins the group.`}</p>\n    <p>{`Example could be that the first consumer reads messages on brokers 1 & 3 while another consumer reads from broker 2. Broker 3 coordinates all of this.`}</p>\n    <h2 {...{\n      \"id\": \"advanced-topics\"\n    }}>{`Advanced Topics`}</h2>\n    <p>{`Topics for Kakfa Advanced Topics:`}</p>\n    <h2 {...{\n      \"id\": \"topic-design\"\n    }}>{`Topic Design`}</h2>\n    <p>{`For an example topic of `}<inlineCode parentName=\"p\">{`helloworld`}</inlineCode>{` that has 3 partitions and 3 brokers listening to each partition respectively in the Kafka Cluster, there are some design considerations:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Data accuracy`}</li>\n      <li parentName=\"ol\">{`Popularity of events`}</li>\n      <li parentName=\"ol\">{`Amount of data to process`}</li>\n    </ol>\n    <p>{`There are also topic options that come in the form of command line argument flags.`}</p>\n    <h2 {...{\n      \"id\": \"topic-alterations\"\n    }}>{`Topic Alterations`}</h2>\n    <p><inlineCode parentName=\"p\">{`Log Segment`}</inlineCode>{` vs `}<inlineCode parentName=\"p\">{`Compacted Topic`}</inlineCode>{`.`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}