{"expireTime":9007200867335932000,"key":"gatsby-plugin-mdx-entire-payload-9aefac1750daea1ca9a11690a3e59209-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":133,"offset":134},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":136},"end":{"line":5,"column":29,"offset":164},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Deploy Stateful EFS App with EKS","position":{"start":{"line":8,"column":3,"offset":169},"end":{"line":8,"column":35,"offset":201},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":167},"end":{"line":8,"column":35,"offset":201},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"What is EFS?","position":{"start":{"line":10,"column":4,"offset":206},"end":{"line":10,"column":16,"offset":218},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":203},"end":{"line":10,"column":16,"offset":218},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Managed NFS that can be mounted on many EC2.","position":{"start":{"line":12,"column":3,"offset":222},"end":{"line":12,"column":47,"offset":266},"indent":[]}}],"position":{"start":{"line":12,"column":3,"offset":222},"end":{"line":12,"column":47,"offset":266},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":220},"end":{"line":12,"column":47,"offset":266},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"EFS works with EC2 instances in multi-AZ.","position":{"start":{"line":13,"column":3,"offset":269},"end":{"line":13,"column":44,"offset":310},"indent":[]}}],"position":{"start":{"line":13,"column":3,"offset":269},"end":{"line":13,"column":44,"offset":310},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":267},"end":{"line":13,"column":44,"offset":310},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Highly available, scalable, expensive (3xgp2), pay per use.","position":{"start":{"line":14,"column":3,"offset":313},"end":{"line":14,"column":62,"offset":372},"indent":[]}}],"position":{"start":{"line":14,"column":3,"offset":313},"end":{"line":14,"column":62,"offset":372},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":311},"end":{"line":14,"column":62,"offset":372},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":220},"end":{"line":14,"column":62,"offset":372},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://res.cloudinary.com/gitgoodclub/image/upload/v1548299128/eks-course/Screen_Shot_2019-01-24_at_2.05.15_pm.png","alt":"Under the hood","position":{"start":{"line":16,"column":1,"offset":374},"end":{"line":16,"column":135,"offset":508},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":374},"end":{"line":16,"column":135,"offset":508},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"EFS for Kubernetes","position":{"start":{"line":18,"column":4,"offset":513},"end":{"line":18,"column":22,"offset":531},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":510},"end":{"line":18,"column":22,"offset":531},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Using EFS, our Wordpress Pods can now be launched into any AZ, and therefore on any K8s worker nodes.","position":{"start":{"line":20,"column":1,"offset":533},"end":{"line":20,"column":102,"offset":634},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":533},"end":{"line":20,"column":102,"offset":634},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"They will all access the same underlying HTML folder (therefore sharing state).","position":{"start":{"line":22,"column":1,"offset":636},"end":{"line":22,"column":80,"offset":715},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":636},"end":{"line":22,"column":80,"offset":715},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Enabling EFS","position":{"start":{"line":24,"column":4,"offset":720},"end":{"line":24,"column":16,"offset":732},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":717},"end":{"line":24,"column":16,"offset":732},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Heading to the AWS console. Head to the EFS page and create EFS. By default, it will try attach it to whateever VPC is available.","position":{"start":{"line":26,"column":1,"offset":734},"end":{"line":26,"column":130,"offset":863},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":734},"end":{"line":26,"column":130,"offset":863},"indent":[]}},{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Ensure that you attach the correct node worker security groups that we are using for Kubernetes and not the default.","position":{"start":{"line":28,"column":3,"offset":867},"end":{"line":28,"column":119,"offset":983},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":865},"end":{"line":28,"column":121,"offset":985},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":865},"end":{"line":28,"column":121,"offset":985},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"After adding, feel free to add a name tag but then accept the other defaults.","position":{"start":{"line":30,"column":1,"offset":987},"end":{"line":30,"column":78,"offset":1064},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":987},"end":{"line":30,"column":78,"offset":1064},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Ensure you take note of the ","position":{"start":{"line":32,"column":1,"offset":1066},"end":{"line":32,"column":29,"offset":1094},"indent":[]}},{"type":"inlineCode","value":"DNS name","position":{"start":{"line":32,"column":29,"offset":1094},"end":{"line":32,"column":39,"offset":1104},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":32,"column":39,"offset":1104},"end":{"line":32,"column":44,"offset":1109},"indent":[]}},{"type":"inlineCode","value":"File System ID","position":{"start":{"line":32,"column":44,"offset":1109},"end":{"line":32,"column":60,"offset":1125},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":32,"column":60,"offset":1125},"end":{"line":32,"column":61,"offset":1126},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1066},"end":{"line":32,"column":61,"offset":1126},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To be able to enable the EFS, we need to install ","position":{"start":{"line":34,"column":1,"offset":1128},"end":{"line":34,"column":50,"offset":1177},"indent":[]}},{"type":"inlineCode","value":"amazon-efs-utils","position":{"start":{"line":34,"column":50,"offset":1177},"end":{"line":34,"column":68,"offset":1195},"indent":[]}},{"type":"text","value":" onto each of the worker nodes.","position":{"start":{"line":34,"column":68,"offset":1195},"end":{"line":34,"column":99,"offset":1226},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":1128},"end":{"line":34,"column":99,"offset":1226},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Example being ","position":{"start":{"line":36,"column":1,"offset":1228},"end":{"line":36,"column":15,"offset":1242},"indent":[]}},{"type":"inlineCode","value":"ssh -i .ssh/path/to/key.pem ec2-user@REDACTED \"sudo yum install -y amazon-efs-utils","position":{"start":{"line":36,"column":15,"offset":1242},"end":{"line":36,"column":100,"offset":1327},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":36,"column":100,"offset":1327},"end":{"line":36,"column":101,"offset":1328},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1228},"end":{"line":36,"column":101,"offset":1328},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Creating the namespace and prepping storage","position":{"start":{"line":38,"column":4,"offset":1333},"end":{"line":38,"column":47,"offset":1376},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1330},"end":{"line":38,"column":47,"offset":1376},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://res.cloudinary.com/gitgoodclub/image/upload/v1548300383/eks-course/Screen_Shot_2019-01-24_at_2.26.08_pm.png","alt":"Layout","position":{"start":{"line":40,"column":1,"offset":1378},"end":{"line":40,"column":127,"offset":1504},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":1378},"end":{"line":40,"column":127,"offset":1504},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Steps:","position":{"start":{"line":42,"column":1,"offset":1506},"end":{"line":42,"column":7,"offset":1512},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":1506},"end":{"line":42,"column":7,"offset":1512},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create namespaces","position":{"start":{"line":44,"column":4,"offset":1517},"end":{"line":44,"column":21,"offset":1534},"indent":[]}}],"position":{"start":{"line":44,"column":4,"offset":1517},"end":{"line":44,"column":21,"offset":1534},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":1514},"end":{"line":44,"column":21,"offset":1534},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create RBAC permissions","position":{"start":{"line":45,"column":4,"offset":1538},"end":{"line":45,"column":27,"offset":1561},"indent":[]}}],"position":{"start":{"line":45,"column":4,"offset":1538},"end":{"line":45,"column":27,"offset":1561},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":1535},"end":{"line":45,"column":27,"offset":1561},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create EFS provisioner","position":{"start":{"line":46,"column":4,"offset":1565},"end":{"line":46,"column":26,"offset":1587},"indent":[]}}],"position":{"start":{"line":46,"column":4,"offset":1565},"end":{"line":46,"column":26,"offset":1587},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":1562},"end":{"line":46,"column":26,"offset":1587},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create storageclass","position":{"start":{"line":47,"column":4,"offset":1591},"end":{"line":47,"column":23,"offset":1610},"indent":[]}}],"position":{"start":{"line":47,"column":4,"offset":1591},"end":{"line":47,"column":23,"offset":1610},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":1588},"end":{"line":47,"column":23,"offset":1610},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Create PVC's for MySQL and WordPress","position":{"start":{"line":48,"column":4,"offset":1614},"end":{"line":48,"column":40,"offset":1650},"indent":[]}}],"position":{"start":{"line":48,"column":4,"offset":1614},"end":{"line":48,"column":40,"offset":1650},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1611},"end":{"line":48,"column":40,"offset":1650},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":1514},"end":{"line":48,"column":40,"offset":1650},"indent":[1,1,1,1]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":51,"column":1,"offset":1653},"end":{"line":51,"column":31,"offset":1683},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":51,"column":31,"offset":1683}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"deploy-stateful-efs-app-with-eks\"\n    }}>{`Deploy Stateful EFS App with EKS`}</h1>\n    <h2 {...{\n      \"id\": \"what-is-efs\"\n    }}>{`What is EFS?`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`Managed NFS that can be mounted on many EC2.`}</li>\n      <li parentName=\"ul\">{`EFS works with EC2 instances in multi-AZ.`}</li>\n      <li parentName=\"ul\">{`Highly available, scalable, expensive (3xgp2), pay per use.`}</li>\n    </ul>\n    <p><img alt=\"Under the hood\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1548299128/eks-course/Screen_Shot_2019-01-24_at_2.05.15_pm.png\" /></p>\n    <h2 {...{\n      \"id\": \"efs-for-kubernetes\"\n    }}>{`EFS for Kubernetes`}</h2>\n    <p>{`Using EFS, our Wordpress Pods can now be launched into any AZ, and therefore on any K8s worker nodes.`}</p>\n    <p>{`They will all access the same underlying HTML folder (therefore sharing state).`}</p>\n    <h2 {...{\n      \"id\": \"enabling-efs\"\n    }}>{`Enabling EFS`}</h2>\n    <p>{`Heading to the AWS console. Head to the EFS page and create EFS. By default, it will try attach it to whateever VPC is available.`}</p>\n    <p><strong parentName=\"p\">{`Ensure that you attach the correct node worker security groups that we are using for Kubernetes and not the default.`}</strong></p>\n    <p>{`After adding, feel free to add a name tag but then accept the other defaults.`}</p>\n    <p>{`Ensure you take note of the `}<inlineCode parentName=\"p\">{`DNS name`}</inlineCode>{` and `}<inlineCode parentName=\"p\">{`File System ID`}</inlineCode>{`.`}</p>\n    <p>{`To be able to enable the EFS, we need to install `}<inlineCode parentName=\"p\">{`amazon-efs-utils`}</inlineCode>{` onto each of the worker nodes.`}</p>\n    <p>{`Example being `}<inlineCode parentName=\"p\">{`ssh -i .ssh/path/to/key.pem ec2-user@REDACTED \"sudo yum install -y amazon-efs-utils`}</inlineCode>{`.`}</p>\n    <h2 {...{\n      \"id\": \"creating-the-namespace-and-prepping-storage\"\n    }}>{`Creating the namespace and prepping storage`}</h2>\n    <p><img alt=\"Layout\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1548300383/eks-course/Screen_Shot_2019-01-24_at_2.26.08_pm.png\" /></p>\n    <p>{`Steps:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Create namespaces`}</li>\n      <li parentName=\"ol\">{`Create RBAC permissions`}</li>\n      <li parentName=\"ol\">{`Create EFS provisioner`}</li>\n      <li parentName=\"ol\">{`Create storageclass`}</li>\n      <li parentName=\"ol\">{`Create PVC's for MySQL and WordPress`}</li>\n    </ol>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}