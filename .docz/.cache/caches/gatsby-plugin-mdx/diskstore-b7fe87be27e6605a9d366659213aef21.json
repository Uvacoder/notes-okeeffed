{"expireTime":9007200848610889000,"key":"gatsby-plugin-mdx-entire-payload-98df8ff71a9dbc9dc12f1b51727ecc63-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":133,"offset":134},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":136},"end":{"line":5,"column":29,"offset":164},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"4. Kubernetes Administration","position":{"start":{"line":8,"column":3,"offset":169},"end":{"line":8,"column":31,"offset":197},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":167},"end":{"line":8,"column":31,"offset":197},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Resources","position":{"start":{"line":10,"column":4,"offset":202},"end":{"line":10,"column":13,"offset":211},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":199},"end":{"line":10,"column":13,"offset":211},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://github.com/etcd-io/etcd/issues/2512","children":[{"type":"text","value":"Why etcd is etcd?","position":{"start":{"line":12,"column":5,"offset":217},"end":{"line":12,"column":22,"offset":234},"indent":[]}}],"position":{"start":{"line":12,"column":4,"offset":216},"end":{"line":12,"column":68,"offset":280},"indent":[]}}],"position":{"start":{"line":12,"column":4,"offset":216},"end":{"line":12,"column":68,"offset":280},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":213},"end":{"line":12,"column":68,"offset":280},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":213},"end":{"line":12,"column":68,"offset":280},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Administration","position":{"start":{"line":14,"column":4,"offset":285},"end":{"line":14,"column":18,"offset":299},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":282},"end":{"line":14,"column":18,"offset":299},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://res.cloudinary.com/gitgoodclub/image/upload/v1540175278/Screen_Shot_2018-10-22_at_1.26.57_pm.png","alt":"Kubernetes Master Overview","position":{"start":{"line":16,"column":1,"offset":301},"end":{"line":16,"column":136,"offset":436},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":301},"end":{"line":16,"column":136,"offset":436},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When you deploy a new Pod, the information is stored in ","position":{"start":{"line":18,"column":3,"offset":440},"end":{"line":18,"column":59,"offset":496},"indent":[]}},{"type":"inlineCode","value":"etcd","position":{"start":{"line":18,"column":59,"offset":496},"end":{"line":18,"column":65,"offset":502},"indent":[]}},{"type":"text","value":". (etcd = ","position":{"start":{"line":18,"column":65,"offset":502},"end":{"line":18,"column":75,"offset":512},"indent":[]}},{"type":"inlineCode","value":"/etc","position":{"start":{"line":18,"column":75,"offset":512},"end":{"line":18,"column":81,"offset":518},"indent":[]}},{"type":"text","value":" config folder and ","position":{"start":{"line":18,"column":81,"offset":518},"end":{"line":18,"column":100,"offset":537},"indent":[]}},{"type":"inlineCode","value":"d","position":{"start":{"line":18,"column":100,"offset":537},"end":{"line":18,"column":103,"offset":540},"indent":[]}},{"type":"text","value":" = distributed)","position":{"start":{"line":18,"column":103,"offset":540},"end":{"line":18,"column":118,"offset":555},"indent":[]}}],"position":{"start":{"line":18,"column":3,"offset":440},"end":{"line":18,"column":118,"offset":555},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":438},"end":{"line":18,"column":118,"offset":555},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Schedular talks to REST api.","position":{"start":{"line":19,"column":3,"offset":558},"end":{"line":19,"column":31,"offset":586},"indent":[]}}],"position":{"start":{"line":19,"column":3,"offset":558},"end":{"line":19,"column":31,"offset":586},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":556},"end":{"line":19,"column":31,"offset":586},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"REST api is used to handle tasks.","position":{"start":{"line":20,"column":3,"offset":589},"end":{"line":20,"column":36,"offset":622},"indent":[]}}],"position":{"start":{"line":20,"column":3,"offset":589},"end":{"line":20,"column":36,"offset":622},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Interfaces with Kubelets on the nodes.","position":{"start":{"line":21,"column":5,"offset":627},"end":{"line":21,"column":43,"offset":665},"indent":[]}}],"position":{"start":{"line":21,"column":5,"offset":627},"end":{"line":21,"column":43,"offset":665},"indent":[]}}],"position":{"start":{"line":21,"column":3,"offset":625},"end":{"line":21,"column":43,"offset":665},"indent":[]}}],"position":{"start":{"line":21,"column":3,"offset":625},"end":{"line":21,"column":43,"offset":665},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":587},"end":{"line":21,"column":43,"offset":665},"indent":[1]}}],"position":{"start":{"line":18,"column":1,"offset":438},"end":{"line":21,"column":43,"offset":665},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.1 Resource Quotas","position":{"start":{"line":23,"column":4,"offset":670},"end":{"line":23,"column":23,"offset":689},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":667},"end":{"line":23,"column":23,"offset":689},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Resource management is useful when giving access to a person or a team.","position":{"start":{"line":25,"column":3,"offset":693},"end":{"line":25,"column":74,"offset":764},"indent":[]}}],"position":{"start":{"line":25,"column":3,"offset":693},"end":{"line":25,"column":74,"offset":764},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":691},"end":{"line":25,"column":74,"offset":764},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You don't want one person or team ","position":{"start":{"line":26,"column":3,"offset":767},"end":{"line":26,"column":37,"offset":801},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"taking up all the resources","position":{"start":{"line":26,"column":39,"offset":803},"end":{"line":26,"column":66,"offset":830},"indent":[]}}],"position":{"start":{"line":26,"column":37,"offset":801},"end":{"line":26,"column":68,"offset":832},"indent":[]}},{"type":"text","value":" (e.g. CPU/Memory) of the cluster.","position":{"start":{"line":26,"column":68,"offset":832},"end":{"line":26,"column":102,"offset":866},"indent":[]}}],"position":{"start":{"line":26,"column":3,"offset":767},"end":{"line":26,"column":102,"offset":866},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":765},"end":{"line":26,"column":102,"offset":866},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can divide the cluster into ","position":{"start":{"line":27,"column":3,"offset":869},"end":{"line":27,"column":35,"offset":901},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"namespaces","position":{"start":{"line":27,"column":37,"offset":903},"end":{"line":27,"column":47,"offset":913},"indent":[]}}],"position":{"start":{"line":27,"column":35,"offset":901},"end":{"line":27,"column":49,"offset":915},"indent":[]}},{"type":"text","value":" and enable resource quotas on it.","position":{"start":{"line":27,"column":49,"offset":915},"end":{"line":27,"column":83,"offset":949},"indent":[]}}],"position":{"start":{"line":27,"column":3,"offset":869},"end":{"line":27,"column":83,"offset":949},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can do this using the ","position":{"start":{"line":28,"column":5,"offset":954},"end":{"line":28,"column":31,"offset":980},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"ResourceQuota","position":{"start":{"line":28,"column":33,"offset":982},"end":{"line":28,"column":46,"offset":995},"indent":[]}}],"position":{"start":{"line":28,"column":31,"offset":980},"end":{"line":28,"column":48,"offset":997},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":28,"column":48,"offset":997},"end":{"line":28,"column":53,"offset":1002},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"ObjectQuota","position":{"start":{"line":28,"column":55,"offset":1004},"end":{"line":28,"column":66,"offset":1015},"indent":[]}}],"position":{"start":{"line":28,"column":53,"offset":1002},"end":{"line":28,"column":68,"offset":1017},"indent":[]}},{"type":"text","value":" objects.","position":{"start":{"line":28,"column":68,"offset":1017},"end":{"line":28,"column":77,"offset":1026},"indent":[]}}],"position":{"start":{"line":28,"column":5,"offset":954},"end":{"line":28,"column":77,"offset":1026},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":952},"end":{"line":28,"column":77,"offset":1026},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":952},"end":{"line":28,"column":77,"offset":1026},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":867},"end":{"line":28,"column":77,"offset":1026},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Each container can specify ","position":{"start":{"line":29,"column":3,"offset":1029},"end":{"line":29,"column":30,"offset":1056},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"request capacity","position":{"start":{"line":29,"column":32,"offset":1058},"end":{"line":29,"column":48,"offset":1074},"indent":[]}}],"position":{"start":{"line":29,"column":30,"offset":1056},"end":{"line":29,"column":50,"offset":1076},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":29,"column":50,"offset":1076},"end":{"line":29,"column":55,"offset":1081},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"capacity limits","position":{"start":{"line":29,"column":57,"offset":1083},"end":{"line":29,"column":72,"offset":1098},"indent":[]}}],"position":{"start":{"line":29,"column":55,"offset":1081},"end":{"line":29,"column":74,"offset":1100},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":29,"column":74,"offset":1100},"end":{"line":29,"column":75,"offset":1101},"indent":[]}}],"position":{"start":{"line":29,"column":3,"offset":1029},"end":{"line":29,"column":75,"offset":1101},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Request capacity","position":{"start":{"line":30,"column":7,"offset":1108},"end":{"line":30,"column":23,"offset":1124},"indent":[]}}],"position":{"start":{"line":30,"column":5,"offset":1106},"end":{"line":30,"column":25,"offset":1126},"indent":[]}},{"type":"text","value":" is an ","position":{"start":{"line":30,"column":25,"offset":1126},"end":{"line":30,"column":32,"offset":1133},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"explicit request","position":{"start":{"line":30,"column":34,"offset":1135},"end":{"line":30,"column":50,"offset":1151},"indent":[]}}],"position":{"start":{"line":30,"column":32,"offset":1133},"end":{"line":30,"column":52,"offset":1153},"indent":[]}},{"type":"text","value":" for resources.","position":{"start":{"line":30,"column":52,"offset":1153},"end":{"line":30,"column":67,"offset":1168},"indent":[]}}],"position":{"start":{"line":30,"column":5,"offset":1106},"end":{"line":30,"column":67,"offset":1168},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The scheduler can use the ","position":{"start":{"line":31,"column":7,"offset":1175},"end":{"line":31,"column":33,"offset":1201},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"request capacity","position":{"start":{"line":31,"column":35,"offset":1203},"end":{"line":31,"column":51,"offset":1219},"indent":[]}}],"position":{"start":{"line":31,"column":33,"offset":1201},"end":{"line":31,"column":53,"offset":1221},"indent":[]}},{"type":"text","value":" to make decisions on where to put the pod on.","position":{"start":{"line":31,"column":53,"offset":1221},"end":{"line":31,"column":99,"offset":1267},"indent":[]}}],"position":{"start":{"line":31,"column":7,"offset":1175},"end":{"line":31,"column":99,"offset":1267},"indent":[]}}],"position":{"start":{"line":31,"column":5,"offset":1173},"end":{"line":31,"column":99,"offset":1267},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can see it as a ","position":{"start":{"line":32,"column":7,"offset":1274},"end":{"line":32,"column":27,"offset":1294},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"minimum amount of resources the pod needs","position":{"start":{"line":32,"column":29,"offset":1296},"end":{"line":32,"column":70,"offset":1337},"indent":[]}}],"position":{"start":{"line":32,"column":27,"offset":1294},"end":{"line":32,"column":72,"offset":1339},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":32,"column":72,"offset":1339},"end":{"line":32,"column":73,"offset":1340},"indent":[]}}],"position":{"start":{"line":32,"column":7,"offset":1274},"end":{"line":32,"column":73,"offset":1340},"indent":[]}}],"position":{"start":{"line":32,"column":5,"offset":1272},"end":{"line":32,"column":73,"offset":1340},"indent":[]}}],"position":{"start":{"line":31,"column":5,"offset":1173},"end":{"line":32,"column":73,"offset":1340},"indent":[5]}}],"position":{"start":{"line":30,"column":3,"offset":1104},"end":{"line":32,"column":73,"offset":1340},"indent":[3,3]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Resource limit","position":{"start":{"line":33,"column":7,"offset":1347},"end":{"line":33,"column":21,"offset":1361},"indent":[]}}],"position":{"start":{"line":33,"column":5,"offset":1345},"end":{"line":33,"column":23,"offset":1363},"indent":[]}},{"type":"text","value":" is a limit imposed to the container.","position":{"start":{"line":33,"column":23,"offset":1363},"end":{"line":33,"column":60,"offset":1400},"indent":[]}}],"position":{"start":{"line":33,"column":5,"offset":1345},"end":{"line":33,"column":60,"offset":1400},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Container will not be able to utilize more resources than specified.","position":{"start":{"line":34,"column":7,"offset":1407},"end":{"line":34,"column":75,"offset":1475},"indent":[]}}],"position":{"start":{"line":34,"column":7,"offset":1407},"end":{"line":34,"column":75,"offset":1475},"indent":[]}}],"position":{"start":{"line":34,"column":5,"offset":1405},"end":{"line":34,"column":75,"offset":1475},"indent":[]}}],"position":{"start":{"line":34,"column":5,"offset":1405},"end":{"line":34,"column":75,"offset":1475},"indent":[]}}],"position":{"start":{"line":33,"column":3,"offset":1343},"end":{"line":34,"column":75,"offset":1475},"indent":[3]}}],"position":{"start":{"line":30,"column":3,"offset":1104},"end":{"line":34,"column":75,"offset":1475},"indent":[3,3,3,3]}}],"position":{"start":{"line":29,"column":1,"offset":1027},"end":{"line":34,"column":75,"offset":1475},"indent":[1,1,1,1,1]}}],"position":{"start":{"line":25,"column":1,"offset":691},"end":{"line":34,"column":75,"offset":1475},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Resource Quota Examples","position":{"start":{"line":36,"column":5,"offset":1481},"end":{"line":36,"column":28,"offset":1504},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1477},"end":{"line":36,"column":28,"offset":1504},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You run a ","position":{"start":{"line":38,"column":3,"offset":1508},"end":{"line":38,"column":13,"offset":1518},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"deployment","position":{"start":{"line":38,"column":15,"offset":1520},"end":{"line":38,"column":25,"offset":1530},"indent":[]}}],"position":{"start":{"line":38,"column":13,"offset":1518},"end":{"line":38,"column":27,"offset":1532},"indent":[]}},{"type":"text","value":" with a ","position":{"start":{"line":38,"column":27,"offset":1532},"end":{"line":38,"column":35,"offset":1540},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"pod","position":{"start":{"line":38,"column":37,"offset":1542},"end":{"line":38,"column":40,"offset":1545},"indent":[]}}],"position":{"start":{"line":38,"column":35,"offset":1540},"end":{"line":38,"column":42,"offset":1547},"indent":[]}},{"type":"text","value":" with a ","position":{"start":{"line":38,"column":42,"offset":1547},"end":{"line":38,"column":50,"offset":1555},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"CPU resource","position":{"start":{"line":38,"column":52,"offset":1557},"end":{"line":38,"column":64,"offset":1569},"indent":[]}}],"position":{"start":{"line":38,"column":50,"offset":1555},"end":{"line":38,"column":66,"offset":1571},"indent":[]}},{"type":"text","value":" request of ","position":{"start":{"line":38,"column":66,"offset":1571},"end":{"line":38,"column":78,"offset":1583},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"200m","position":{"start":{"line":38,"column":80,"offset":1585},"end":{"line":38,"column":84,"offset":1589},"indent":[]}}],"position":{"start":{"line":38,"column":78,"offset":1583},"end":{"line":38,"column":86,"offset":1591},"indent":[]}},{"type":"text","value":". (200 millicpu/milliocores).","position":{"start":{"line":38,"column":86,"offset":1591},"end":{"line":38,"column":115,"offset":1620},"indent":[]}}],"position":{"start":{"line":38,"column":3,"offset":1508},"end":{"line":38,"column":115,"offset":1620},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1506},"end":{"line":38,"column":115,"offset":1620},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"200m = 0.2 = 20% of CPU core of running node.","position":{"start":{"line":39,"column":3,"offset":1623},"end":{"line":39,"column":48,"offset":1668},"indent":[]}}],"position":{"start":{"line":39,"column":3,"offset":1623},"end":{"line":39,"column":48,"offset":1668},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If node has 2 cores, still 20% of a single core.","position":{"start":{"line":40,"column":5,"offset":1673},"end":{"line":40,"column":53,"offset":1721},"indent":[]}}],"position":{"start":{"line":40,"column":5,"offset":1673},"end":{"line":40,"column":53,"offset":1721},"indent":[]}}],"position":{"start":{"line":40,"column":3,"offset":1671},"end":{"line":40,"column":53,"offset":1721},"indent":[]}}],"position":{"start":{"line":40,"column":3,"offset":1671},"end":{"line":40,"column":53,"offset":1721},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":1621},"end":{"line":40,"column":53,"offset":1721},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can also put a limit eg 400m.","position":{"start":{"line":41,"column":3,"offset":1724},"end":{"line":41,"column":36,"offset":1757},"indent":[]}}],"position":{"start":{"line":41,"column":3,"offset":1724},"end":{"line":41,"column":36,"offset":1757},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":1722},"end":{"line":41,"column":36,"offset":1757},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Memory quotes defined in MB or GB.","position":{"start":{"line":42,"column":3,"offset":1760},"end":{"line":42,"column":37,"offset":1794},"indent":[]}}],"position":{"start":{"line":42,"column":3,"offset":1760},"end":{"line":42,"column":37,"offset":1794},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":1758},"end":{"line":42,"column":37,"offset":1794},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Each pod needs the capacity quota defined during creation.","position":{"start":{"line":43,"column":3,"offset":1797},"end":{"line":43,"column":61,"offset":1855},"indent":[]}}],"position":{"start":{"line":43,"column":3,"offset":1797},"end":{"line":43,"column":61,"offset":1855},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Admin can specify default request values for pods that don't specify any values for capacity.","position":{"start":{"line":44,"column":5,"offset":1860},"end":{"line":44,"column":98,"offset":1953},"indent":[]}}],"position":{"start":{"line":44,"column":5,"offset":1860},"end":{"line":44,"column":98,"offset":1953},"indent":[]}}],"position":{"start":{"line":44,"column":3,"offset":1858},"end":{"line":44,"column":98,"offset":1953},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The same is valid for limit quotas.","position":{"start":{"line":45,"column":5,"offset":1958},"end":{"line":45,"column":40,"offset":1993},"indent":[]}}],"position":{"start":{"line":45,"column":5,"offset":1958},"end":{"line":45,"column":40,"offset":1993},"indent":[]}}],"position":{"start":{"line":45,"column":3,"offset":1956},"end":{"line":45,"column":40,"offset":1993},"indent":[]}}],"position":{"start":{"line":44,"column":3,"offset":1858},"end":{"line":45,"column":40,"offset":1993},"indent":[3]}}],"position":{"start":{"line":43,"column":1,"offset":1795},"end":{"line":45,"column":40,"offset":1993},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If resource is requested more than the allowed capacity, the server API will give an error 403 FORBIDDEN and ","position":{"start":{"line":46,"column":3,"offset":1996},"end":{"line":46,"column":112,"offset":2105},"indent":[]}},{"type":"inlineCode","value":"kubectl","position":{"start":{"line":46,"column":112,"offset":2105},"end":{"line":46,"column":121,"offset":2114},"indent":[]}},{"type":"text","value":" will show an error.","position":{"start":{"line":46,"column":121,"offset":2114},"end":{"line":46,"column":141,"offset":2134},"indent":[]}}],"position":{"start":{"line":46,"column":3,"offset":1996},"end":{"line":46,"column":141,"offset":2134},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":1994},"end":{"line":46,"column":141,"offset":2134},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1506},"end":{"line":46,"column":141,"offset":2134},"indent":[1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Resource Quote options","position":{"start":{"line":48,"column":5,"offset":2140},"end":{"line":48,"column":27,"offset":2162},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2136},"end":{"line":48,"column":27,"offset":2162},"indent":[]}},{"type":"table","align":[null,null],"children":[{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"Resource","position":{"start":{"line":50,"column":3,"offset":2166},"end":{"line":50,"column":11,"offset":2174},"indent":[]}}],"position":{"start":{"line":50,"column":3,"offset":2166},"end":{"line":50,"column":19,"offset":2182},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Description","position":{"start":{"line":50,"column":22,"offset":2185},"end":{"line":50,"column":33,"offset":2196},"indent":[]}}],"position":{"start":{"line":50,"column":22,"offset":2185},"end":{"line":50,"column":98,"offset":2261},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2164},"end":{"line":50,"column":100,"offset":2263},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"requests.cpu","position":{"start":{"line":52,"column":3,"offset":2366},"end":{"line":52,"column":15,"offset":2378},"indent":[]}}],"position":{"start":{"line":52,"column":3,"offset":2366},"end":{"line":52,"column":19,"offset":2382},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Sum of CPU reqs of all pos cannot exceed this value","position":{"start":{"line":52,"column":22,"offset":2385},"end":{"line":52,"column":73,"offset":2436},"indent":[]}}],"position":{"start":{"line":52,"column":22,"offset":2385},"end":{"line":52,"column":98,"offset":2461},"indent":[]}}],"position":{"start":{"line":52,"column":1,"offset":2364},"end":{"line":52,"column":100,"offset":2463},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"requests.mem","position":{"start":{"line":53,"column":3,"offset":2466},"end":{"line":53,"column":15,"offset":2478},"indent":[]}}],"position":{"start":{"line":53,"column":3,"offset":2466},"end":{"line":53,"column":19,"offset":2482},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Sum of MEM reqs of all pods cannot exceed this value","position":{"start":{"line":53,"column":22,"offset":2485},"end":{"line":53,"column":74,"offset":2537},"indent":[]}}],"position":{"start":{"line":53,"column":22,"offset":2485},"end":{"line":53,"column":98,"offset":2561},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":2464},"end":{"line":53,"column":100,"offset":2563},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"requests.storage","position":{"start":{"line":54,"column":3,"offset":2566},"end":{"line":54,"column":19,"offset":2582},"indent":[]}}],"position":{"start":{"line":54,"column":3,"offset":2566},"end":{"line":54,"column":19,"offset":2582},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Sum of storage reqs of all persistent volume claims cannot exceed this value","position":{"start":{"line":54,"column":22,"offset":2585},"end":{"line":54,"column":98,"offset":2661},"indent":[]}}],"position":{"start":{"line":54,"column":22,"offset":2585},"end":{"line":54,"column":98,"offset":2661},"indent":[]}}],"position":{"start":{"line":54,"column":1,"offset":2564},"end":{"line":54,"column":100,"offset":2663},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"limits.cpu","position":{"start":{"line":55,"column":3,"offset":2666},"end":{"line":55,"column":13,"offset":2676},"indent":[]}}],"position":{"start":{"line":55,"column":3,"offset":2666},"end":{"line":55,"column":19,"offset":2682},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Sum of CPU limits of all pods cannot exceed this value","position":{"start":{"line":55,"column":22,"offset":2685},"end":{"line":55,"column":76,"offset":2739},"indent":[]}}],"position":{"start":{"line":55,"column":22,"offset":2685},"end":{"line":55,"column":98,"offset":2761},"indent":[]}}],"position":{"start":{"line":55,"column":1,"offset":2664},"end":{"line":55,"column":100,"offset":2763},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"limits.memory","position":{"start":{"line":56,"column":3,"offset":2766},"end":{"line":56,"column":16,"offset":2779},"indent":[]}}],"position":{"start":{"line":56,"column":3,"offset":2766},"end":{"line":56,"column":19,"offset":2782},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Sum of MEM limits of all pods cannot exceed this value","position":{"start":{"line":56,"column":22,"offset":2785},"end":{"line":56,"column":76,"offset":2839},"indent":[]}}],"position":{"start":{"line":56,"column":22,"offset":2785},"end":{"line":56,"column":98,"offset":2861},"indent":[]}}],"position":{"start":{"line":56,"column":1,"offset":2764},"end":{"line":56,"column":100,"offset":2863},"indent":[]}}],"position":{"start":{"line":50,"column":1,"offset":2164},"end":{"line":56,"column":100,"offset":2863},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"You can also set limits on:","position":{"start":{"line":58,"column":1,"offset":2865},"end":{"line":58,"column":28,"offset":2892},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":2865},"end":{"line":58,"column":28,"offset":2892},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"configmaps","position":{"start":{"line":60,"column":3,"offset":2896},"end":{"line":60,"column":13,"offset":2906},"indent":[]}}],"position":{"start":{"line":60,"column":3,"offset":2896},"end":{"line":60,"column":13,"offset":2906},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":2894},"end":{"line":60,"column":13,"offset":2906},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"persistentvolumeclaims","position":{"start":{"line":61,"column":3,"offset":2909},"end":{"line":61,"column":25,"offset":2931},"indent":[]}}],"position":{"start":{"line":61,"column":3,"offset":2909},"end":{"line":61,"column":25,"offset":2931},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":2907},"end":{"line":61,"column":25,"offset":2931},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"pods","position":{"start":{"line":62,"column":3,"offset":2934},"end":{"line":62,"column":7,"offset":2938},"indent":[]}}],"position":{"start":{"line":62,"column":3,"offset":2934},"end":{"line":62,"column":7,"offset":2938},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":2932},"end":{"line":62,"column":7,"offset":2938},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"replicationcontrollers","position":{"start":{"line":63,"column":3,"offset":2941},"end":{"line":63,"column":25,"offset":2963},"indent":[]}}],"position":{"start":{"line":63,"column":3,"offset":2941},"end":{"line":63,"column":25,"offset":2963},"indent":[]}}],"position":{"start":{"line":63,"column":1,"offset":2939},"end":{"line":63,"column":25,"offset":2963},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"resourcequotas","position":{"start":{"line":64,"column":3,"offset":2966},"end":{"line":64,"column":17,"offset":2980},"indent":[]}}],"position":{"start":{"line":64,"column":3,"offset":2966},"end":{"line":64,"column":17,"offset":2980},"indent":[]}}],"position":{"start":{"line":64,"column":1,"offset":2964},"end":{"line":64,"column":17,"offset":2980},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"services","position":{"start":{"line":65,"column":3,"offset":2983},"end":{"line":65,"column":11,"offset":2991},"indent":[]}}],"position":{"start":{"line":65,"column":3,"offset":2983},"end":{"line":65,"column":11,"offset":2991},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":2981},"end":{"line":65,"column":11,"offset":2991},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"services.loadbalancer","position":{"start":{"line":66,"column":3,"offset":2994},"end":{"line":66,"column":24,"offset":3015},"indent":[]}}],"position":{"start":{"line":66,"column":3,"offset":2994},"end":{"line":66,"column":24,"offset":3015},"indent":[]}}],"position":{"start":{"line":66,"column":1,"offset":2992},"end":{"line":66,"column":24,"offset":3015},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"services.nodeports","position":{"start":{"line":67,"column":3,"offset":3018},"end":{"line":67,"column":21,"offset":3036},"indent":[]}}],"position":{"start":{"line":67,"column":3,"offset":3018},"end":{"line":67,"column":21,"offset":3036},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":3016},"end":{"line":67,"column":21,"offset":3036},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"secrets","position":{"start":{"line":68,"column":3,"offset":3039},"end":{"line":68,"column":10,"offset":3046},"indent":[]}}],"position":{"start":{"line":68,"column":3,"offset":3039},"end":{"line":68,"column":10,"offset":3046},"indent":[]}}],"position":{"start":{"line":68,"column":1,"offset":3037},"end":{"line":68,"column":10,"offset":3046},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":2894},"end":{"line":68,"column":10,"offset":3046},"indent":[1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.2 Namespaces","position":{"start":{"line":70,"column":4,"offset":3051},"end":{"line":70,"column":18,"offset":3065},"indent":[]}}],"position":{"start":{"line":70,"column":1,"offset":3048},"end":{"line":70,"column":18,"offset":3065},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Namespaces allow you to create ","position":{"start":{"line":72,"column":1,"offset":3067},"end":{"line":72,"column":32,"offset":3098},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"virtual clusters","position":{"start":{"line":72,"column":34,"offset":3100},"end":{"line":72,"column":50,"offset":3116},"indent":[]}}],"position":{"start":{"line":72,"column":32,"offset":3098},"end":{"line":72,"column":52,"offset":3118},"indent":[]}},{"type":"text","value":" within the same physical cluster.","position":{"start":{"line":72,"column":52,"offset":3118},"end":{"line":72,"column":86,"offset":3152},"indent":[]}}],"position":{"start":{"line":72,"column":1,"offset":3067},"end":{"line":72,"column":86,"offset":3152},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Namespaces ","position":{"start":{"line":74,"column":3,"offset":3156},"end":{"line":74,"column":14,"offset":3167},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"logically separates","position":{"start":{"line":74,"column":16,"offset":3169},"end":{"line":74,"column":35,"offset":3188},"indent":[]}}],"position":{"start":{"line":74,"column":14,"offset":3167},"end":{"line":74,"column":37,"offset":3190},"indent":[]}},{"type":"text","value":" your cluster.","position":{"start":{"line":74,"column":37,"offset":3190},"end":{"line":74,"column":51,"offset":3204},"indent":[]}}],"position":{"start":{"line":74,"column":3,"offset":3156},"end":{"line":74,"column":51,"offset":3204},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":3154},"end":{"line":74,"column":51,"offset":3204},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The standard namespace is called ","position":{"start":{"line":75,"column":3,"offset":3207},"end":{"line":75,"column":36,"offset":3240},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"\"default\"","position":{"start":{"line":75,"column":38,"offset":3242},"end":{"line":75,"column":47,"offset":3251},"indent":[]}}],"position":{"start":{"line":75,"column":36,"offset":3240},"end":{"line":75,"column":49,"offset":3253},"indent":[]}},{"type":"text","value":" and that's where all the resources are launched by default.","position":{"start":{"line":75,"column":49,"offset":3253},"end":{"line":75,"column":109,"offset":3313},"indent":[]}}],"position":{"start":{"line":75,"column":3,"offset":3207},"end":{"line":75,"column":109,"offset":3313},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"There is also ","position":{"start":{"line":76,"column":5,"offset":3318},"end":{"line":76,"column":19,"offset":3332},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"kube-system","position":{"start":{"line":76,"column":21,"offset":3334},"end":{"line":76,"column":32,"offset":3345},"indent":[]}}],"position":{"start":{"line":76,"column":19,"offset":3332},"end":{"line":76,"column":34,"offset":3347},"indent":[]}},{"type":"text","value":" - a namespace for kubernetes specific resources.","position":{"start":{"line":76,"column":34,"offset":3347},"end":{"line":76,"column":83,"offset":3396},"indent":[]}}],"position":{"start":{"line":76,"column":5,"offset":3318},"end":{"line":76,"column":83,"offset":3396},"indent":[]}}],"position":{"start":{"line":76,"column":3,"offset":3316},"end":{"line":76,"column":83,"offset":3396},"indent":[]}}],"position":{"start":{"line":76,"column":3,"offset":3316},"end":{"line":76,"column":83,"offset":3396},"indent":[]}}],"position":{"start":{"line":75,"column":1,"offset":3205},"end":{"line":76,"column":83,"offset":3396},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Namespaces are intended when you have ","position":{"start":{"line":77,"column":3,"offset":3399},"end":{"line":77,"column":41,"offset":3437},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"multiple teams/projects","position":{"start":{"line":77,"column":43,"offset":3439},"end":{"line":77,"column":66,"offset":3462},"indent":[]}}],"position":{"start":{"line":77,"column":41,"offset":3437},"end":{"line":77,"column":68,"offset":3464},"indent":[]}},{"type":"text","value":" using the Kubernetes cluster.","position":{"start":{"line":77,"column":68,"offset":3464},"end":{"line":77,"column":98,"offset":3494},"indent":[]}}],"position":{"start":{"line":77,"column":3,"offset":3399},"end":{"line":77,"column":98,"offset":3494},"indent":[]}}],"position":{"start":{"line":77,"column":1,"offset":3397},"end":{"line":77,"column":98,"offset":3494},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Resource names within namespace must be unique.","position":{"start":{"line":78,"column":3,"offset":3497},"end":{"line":78,"column":50,"offset":3544},"indent":[]}}],"position":{"start":{"line":78,"column":3,"offset":3497},"end":{"line":78,"column":50,"offset":3544},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":3495},"end":{"line":78,"column":50,"offset":3544},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can divide resources of a Kubernetes cluster using namespaces.","position":{"start":{"line":79,"column":3,"offset":3547},"end":{"line":79,"column":69,"offset":3613},"indent":[]}}],"position":{"start":{"line":79,"column":3,"offset":3547},"end":{"line":79,"column":69,"offset":3613},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can limit resources on a per namespace basis.","position":{"start":{"line":80,"column":5,"offset":3618},"end":{"line":80,"column":54,"offset":3667},"indent":[]}}],"position":{"start":{"line":80,"column":5,"offset":3618},"end":{"line":80,"column":54,"offset":3667},"indent":[]}}],"position":{"start":{"line":80,"column":3,"offset":3616},"end":{"line":80,"column":54,"offset":3667},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"E.g. Marketing team can only use a maximum of 10GiB of memory, 2 loadbalancers, 2 CPU cores.","position":{"start":{"line":81,"column":5,"offset":3672},"end":{"line":81,"column":97,"offset":3764},"indent":[]}}],"position":{"start":{"line":81,"column":5,"offset":3672},"end":{"line":81,"column":97,"offset":3764},"indent":[]}}],"position":{"start":{"line":81,"column":3,"offset":3670},"end":{"line":81,"column":97,"offset":3764},"indent":[]}}],"position":{"start":{"line":80,"column":3,"offset":3616},"end":{"line":81,"column":97,"offset":3764},"indent":[3]}}],"position":{"start":{"line":79,"column":1,"offset":3545},"end":{"line":81,"column":97,"offset":3764},"indent":[1,1]}}],"position":{"start":{"line":74,"column":1,"offset":3154},"end":{"line":81,"column":97,"offset":3764},"indent":[1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Namespace commands","position":{"start":{"line":83,"column":5,"offset":3770},"end":{"line":83,"column":23,"offset":3788},"indent":[]}}],"position":{"start":{"line":83,"column":1,"offset":3766},"end":{"line":83,"column":23,"offset":3788},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"$ kubectl create namespace myspace # create namespace myspace\n$ kubectl get namespaces # list all namespaces\n# Set default namespace to launch resources in\n$ export CONTEXT=$(kubectl config view | awk '/current-context/{print $2}')\n$ kubectl config set-context $CONTEXT --namespace=myspace","position":{"start":{"line":85,"column":1,"offset":3790},"end":{"line":91,"column":4,"offset":4091},"indent":[1,1,1,1,1,1]}},{"type":"code","lang":"yaml","meta":null,"value":"apiVersion: 1\nkind: ResourceQuota\nmetadata:\n  name: objects-counts\nnamespace: myspace\nspec:\n  hard:\n    configmaps: '10'\npersistentvolumesclaim: '4'\nreplicationcontrollers: '20'\nsecrets: '10'\nservices: '10'\nservices.loadbalancers: '2'","position":{"start":{"line":93,"column":1,"offset":4093},"end":{"line":107,"column":4,"offset":4339},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Demo ResourceQuotas","position":{"start":{"line":109,"column":5,"offset":4345},"end":{"line":109,"column":24,"offset":4364},"indent":[]}}],"position":{"start":{"line":109,"column":1,"offset":4341},"end":{"line":109,"column":24,"offset":4364},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"# resourcequota.yml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: myspace\n---\napiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: compute-quota\n  namespace: myspace\nspec:\n  hard:\n    requests.cpu: '1'\n    requests.memory: 1Gi\n    limits.cpu: '2'\n    limits.memory: 2Gi\n---\napiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: object-quota\n  namespace: myspace\nspec:\n  hard:\n    configmaps: '10'\n    persistentvolumeclaims: '4'\n    replicationcontrollers: '20'\n    secrets: '10'\n    services: '10'\n    services.loadbalancers: '2'","position":{"start":{"line":111,"column":1,"offset":4366},"end":{"line":143,"column":4,"offset":4910},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"yaml","meta":null,"value":"# helloworld-with-quotas.yaml\napiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  name: helloworld-deployment\n  namespace: myspace\nspec:\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: helloworld\n    spec:\n      containers:\n        - name: k8s-demo\n          image: wardviaene/k8s-demo\n          ports:\n            - name: nodejs-port\n              containerPort: 3000\n          resources:\n            requests:\n              cpu: 200m\n              memory: 0.5Gi\n            limits:\n              cpu: 400m\n              memory: 1Gi","position":{"start":{"line":145,"column":1,"offset":4912},"end":{"line":172,"column":4,"offset":5484},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"yaml","meta":null,"value":"# helloworld-no-quotas.yaml\napiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  name: helloworld-deployment\n  namespace: myspace\nspec:\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: helloworld\n    spec:\n      containers:\n        - name: k8s-demo\n          image: wardviaene/k8s-demo\n          ports:\n            - name: nodejs-port\n              containerPort: 3000","position":{"start":{"line":174,"column":1,"offset":5486},"end":{"line":194,"column":4,"offset":5891},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"yaml","meta":null,"value":"# default.yaml\napiVersion: v1\nkind: LimitRange\nmetadata:\n  name: limits\n  namespace: myspace\nspec:\n  limits:\n    - default:\n        cpu: 200m\n        memory: 512Mi\n      defaultRequest:\n        cpu: 100m\n        memory: 256Mi\n      type: Container","position":{"start":{"line":196,"column":1,"offset":5893},"end":{"line":212,"column":4,"offset":6152},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The following commands can be used to get check resources:","position":{"start":{"line":214,"column":1,"offset":6154},"end":{"line":214,"column":59,"offset":6212},"indent":[]}}],"position":{"start":{"line":214,"column":1,"offset":6154},"end":{"line":214,"column":59,"offset":6212},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"$ kubectl get <% pod_name %> --namespace=myspace\n$ kubectl describe <% pod_name %> --namespace=myspace","position":{"start":{"line":216,"column":1,"offset":6214},"end":{"line":219,"column":4,"offset":6328},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.3 User Management","position":{"start":{"line":221,"column":4,"offset":6333},"end":{"line":221,"column":23,"offset":6352},"indent":[]}}],"position":{"start":{"line":221,"column":1,"offset":6330},"end":{"line":221,"column":23,"offset":6352},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"There are two user types:","position":{"start":{"line":223,"column":1,"offset":6354},"end":{"line":223,"column":26,"offset":6379},"indent":[]}}],"position":{"start":{"line":223,"column":1,"offset":6354},"end":{"line":223,"column":26,"offset":6379},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Normal user (used to access the cluster externally) ie through kubctl.","position":{"start":{"line":225,"column":4,"offset":6384},"end":{"line":225,"column":74,"offset":6454},"indent":[]}}],"position":{"start":{"line":225,"column":4,"offset":6384},"end":{"line":225,"column":74,"offset":6454},"indent":[]}}],"position":{"start":{"line":225,"column":1,"offset":6381},"end":{"line":225,"column":74,"offset":6454},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Service user (which is managed by an object in Kubernetes).","position":{"start":{"line":226,"column":4,"offset":6458},"end":{"line":226,"column":63,"offset":6517},"indent":[]}}],"position":{"start":{"line":226,"column":4,"offset":6458},"end":{"line":226,"column":63,"offset":6517},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Used to authenticate within the cluster ie from inside pod of kubelet.","position":{"start":{"line":227,"column":6,"offset":6523},"end":{"line":227,"column":76,"offset":6593},"indent":[]}}],"position":{"start":{"line":227,"column":6,"offset":6523},"end":{"line":227,"column":76,"offset":6593},"indent":[]}}],"position":{"start":{"line":227,"column":4,"offset":6521},"end":{"line":227,"column":76,"offset":6593},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"These creds are managed like ","position":{"start":{"line":228,"column":6,"offset":6599},"end":{"line":228,"column":35,"offset":6628},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"secrets","position":{"start":{"line":228,"column":37,"offset":6630},"end":{"line":228,"column":44,"offset":6637},"indent":[]}}],"position":{"start":{"line":228,"column":35,"offset":6628},"end":{"line":228,"column":46,"offset":6639},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":228,"column":46,"offset":6639},"end":{"line":228,"column":47,"offset":6640},"indent":[]}}],"position":{"start":{"line":228,"column":6,"offset":6599},"end":{"line":228,"column":47,"offset":6640},"indent":[]}}],"position":{"start":{"line":228,"column":4,"offset":6597},"end":{"line":228,"column":47,"offset":6640},"indent":[]}}],"position":{"start":{"line":227,"column":4,"offset":6521},"end":{"line":228,"column":47,"offset":6640},"indent":[4]}}],"position":{"start":{"line":226,"column":1,"offset":6455},"end":{"line":228,"column":47,"offset":6640},"indent":[1,1]}}],"position":{"start":{"line":225,"column":1,"offset":6381},"end":{"line":228,"column":47,"offset":6640},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Normal Users","position":{"start":{"line":230,"column":5,"offset":6646},"end":{"line":230,"column":17,"offset":6658},"indent":[]}}],"position":{"start":{"line":230,"column":1,"offset":6642},"end":{"line":230,"column":17,"offset":6658},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Auth strategies include:","position":{"start":{"line":232,"column":1,"offset":6660},"end":{"line":232,"column":25,"offset":6684},"indent":[]}}],"position":{"start":{"line":232,"column":1,"offset":6660},"end":{"line":232,"column":25,"offset":6684},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Client certificates","position":{"start":{"line":234,"column":3,"offset":6688},"end":{"line":234,"column":22,"offset":6707},"indent":[]}}],"position":{"start":{"line":234,"column":3,"offset":6688},"end":{"line":234,"column":22,"offset":6707},"indent":[]}}],"position":{"start":{"line":234,"column":1,"offset":6686},"end":{"line":234,"column":22,"offset":6707},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Bearer Tokens","position":{"start":{"line":235,"column":3,"offset":6710},"end":{"line":235,"column":16,"offset":6723},"indent":[]}}],"position":{"start":{"line":235,"column":3,"offset":6710},"end":{"line":235,"column":16,"offset":6723},"indent":[]}}],"position":{"start":{"line":235,"column":1,"offset":6708},"end":{"line":235,"column":16,"offset":6723},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Authentication Proxy","position":{"start":{"line":236,"column":3,"offset":6726},"end":{"line":236,"column":23,"offset":6746},"indent":[]}}],"position":{"start":{"line":236,"column":3,"offset":6726},"end":{"line":236,"column":23,"offset":6746},"indent":[]}}],"position":{"start":{"line":236,"column":1,"offset":6724},"end":{"line":236,"column":23,"offset":6746},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"HTTP Basic Authentication","position":{"start":{"line":237,"column":3,"offset":6749},"end":{"line":237,"column":28,"offset":6774},"indent":[]}}],"position":{"start":{"line":237,"column":3,"offset":6749},"end":{"line":237,"column":28,"offset":6774},"indent":[]}}],"position":{"start":{"line":237,"column":1,"offset":6747},"end":{"line":237,"column":28,"offset":6774},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"OpenID","position":{"start":{"line":238,"column":3,"offset":6777},"end":{"line":238,"column":9,"offset":6783},"indent":[]}}],"position":{"start":{"line":238,"column":3,"offset":6777},"end":{"line":238,"column":9,"offset":6783},"indent":[]}}],"position":{"start":{"line":238,"column":1,"offset":6775},"end":{"line":238,"column":9,"offset":6783},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Webhooks","position":{"start":{"line":239,"column":3,"offset":6786},"end":{"line":239,"column":11,"offset":6794},"indent":[]}}],"position":{"start":{"line":239,"column":3,"offset":6786},"end":{"line":239,"column":11,"offset":6794},"indent":[]}}],"position":{"start":{"line":239,"column":1,"offset":6784},"end":{"line":239,"column":11,"offset":6794},"indent":[]}}],"position":{"start":{"line":234,"column":1,"offset":6686},"end":{"line":239,"column":11,"offset":6794},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"They have the following attributes:","position":{"start":{"line":241,"column":1,"offset":6796},"end":{"line":241,"column":36,"offset":6831},"indent":[]}}],"position":{"start":{"line":241,"column":1,"offset":6796},"end":{"line":241,"column":36,"offset":6831},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Username (e.g. user123 or email@email.com)","position":{"start":{"line":243,"column":3,"offset":6835},"end":{"line":243,"column":45,"offset":6877},"indent":[]}}],"position":{"start":{"line":243,"column":3,"offset":6835},"end":{"line":243,"column":45,"offset":6877},"indent":[]}}],"position":{"start":{"line":243,"column":1,"offset":6833},"end":{"line":243,"column":45,"offset":6877},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A UID","position":{"start":{"line":244,"column":3,"offset":6880},"end":{"line":244,"column":8,"offset":6885},"indent":[]}}],"position":{"start":{"line":244,"column":3,"offset":6880},"end":{"line":244,"column":8,"offset":6885},"indent":[]}}],"position":{"start":{"line":244,"column":1,"offset":6878},"end":{"line":244,"column":8,"offset":6885},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Groups","position":{"start":{"line":245,"column":3,"offset":6888},"end":{"line":245,"column":9,"offset":6894},"indent":[]}}],"position":{"start":{"line":245,"column":3,"offset":6888},"end":{"line":245,"column":9,"offset":6894},"indent":[]}}],"position":{"start":{"line":245,"column":1,"offset":6886},"end":{"line":245,"column":9,"offset":6894},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Extra fields to store extra info","position":{"start":{"line":246,"column":3,"offset":6897},"end":{"line":246,"column":35,"offset":6929},"indent":[]}}],"position":{"start":{"line":246,"column":3,"offset":6897},"end":{"line":246,"column":35,"offset":6929},"indent":[]}}],"position":{"start":{"line":246,"column":1,"offset":6895},"end":{"line":246,"column":35,"offset":6929},"indent":[]}}],"position":{"start":{"line":243,"column":1,"offset":6833},"end":{"line":246,"column":35,"offset":6929},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"After a normal user authenticates, it was hav access to everything.","position":{"start":{"line":248,"column":1,"offset":6931},"end":{"line":248,"column":68,"offset":6998},"indent":[]}}],"position":{"start":{"line":248,"column":1,"offset":6931},"end":{"line":248,"column":68,"offset":6998},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"To limit, you need to configure auth.","position":{"start":{"line":250,"column":3,"offset":7002},"end":{"line":250,"column":40,"offset":7039},"indent":[]}}],"position":{"start":{"line":250,"column":3,"offset":7002},"end":{"line":250,"column":40,"offset":7039},"indent":[]}}],"position":{"start":{"line":250,"column":1,"offset":7000},"end":{"line":250,"column":40,"offset":7039},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"There are multiple offerings:","position":{"start":{"line":251,"column":3,"offset":7042},"end":{"line":251,"column":32,"offset":7071},"indent":[]}}],"position":{"start":{"line":251,"column":3,"offset":7042},"end":{"line":251,"column":32,"offset":7071},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"AlwaysAllow / AlwaysDeny","position":{"start":{"line":252,"column":5,"offset":7076},"end":{"line":252,"column":29,"offset":7100},"indent":[]}}],"position":{"start":{"line":252,"column":5,"offset":7076},"end":{"line":252,"column":29,"offset":7100},"indent":[]}}],"position":{"start":{"line":252,"column":3,"offset":7074},"end":{"line":252,"column":29,"offset":7100},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"ABAC (Attribute-Based Access Control)","position":{"start":{"line":253,"column":5,"offset":7105},"end":{"line":253,"column":42,"offset":7142},"indent":[]}}],"position":{"start":{"line":253,"column":5,"offset":7105},"end":{"line":253,"column":42,"offset":7142},"indent":[]}}],"position":{"start":{"line":253,"column":3,"offset":7103},"end":{"line":253,"column":42,"offset":7142},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"RBAC (Role Based Access Control)","position":{"start":{"line":254,"column":5,"offset":7147},"end":{"line":254,"column":37,"offset":7179},"indent":[]}}],"position":{"start":{"line":254,"column":5,"offset":7147},"end":{"line":254,"column":37,"offset":7179},"indent":[]}}],"position":{"start":{"line":254,"column":3,"offset":7145},"end":{"line":254,"column":37,"offset":7179},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Webhook (auth by remote service)","position":{"start":{"line":255,"column":5,"offset":7184},"end":{"line":255,"column":37,"offset":7216},"indent":[]}}],"position":{"start":{"line":255,"column":5,"offset":7184},"end":{"line":255,"column":37,"offset":7216},"indent":[]}}],"position":{"start":{"line":255,"column":3,"offset":7182},"end":{"line":255,"column":37,"offset":7216},"indent":[]}}],"position":{"start":{"line":252,"column":3,"offset":7074},"end":{"line":255,"column":37,"offset":7216},"indent":[3,3,3]}}],"position":{"start":{"line":251,"column":1,"offset":7040},"end":{"line":255,"column":37,"offset":7216},"indent":[1,1,1,1]}}],"position":{"start":{"line":250,"column":1,"offset":7000},"end":{"line":255,"column":37,"offset":7216},"indent":[1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Service Users","position":{"start":{"line":257,"column":5,"offset":7222},"end":{"line":257,"column":18,"offset":7235},"indent":[]}}],"position":{"start":{"line":257,"column":1,"offset":7218},"end":{"line":257,"column":18,"offset":7235},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Service Users are using ","position":{"start":{"line":259,"column":3,"offset":7239},"end":{"line":259,"column":27,"offset":7263},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Service Account Tokens","position":{"start":{"line":259,"column":29,"offset":7265},"end":{"line":259,"column":51,"offset":7287},"indent":[]}}],"position":{"start":{"line":259,"column":27,"offset":7263},"end":{"line":259,"column":53,"offset":7289},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":259,"column":53,"offset":7289},"end":{"line":259,"column":54,"offset":7290},"indent":[]}}],"position":{"start":{"line":259,"column":3,"offset":7239},"end":{"line":259,"column":54,"offset":7290},"indent":[]}}],"position":{"start":{"line":259,"column":1,"offset":7237},"end":{"line":259,"column":54,"offset":7290},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"They are stored as ","position":{"start":{"line":260,"column":3,"offset":7293},"end":{"line":260,"column":22,"offset":7312},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"credentials using Secrets","position":{"start":{"line":260,"column":24,"offset":7314},"end":{"line":260,"column":49,"offset":7339},"indent":[]}}],"position":{"start":{"line":260,"column":22,"offset":7312},"end":{"line":260,"column":51,"offset":7341},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":260,"column":51,"offset":7341},"end":{"line":260,"column":52,"offset":7342},"indent":[]}}],"position":{"start":{"line":260,"column":3,"offset":7293},"end":{"line":260,"column":52,"offset":7342},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Those Secrets are also mounted in pods to allow communication between the services.","position":{"start":{"line":261,"column":5,"offset":7347},"end":{"line":261,"column":88,"offset":7430},"indent":[]}}],"position":{"start":{"line":261,"column":5,"offset":7347},"end":{"line":261,"column":88,"offset":7430},"indent":[]}}],"position":{"start":{"line":261,"column":3,"offset":7345},"end":{"line":261,"column":88,"offset":7430},"indent":[]}}],"position":{"start":{"line":261,"column":3,"offset":7345},"end":{"line":261,"column":88,"offset":7430},"indent":[]}}],"position":{"start":{"line":260,"column":1,"offset":7291},"end":{"line":261,"column":88,"offset":7430},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Service Users are ","position":{"start":{"line":262,"column":3,"offset":7433},"end":{"line":262,"column":21,"offset":7451},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"specific to a namespace","position":{"start":{"line":262,"column":23,"offset":7453},"end":{"line":262,"column":46,"offset":7476},"indent":[]}}],"position":{"start":{"line":262,"column":21,"offset":7451},"end":{"line":262,"column":48,"offset":7478},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":262,"column":48,"offset":7478},"end":{"line":262,"column":49,"offset":7479},"indent":[]}}],"position":{"start":{"line":262,"column":3,"offset":7433},"end":{"line":262,"column":49,"offset":7479},"indent":[]}}],"position":{"start":{"line":262,"column":1,"offset":7431},"end":{"line":262,"column":49,"offset":7479},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"They are created automatically by the API or manually using ","position":{"start":{"line":263,"column":3,"offset":7482},"end":{"line":263,"column":63,"offset":7542},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"objects","position":{"start":{"line":263,"column":65,"offset":7544},"end":{"line":263,"column":72,"offset":7551},"indent":[]}}],"position":{"start":{"line":263,"column":63,"offset":7542},"end":{"line":263,"column":74,"offset":7553},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":263,"column":74,"offset":7553},"end":{"line":263,"column":75,"offset":7554},"indent":[]}}],"position":{"start":{"line":263,"column":3,"offset":7482},"end":{"line":263,"column":75,"offset":7554},"indent":[]}}],"position":{"start":{"line":263,"column":1,"offset":7480},"end":{"line":263,"column":75,"offset":7554},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Any API call ","position":{"start":{"line":264,"column":3,"offset":7557},"end":{"line":264,"column":16,"offset":7570},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"not authenticated","position":{"start":{"line":264,"column":18,"offset":7572},"end":{"line":264,"column":35,"offset":7589},"indent":[]}}],"position":{"start":{"line":264,"column":16,"offset":7570},"end":{"line":264,"column":37,"offset":7591},"indent":[]}},{"type":"text","value":" is considered as an ","position":{"start":{"line":264,"column":37,"offset":7591},"end":{"line":264,"column":58,"offset":7612},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"anonymous","position":{"start":{"line":264,"column":60,"offset":7614},"end":{"line":264,"column":69,"offset":7623},"indent":[]}}],"position":{"start":{"line":264,"column":58,"offset":7612},"end":{"line":264,"column":71,"offset":7625},"indent":[]}},{"type":"text","value":" user.","position":{"start":{"line":264,"column":71,"offset":7625},"end":{"line":264,"column":77,"offset":7631},"indent":[]}}],"position":{"start":{"line":264,"column":3,"offset":7557},"end":{"line":264,"column":77,"offset":7631},"indent":[]}}],"position":{"start":{"line":264,"column":1,"offset":7555},"end":{"line":264,"column":77,"offset":7631},"indent":[]}}],"position":{"start":{"line":259,"column":1,"offset":7237},"end":{"line":264,"column":77,"offset":7631},"indent":[1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Other notes on User Management","position":{"start":{"line":266,"column":5,"offset":7637},"end":{"line":266,"column":35,"offset":7667},"indent":[]}}],"position":{"start":{"line":266,"column":1,"offset":7633},"end":{"line":266,"column":35,"offset":7667},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Auth is still a work in progress. The demo itself shows the creation of a asymmetric key and updating Minikube to allow that as the user.","position":{"start":{"line":268,"column":1,"offset":7669},"end":{"line":268,"column":138,"offset":7806},"indent":[]}}],"position":{"start":{"line":268,"column":1,"offset":7669},"end":{"line":268,"column":138,"offset":7806},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.4 RBAC (Role Based Access Control)","position":{"start":{"line":270,"column":4,"offset":7811},"end":{"line":270,"column":40,"offset":7847},"indent":[]}}],"position":{"start":{"line":270,"column":1,"offset":7808},"end":{"line":270,"column":40,"offset":7847},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Regulates access using ","position":{"start":{"line":272,"column":3,"offset":7851},"end":{"line":272,"column":26,"offset":7874},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"roles","position":{"start":{"line":272,"column":28,"offset":7876},"end":{"line":272,"column":33,"offset":7881},"indent":[]}}],"position":{"start":{"line":272,"column":26,"offset":7874},"end":{"line":272,"column":35,"offset":7883},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":272,"column":35,"offset":7883},"end":{"line":272,"column":36,"offset":7884},"indent":[]}}],"position":{"start":{"line":272,"column":3,"offset":7851},"end":{"line":272,"column":36,"offset":7884},"indent":[]}}],"position":{"start":{"line":272,"column":1,"offset":7849},"end":{"line":272,"column":36,"offset":7884},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Allows admins to dynamically configure permission policies.","position":{"start":{"line":273,"column":3,"offset":7887},"end":{"line":273,"column":62,"offset":7946},"indent":[]}}],"position":{"start":{"line":273,"column":3,"offset":7887},"end":{"line":273,"column":62,"offset":7946},"indent":[]}}],"position":{"start":{"line":273,"column":1,"offset":7885},"end":{"line":273,"column":62,"offset":7946},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"This is what I'll use in the demo.","position":{"start":{"line":274,"column":3,"offset":7949},"end":{"line":274,"column":37,"offset":7983},"indent":[]}}],"position":{"start":{"line":274,"column":3,"offset":7949},"end":{"line":274,"column":37,"offset":7983},"indent":[]}}],"position":{"start":{"line":274,"column":1,"offset":7947},"end":{"line":274,"column":37,"offset":7983},"indent":[]}}],"position":{"start":{"line":272,"column":1,"offset":7849},"end":{"line":274,"column":37,"offset":7983},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"You add RBAC resources with ","position":{"start":{"line":276,"column":1,"offset":7985},"end":{"line":276,"column":29,"offset":8013},"indent":[]}},{"type":"inlineCode","value":"kubectl","position":{"start":{"line":276,"column":29,"offset":8013},"end":{"line":276,"column":38,"offset":8022},"indent":[]}},{"type":"text","value":" from a yaml format file.","position":{"start":{"line":276,"column":38,"offset":8022},"end":{"line":276,"column":63,"offset":8047},"indent":[]}}],"position":{"start":{"line":276,"column":1,"offset":7985},"end":{"line":276,"column":63,"offset":8047},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"First, define a role, then assign users/groups to that role.","position":{"start":{"line":278,"column":1,"offset":8049},"end":{"line":278,"column":61,"offset":8109},"indent":[]}}],"position":{"start":{"line":278,"column":1,"offset":8049},"end":{"line":278,"column":61,"offset":8109},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can create roles limited to a namespace or that applies across all namespaces.","position":{"start":{"line":280,"column":1,"offset":8111},"end":{"line":280,"column":83,"offset":8193},"indent":[]}}],"position":{"start":{"line":280,"column":1,"offset":8111},"end":{"line":280,"column":83,"offset":8193},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Role","position":{"start":{"line":282,"column":5,"offset":8199},"end":{"line":282,"column":9,"offset":8203},"indent":[]}}],"position":{"start":{"line":282,"column":3,"offset":8197},"end":{"line":282,"column":11,"offset":8205},"indent":[]}},{"type":"text","value":" (single namespace) and ","position":{"start":{"line":282,"column":11,"offset":8205},"end":{"line":282,"column":35,"offset":8229},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"ClusterRole","position":{"start":{"line":282,"column":37,"offset":8231},"end":{"line":282,"column":48,"offset":8242},"indent":[]}}],"position":{"start":{"line":282,"column":35,"offset":8229},"end":{"line":282,"column":50,"offset":8244},"indent":[]}},{"type":"text","value":" (cluster-wide).","position":{"start":{"line":282,"column":50,"offset":8244},"end":{"line":282,"column":66,"offset":8260},"indent":[]}}],"position":{"start":{"line":282,"column":3,"offset":8197},"end":{"line":282,"column":66,"offset":8260},"indent":[]}}],"position":{"start":{"line":282,"column":1,"offset":8195},"end":{"line":282,"column":66,"offset":8260},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"RoleBinding","position":{"start":{"line":283,"column":5,"offset":8265},"end":{"line":283,"column":16,"offset":8276},"indent":[]}}],"position":{"start":{"line":283,"column":3,"offset":8263},"end":{"line":283,"column":18,"offset":8278},"indent":[]}},{"type":"text","value":" (single namespace) and ","position":{"start":{"line":283,"column":18,"offset":8278},"end":{"line":283,"column":42,"offset":8302},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"ClusterRoleBinding","position":{"start":{"line":283,"column":44,"offset":8304},"end":{"line":283,"column":62,"offset":8322},"indent":[]}}],"position":{"start":{"line":283,"column":42,"offset":8302},"end":{"line":283,"column":64,"offset":8324},"indent":[]}},{"type":"text","value":" (cluster-wide).","position":{"start":{"line":283,"column":64,"offset":8324},"end":{"line":283,"column":80,"offset":8340},"indent":[]}}],"position":{"start":{"line":283,"column":3,"offset":8263},"end":{"line":283,"column":80,"offset":8340},"indent":[]}}],"position":{"start":{"line":283,"column":1,"offset":8261},"end":{"line":283,"column":80,"offset":8340},"indent":[]}}],"position":{"start":{"line":282,"column":1,"offset":8195},"end":{"line":283,"column":80,"offset":8340},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.5 Networking","position":{"start":{"line":285,"column":4,"offset":8345},"end":{"line":285,"column":18,"offset":8359},"indent":[]}}],"position":{"start":{"line":285,"column":1,"offset":8342},"end":{"line":285,"column":18,"offset":8359},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Communication topics already covered:","position":{"start":{"line":287,"column":1,"offset":8361},"end":{"line":287,"column":38,"offset":8398},"indent":[]}}],"position":{"start":{"line":287,"column":1,"offset":8361},"end":{"line":287,"column":38,"offset":8398},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Container to container: communication within a pod.","position":{"start":{"line":289,"column":3,"offset":8402},"end":{"line":289,"column":54,"offset":8453},"indent":[]}}],"position":{"start":{"line":289,"column":3,"offset":8402},"end":{"line":289,"column":54,"offset":8453},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Through ","position":{"start":{"line":290,"column":5,"offset":8458},"end":{"line":290,"column":13,"offset":8466},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"localhost","position":{"start":{"line":290,"column":15,"offset":8468},"end":{"line":290,"column":24,"offset":8477},"indent":[]}}],"position":{"start":{"line":290,"column":13,"offset":8466},"end":{"line":290,"column":26,"offset":8479},"indent":[]}},{"type":"text","value":" and the ","position":{"start":{"line":290,"column":26,"offset":8479},"end":{"line":290,"column":35,"offset":8488},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"port number","position":{"start":{"line":290,"column":37,"offset":8490},"end":{"line":290,"column":48,"offset":8501},"indent":[]}}],"position":{"start":{"line":290,"column":35,"offset":8488},"end":{"line":290,"column":50,"offset":8503},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":290,"column":50,"offset":8503},"end":{"line":290,"column":51,"offset":8504},"indent":[]}}],"position":{"start":{"line":290,"column":5,"offset":8458},"end":{"line":290,"column":51,"offset":8504},"indent":[]}}],"position":{"start":{"line":290,"column":3,"offset":8456},"end":{"line":290,"column":51,"offset":8504},"indent":[]}}],"position":{"start":{"line":290,"column":3,"offset":8456},"end":{"line":290,"column":51,"offset":8504},"indent":[]}}],"position":{"start":{"line":289,"column":1,"offset":8400},"end":{"line":290,"column":51,"offset":8504},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Pod-To-Service comms","position":{"start":{"line":291,"column":3,"offset":8507},"end":{"line":291,"column":23,"offset":8527},"indent":[]}}],"position":{"start":{"line":291,"column":3,"offset":8507},"end":{"line":291,"column":23,"offset":8527},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Using ","position":{"start":{"line":292,"column":5,"offset":8532},"end":{"line":292,"column":11,"offset":8538},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"NodePort","position":{"start":{"line":292,"column":13,"offset":8540},"end":{"line":292,"column":21,"offset":8548},"indent":[]}}],"position":{"start":{"line":292,"column":11,"offset":8538},"end":{"line":292,"column":23,"offset":8550},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":292,"column":23,"offset":8550},"end":{"line":292,"column":28,"offset":8555},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"DNS","position":{"start":{"line":292,"column":30,"offset":8557},"end":{"line":292,"column":33,"offset":8560},"indent":[]}}],"position":{"start":{"line":292,"column":28,"offset":8555},"end":{"line":292,"column":35,"offset":8562},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":292,"column":35,"offset":8562},"end":{"line":292,"column":36,"offset":8563},"indent":[]}}],"position":{"start":{"line":292,"column":5,"offset":8532},"end":{"line":292,"column":36,"offset":8563},"indent":[]}}],"position":{"start":{"line":292,"column":3,"offset":8530},"end":{"line":292,"column":36,"offset":8563},"indent":[]}}],"position":{"start":{"line":292,"column":3,"offset":8530},"end":{"line":292,"column":36,"offset":8563},"indent":[]}}],"position":{"start":{"line":291,"column":1,"offset":8505},"end":{"line":292,"column":36,"offset":8563},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"External-To-Service","position":{"start":{"line":293,"column":3,"offset":8566},"end":{"line":293,"column":22,"offset":8585},"indent":[]}}],"position":{"start":{"line":293,"column":3,"offset":8566},"end":{"line":293,"column":22,"offset":8585},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Using ","position":{"start":{"line":294,"column":5,"offset":8590},"end":{"line":294,"column":11,"offset":8596},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"LoadBalancer","position":{"start":{"line":294,"column":13,"offset":8598},"end":{"line":294,"column":25,"offset":8610},"indent":[]}}],"position":{"start":{"line":294,"column":11,"offset":8596},"end":{"line":294,"column":27,"offset":8612},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":294,"column":27,"offset":8612},"end":{"line":294,"column":29,"offset":8614},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"NodePort","position":{"start":{"line":294,"column":31,"offset":8616},"end":{"line":294,"column":39,"offset":8624},"indent":[]}}],"position":{"start":{"line":294,"column":29,"offset":8614},"end":{"line":294,"column":41,"offset":8626},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":294,"column":41,"offset":8626},"end":{"line":294,"column":42,"offset":8627},"indent":[]}}],"position":{"start":{"line":294,"column":5,"offset":8590},"end":{"line":294,"column":42,"offset":8627},"indent":[]}}],"position":{"start":{"line":294,"column":3,"offset":8588},"end":{"line":294,"column":42,"offset":8627},"indent":[]}}],"position":{"start":{"line":294,"column":3,"offset":8588},"end":{"line":294,"column":42,"offset":8627},"indent":[]}}],"position":{"start":{"line":293,"column":1,"offset":8564},"end":{"line":294,"column":42,"offset":8627},"indent":[1]}}],"position":{"start":{"line":289,"column":1,"offset":8400},"end":{"line":294,"column":42,"offset":8627},"indent":[1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Pods","position":{"start":{"line":296,"column":5,"offset":8633},"end":{"line":296,"column":9,"offset":8637},"indent":[]}}],"position":{"start":{"line":296,"column":1,"offset":8629},"end":{"line":296,"column":9,"offset":8637},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The pod should always be routable.","position":{"start":{"line":298,"column":3,"offset":8641},"end":{"line":298,"column":37,"offset":8675},"indent":[]}}],"position":{"start":{"line":298,"column":3,"offset":8641},"end":{"line":298,"column":37,"offset":8675},"indent":[]}}],"position":{"start":{"line":298,"column":1,"offset":8639},"end":{"line":298,"column":37,"offset":8675},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Kubernetes assumes that pods should be able to communicate to other pods, regardless of which node they are running.","position":{"start":{"line":299,"column":3,"offset":8678},"end":{"line":299,"column":119,"offset":8794},"indent":[]}}],"position":{"start":{"line":299,"column":3,"offset":8678},"end":{"line":299,"column":119,"offset":8794},"indent":[]}}],"position":{"start":{"line":299,"column":1,"offset":8676},"end":{"line":299,"column":119,"offset":8794},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Kubernetes assumes that pods should be able to communicate to other pods, regardless of which node they are running.","position":{"start":{"line":300,"column":3,"offset":8797},"end":{"line":300,"column":119,"offset":8913},"indent":[]}}],"position":{"start":{"line":300,"column":3,"offset":8797},"end":{"line":300,"column":119,"offset":8913},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Every pod has its ","position":{"start":{"line":301,"column":5,"offset":8918},"end":{"line":301,"column":23,"offset":8936},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"own IP address","position":{"start":{"line":301,"column":25,"offset":8938},"end":{"line":301,"column":39,"offset":8952},"indent":[]}}],"position":{"start":{"line":301,"column":23,"offset":8936},"end":{"line":301,"column":41,"offset":8954},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":301,"column":41,"offset":8954},"end":{"line":301,"column":42,"offset":8955},"indent":[]}}],"position":{"start":{"line":301,"column":5,"offset":8918},"end":{"line":301,"column":42,"offset":8955},"indent":[]}}],"position":{"start":{"line":301,"column":3,"offset":8916},"end":{"line":301,"column":42,"offset":8955},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Pods on different nodes need to be able to communicate to each other using those IP addresses.","position":{"start":{"line":302,"column":5,"offset":8960},"end":{"line":302,"column":99,"offset":9054},"indent":[]}}],"position":{"start":{"line":302,"column":5,"offset":8960},"end":{"line":302,"column":99,"offset":9054},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"This is implemented differently depending on your networking setup.","position":{"start":{"line":303,"column":7,"offset":9061},"end":{"line":303,"column":74,"offset":9128},"indent":[]}}],"position":{"start":{"line":303,"column":7,"offset":9061},"end":{"line":303,"column":74,"offset":9128},"indent":[]}}],"position":{"start":{"line":303,"column":5,"offset":9059},"end":{"line":303,"column":74,"offset":9128},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"On AWS: kubenet networking (kops default).","position":{"start":{"line":304,"column":7,"offset":9135},"end":{"line":304,"column":49,"offset":9177},"indent":[]}}],"position":{"start":{"line":304,"column":7,"offset":9135},"end":{"line":304,"column":49,"offset":9177},"indent":[]}}],"position":{"start":{"line":304,"column":5,"offset":9133},"end":{"line":304,"column":49,"offset":9177},"indent":[]}}],"position":{"start":{"line":303,"column":5,"offset":9059},"end":{"line":304,"column":49,"offset":9177},"indent":[5]}}],"position":{"start":{"line":302,"column":3,"offset":8958},"end":{"line":304,"column":49,"offset":9177},"indent":[3,3]}}],"position":{"start":{"line":301,"column":3,"offset":8916},"end":{"line":304,"column":49,"offset":9177},"indent":[3,3,3]}}],"position":{"start":{"line":300,"column":1,"offset":8795},"end":{"line":304,"column":49,"offset":9177},"indent":[1,1,1,1]}}],"position":{"start":{"line":298,"column":1,"offset":8639},"end":{"line":304,"column":49,"offset":9177},"indent":[1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Kubenet Networking","position":{"start":{"line":306,"column":5,"offset":9183},"end":{"line":306,"column":23,"offset":9201},"indent":[]}}],"position":{"start":{"line":306,"column":1,"offset":9179},"end":{"line":306,"column":23,"offset":9201},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Every pod can get an IP that is ","position":{"start":{"line":308,"column":3,"offset":9205},"end":{"line":308,"column":35,"offset":9237},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"routable","position":{"start":{"line":308,"column":37,"offset":9239},"end":{"line":308,"column":45,"offset":9247},"indent":[]}}],"position":{"start":{"line":308,"column":35,"offset":9237},"end":{"line":308,"column":47,"offset":9249},"indent":[]}},{"type":"text","value":" using the AWS Virtual Private Network (VPC).","position":{"start":{"line":308,"column":47,"offset":9249},"end":{"line":308,"column":92,"offset":9294},"indent":[]}}],"position":{"start":{"line":308,"column":3,"offset":9205},"end":{"line":308,"column":92,"offset":9294},"indent":[]}}],"position":{"start":{"line":308,"column":1,"offset":9203},"end":{"line":308,"column":92,"offset":9294},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The kubernetes master allocates a /24 subnet to each node (254 IP addresses).","position":{"start":{"line":309,"column":3,"offset":9297},"end":{"line":309,"column":80,"offset":9374},"indent":[]}}],"position":{"start":{"line":309,"column":3,"offset":9297},"end":{"line":309,"column":80,"offset":9374},"indent":[]}}],"position":{"start":{"line":309,"column":1,"offset":9295},"end":{"line":309,"column":80,"offset":9374},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The subnet is added to the VPCs route table.","position":{"start":{"line":310,"column":3,"offset":9377},"end":{"line":310,"column":47,"offset":9421},"indent":[]}}],"position":{"start":{"line":310,"column":3,"offset":9377},"end":{"line":310,"column":47,"offset":9421},"indent":[]}}],"position":{"start":{"line":310,"column":1,"offset":9375},"end":{"line":310,"column":47,"offset":9421},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"There is a limit of ","position":{"start":{"line":311,"column":3,"offset":9424},"end":{"line":311,"column":23,"offset":9444},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"50 entries","position":{"start":{"line":311,"column":25,"offset":9446},"end":{"line":311,"column":35,"offset":9456},"indent":[]}}],"position":{"start":{"line":311,"column":23,"offset":9444},"end":{"line":311,"column":37,"offset":9458},"indent":[]}},{"type":"text","value":", which means you can't have more than 50 nodes in a single AWS cluster.","position":{"start":{"line":311,"column":37,"offset":9458},"end":{"line":311,"column":109,"offset":9530},"indent":[]}}],"position":{"start":{"line":311,"column":3,"offset":9424},"end":{"line":311,"column":109,"offset":9530},"indent":[]}}],"position":{"start":{"line":311,"column":1,"offset":9422},"end":{"line":311,"column":109,"offset":9530},"indent":[]}}],"position":{"start":{"line":308,"column":1,"offset":9203},"end":{"line":311,"column":109,"offset":9530},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"VPC Alternatives","position":{"start":{"line":313,"column":5,"offset":9536},"end":{"line":313,"column":21,"offset":9552},"indent":[]}}],"position":{"start":{"line":313,"column":1,"offset":9532},"end":{"line":313,"column":21,"offset":9552},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Not every cloud provider has VPC-tech (GCE and Azure do).","position":{"start":{"line":315,"column":1,"offset":9554},"end":{"line":315,"column":58,"offset":9611},"indent":[]}}],"position":{"start":{"line":315,"column":1,"offset":9554},"end":{"line":315,"column":58,"offset":9611},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The alternatives for things like on-prem etc are:","position":{"start":{"line":317,"column":1,"offset":9613},"end":{"line":317,"column":50,"offset":9662},"indent":[]}}],"position":{"start":{"line":317,"column":1,"offset":9613},"end":{"line":317,"column":50,"offset":9662},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":true,"children":[{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Container Network Interface (CNI)","position":{"start":{"line":319,"column":4,"offset":9667},"end":{"line":319,"column":37,"offset":9700},"indent":[]}}],"position":{"start":{"line":319,"column":4,"offset":9667},"end":{"line":319,"column":37,"offset":9700},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":true,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Software that provides libraries/plugins for network interfaces within containers.","position":{"start":{"line":321,"column":6,"offset":9707},"end":{"line":321,"column":88,"offset":9789},"indent":[]}}],"position":{"start":{"line":321,"column":6,"offset":9707},"end":{"line":321,"column":88,"offset":9789},"indent":[]}}],"position":{"start":{"line":321,"column":4,"offset":9705},"end":{"line":322,"column":1,"offset":9790},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Popular solutions are ","position":{"start":{"line":323,"column":6,"offset":9796},"end":{"line":323,"column":28,"offset":9818},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Calico, Weave","position":{"start":{"line":323,"column":30,"offset":9820},"end":{"line":323,"column":43,"offset":9833},"indent":[]}}],"position":{"start":{"line":323,"column":28,"offset":9818},"end":{"line":323,"column":45,"offset":9835},"indent":[]}},{"type":"text","value":" (standalone or with CNI).","position":{"start":{"line":323,"column":45,"offset":9835},"end":{"line":323,"column":71,"offset":9861},"indent":[]}}],"position":{"start":{"line":323,"column":6,"offset":9796},"end":{"line":323,"column":71,"offset":9861},"indent":[]}}],"position":{"start":{"line":323,"column":4,"offset":9794},"end":{"line":323,"column":71,"offset":9861},"indent":[]}}],"position":{"start":{"line":321,"column":4,"offset":9705},"end":{"line":323,"column":71,"offset":9861},"indent":[1,4]}}],"position":{"start":{"line":319,"column":1,"offset":9664},"end":{"line":324,"column":1,"offset":9862},"indent":[1,1,1,1,1]}},{"type":"listItem","spread":true,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"An Overlay Network","position":{"start":{"line":325,"column":4,"offset":9866},"end":{"line":325,"column":22,"offset":9884},"indent":[]}}],"position":{"start":{"line":325,"column":4,"offset":9866},"end":{"line":325,"column":22,"offset":9884},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Flannel","position":{"start":{"line":327,"column":8,"offset":9893},"end":{"line":327,"column":15,"offset":9900},"indent":[]}}],"position":{"start":{"line":327,"column":6,"offset":9891},"end":{"line":327,"column":17,"offset":9902},"indent":[]}},{"type":"text","value":" is an easy and popular way.","position":{"start":{"line":327,"column":17,"offset":9902},"end":{"line":327,"column":45,"offset":9930},"indent":[]}}],"position":{"start":{"line":327,"column":6,"offset":9891},"end":{"line":327,"column":45,"offset":9930},"indent":[]}}],"position":{"start":{"line":327,"column":4,"offset":9889},"end":{"line":327,"column":45,"offset":9930},"indent":[]}}],"position":{"start":{"line":327,"column":4,"offset":9889},"end":{"line":327,"column":45,"offset":9930},"indent":[]}}],"position":{"start":{"line":325,"column":1,"offset":9863},"end":{"line":327,"column":45,"offset":9930},"indent":[1,1]}}],"position":{"start":{"line":319,"column":1,"offset":9664},"end":{"line":327,"column":45,"offset":9930},"indent":[1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.6 Node Maintenance","position":{"start":{"line":329,"column":4,"offset":9935},"end":{"line":329,"column":24,"offset":9955},"indent":[]}}],"position":{"start":{"line":329,"column":1,"offset":9932},"end":{"line":329,"column":24,"offset":9955},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"It is the ","position":{"start":{"line":331,"column":1,"offset":9957},"end":{"line":331,"column":11,"offset":9967},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Node Controller","position":{"start":{"line":331,"column":13,"offset":9969},"end":{"line":331,"column":28,"offset":9984},"indent":[]}}],"position":{"start":{"line":331,"column":11,"offset":9967},"end":{"line":331,"column":30,"offset":9986},"indent":[]}},{"type":"text","value":" that is responsible for managing the Node object.","position":{"start":{"line":331,"column":30,"offset":9986},"end":{"line":331,"column":80,"offset":10036},"indent":[]}}],"position":{"start":{"line":331,"column":1,"offset":9957},"end":{"line":331,"column":80,"offset":10036},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"It assigns ","position":{"start":{"line":333,"column":3,"offset":10040},"end":{"line":333,"column":14,"offset":10051},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"IP Space","position":{"start":{"line":333,"column":16,"offset":10053},"end":{"line":333,"column":24,"offset":10061},"indent":[]}}],"position":{"start":{"line":333,"column":14,"offset":10051},"end":{"line":333,"column":26,"offset":10063},"indent":[]}},{"type":"text","value":" to the node when a new node is launched.","position":{"start":{"line":333,"column":26,"offset":10063},"end":{"line":333,"column":67,"offset":10104},"indent":[]}}],"position":{"start":{"line":333,"column":3,"offset":10040},"end":{"line":333,"column":67,"offset":10104},"indent":[]}}],"position":{"start":{"line":333,"column":1,"offset":10038},"end":{"line":333,"column":67,"offset":10104},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"It keeps the ","position":{"start":{"line":334,"column":3,"offset":10107},"end":{"line":334,"column":16,"offset":10120},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"node list","position":{"start":{"line":334,"column":18,"offset":10122},"end":{"line":334,"column":27,"offset":10131},"indent":[]}}],"position":{"start":{"line":334,"column":16,"offset":10120},"end":{"line":334,"column":29,"offset":10133},"indent":[]}},{"type":"text","value":" up to date with the available machines.","position":{"start":{"line":334,"column":29,"offset":10133},"end":{"line":334,"column":69,"offset":10173},"indent":[]}}],"position":{"start":{"line":334,"column":3,"offset":10107},"end":{"line":334,"column":69,"offset":10173},"indent":[]}}],"position":{"start":{"line":334,"column":1,"offset":10105},"end":{"line":334,"column":69,"offset":10173},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The node controller is also monitoring the ","position":{"start":{"line":335,"column":3,"offset":10176},"end":{"line":335,"column":46,"offset":10219},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"health of the node","position":{"start":{"line":335,"column":48,"offset":10221},"end":{"line":335,"column":66,"offset":10239},"indent":[]}}],"position":{"start":{"line":335,"column":46,"offset":10219},"end":{"line":335,"column":68,"offset":10241},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":335,"column":68,"offset":10241},"end":{"line":335,"column":69,"offset":10242},"indent":[]}}],"position":{"start":{"line":335,"column":3,"offset":10176},"end":{"line":335,"column":69,"offset":10242},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If a node is ","position":{"start":{"line":336,"column":5,"offset":10247},"end":{"line":336,"column":18,"offset":10260},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"unhealthy it gets deleted","position":{"start":{"line":336,"column":20,"offset":10262},"end":{"line":336,"column":45,"offset":10287},"indent":[]}}],"position":{"start":{"line":336,"column":18,"offset":10260},"end":{"line":336,"column":47,"offset":10289},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":336,"column":47,"offset":10289},"end":{"line":336,"column":48,"offset":10290},"indent":[]}}],"position":{"start":{"line":336,"column":5,"offset":10247},"end":{"line":336,"column":48,"offset":10290},"indent":[]}}],"position":{"start":{"line":336,"column":3,"offset":10245},"end":{"line":336,"column":48,"offset":10290},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Pods running on the unhealthy node will then get ","position":{"start":{"line":337,"column":5,"offset":10295},"end":{"line":337,"column":54,"offset":10344},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"rescheduled","position":{"start":{"line":337,"column":56,"offset":10346},"end":{"line":337,"column":67,"offset":10357},"indent":[]}}],"position":{"start":{"line":337,"column":54,"offset":10344},"end":{"line":337,"column":69,"offset":10359},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":337,"column":69,"offset":10359},"end":{"line":337,"column":70,"offset":10360},"indent":[]}}],"position":{"start":{"line":337,"column":5,"offset":10295},"end":{"line":337,"column":70,"offset":10360},"indent":[]}}],"position":{"start":{"line":337,"column":3,"offset":10293},"end":{"line":337,"column":70,"offset":10360},"indent":[]}}],"position":{"start":{"line":336,"column":3,"offset":10245},"end":{"line":337,"column":70,"offset":10360},"indent":[3]}}],"position":{"start":{"line":335,"column":1,"offset":10174},"end":{"line":337,"column":70,"offset":10360},"indent":[1,1]}}],"position":{"start":{"line":333,"column":1,"offset":10038},"end":{"line":337,"column":70,"offset":10360},"indent":[1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Adding a new node","position":{"start":{"line":339,"column":5,"offset":10366},"end":{"line":339,"column":22,"offset":10383},"indent":[]}}],"position":{"start":{"line":339,"column":1,"offset":10362},"end":{"line":339,"column":22,"offset":10383},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When adding a new node, the ","position":{"start":{"line":341,"column":1,"offset":10385},"end":{"line":341,"column":29,"offset":10413},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"kubelet","position":{"start":{"line":341,"column":31,"offset":10415},"end":{"line":341,"column":38,"offset":10422},"indent":[]}}],"position":{"start":{"line":341,"column":29,"offset":10413},"end":{"line":341,"column":40,"offset":10424},"indent":[]}},{"type":"text","value":" will attempt to register itself. This is called ","position":{"start":{"line":341,"column":40,"offset":10424},"end":{"line":341,"column":89,"offset":10473},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"self-registration","position":{"start":{"line":341,"column":91,"offset":10475},"end":{"line":341,"column":108,"offset":10492},"indent":[]}}],"position":{"start":{"line":341,"column":89,"offset":10473},"end":{"line":341,"column":110,"offset":10494},"indent":[]}},{"type":"text","value":" and is the default behaviour.","position":{"start":{"line":341,"column":110,"offset":10494},"end":{"line":341,"column":140,"offset":10524},"indent":[]}}],"position":{"start":{"line":341,"column":1,"offset":10385},"end":{"line":341,"column":140,"offset":10524},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"It allows you to ","position":{"start":{"line":343,"column":3,"offset":10528},"end":{"line":343,"column":20,"offset":10545},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"easily add more nodes","position":{"start":{"line":343,"column":22,"offset":10547},"end":{"line":343,"column":43,"offset":10568},"indent":[]}}],"position":{"start":{"line":343,"column":20,"offset":10545},"end":{"line":343,"column":45,"offset":10570},"indent":[]}},{"type":"text","value":" to the cluster without making API changes yourself.","position":{"start":{"line":343,"column":45,"offset":10570},"end":{"line":343,"column":97,"offset":10622},"indent":[]}}],"position":{"start":{"line":343,"column":3,"offset":10528},"end":{"line":343,"column":97,"offset":10622},"indent":[]}}],"position":{"start":{"line":343,"column":1,"offset":10526},"end":{"line":343,"column":97,"offset":10622},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A new node object is ","position":{"start":{"line":344,"column":3,"offset":10625},"end":{"line":344,"column":24,"offset":10646},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"automatically","position":{"start":{"line":344,"column":26,"offset":10648},"end":{"line":344,"column":39,"offset":10661},"indent":[]}}],"position":{"start":{"line":344,"column":24,"offset":10646},"end":{"line":344,"column":41,"offset":10663},"indent":[]}},{"type":"text","value":" created with:","position":{"start":{"line":344,"column":41,"offset":10663},"end":{"line":344,"column":55,"offset":10677},"indent":[]}}],"position":{"start":{"line":344,"column":3,"offset":10625},"end":{"line":344,"column":55,"offset":10677},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The metadata (with a name: IP or hostname).","position":{"start":{"line":345,"column":5,"offset":10682},"end":{"line":345,"column":48,"offset":10725},"indent":[]}}],"position":{"start":{"line":345,"column":5,"offset":10682},"end":{"line":345,"column":48,"offset":10725},"indent":[]}}],"position":{"start":{"line":345,"column":3,"offset":10680},"end":{"line":345,"column":48,"offset":10725},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Labels (e.g. cloud region / availability zone / instance size).","position":{"start":{"line":346,"column":5,"offset":10730},"end":{"line":346,"column":68,"offset":10793},"indent":[]}}],"position":{"start":{"line":346,"column":5,"offset":10730},"end":{"line":346,"column":68,"offset":10793},"indent":[]}}],"position":{"start":{"line":346,"column":3,"offset":10728},"end":{"line":346,"column":68,"offset":10793},"indent":[]}}],"position":{"start":{"line":345,"column":3,"offset":10680},"end":{"line":346,"column":68,"offset":10793},"indent":[3]}}],"position":{"start":{"line":344,"column":1,"offset":10623},"end":{"line":346,"column":68,"offset":10793},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Has ","position":{"start":{"line":347,"column":3,"offset":10796},"end":{"line":347,"column":7,"offset":10800},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"node condition","position":{"start":{"line":347,"column":9,"offset":10802},"end":{"line":347,"column":23,"offset":10816},"indent":[]}}],"position":{"start":{"line":347,"column":7,"offset":10800},"end":{"line":347,"column":25,"offset":10818},"indent":[]}},{"type":"text","value":" (e.g. Ready, OutOfDisk).","position":{"start":{"line":347,"column":25,"offset":10818},"end":{"line":347,"column":50,"offset":10843},"indent":[]}}],"position":{"start":{"line":347,"column":3,"offset":10796},"end":{"line":347,"column":50,"offset":10843},"indent":[]}}],"position":{"start":{"line":347,"column":1,"offset":10794},"end":{"line":347,"column":50,"offset":10843},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"When you want to ","position":{"start":{"line":348,"column":3,"offset":10846},"end":{"line":348,"column":20,"offset":10863},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"decomission","position":{"start":{"line":348,"column":22,"offset":10865},"end":{"line":348,"column":33,"offset":10876},"indent":[]}}],"position":{"start":{"line":348,"column":20,"offset":10863},"end":{"line":348,"column":35,"offset":10878},"indent":[]}},{"type":"text","value":" a node, you want to do it gracefully.","position":{"start":{"line":348,"column":35,"offset":10878},"end":{"line":348,"column":73,"offset":10916},"indent":[]}}],"position":{"start":{"line":348,"column":3,"offset":10846},"end":{"line":348,"column":73,"offset":10916},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Drain a node before you shut it down or take it out of the cluster.","position":{"start":{"line":349,"column":5,"offset":10921},"end":{"line":349,"column":72,"offset":10988},"indent":[]}}],"position":{"start":{"line":349,"column":5,"offset":10921},"end":{"line":349,"column":72,"offset":10988},"indent":[]}}],"position":{"start":{"line":349,"column":3,"offset":10919},"end":{"line":349,"column":72,"offset":10988},"indent":[]}}],"position":{"start":{"line":349,"column":3,"offset":10919},"end":{"line":349,"column":72,"offset":10988},"indent":[]}}],"position":{"start":{"line":348,"column":1,"offset":10844},"end":{"line":349,"column":72,"offset":10988},"indent":[1]}}],"position":{"start":{"line":343,"column":1,"offset":10526},"end":{"line":349,"column":72,"offset":10988},"indent":[1,1,1,1,1,1]}},{"type":"code","lang":"bash","meta":null,"value":"# drain a node\n$ kubectl drain nodename --grace-period=600\n\n# if node runs pods not managed by a controller but just a single pod\n$ kubectl drain nodename --force","position":{"start":{"line":351,"column":1,"offset":10990},"end":{"line":357,"column":4,"offset":11164},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://res.cloudinary.com/gitgoodclub/image/upload/v1540183374/Screen_Shot_2018-10-22_at_3.42.29_pm.png","alt":"Terminal draining","position":{"start":{"line":359,"column":1,"offset":11166},"end":{"line":359,"column":127,"offset":11292},"indent":[]}}],"position":{"start":{"line":359,"column":1,"offset":11166},"end":{"line":359,"column":127,"offset":11292},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.7 High Availability","position":{"start":{"line":361,"column":4,"offset":11297},"end":{"line":361,"column":25,"offset":11318},"indent":[]}}],"position":{"start":{"line":361,"column":1,"offset":11294},"end":{"line":361,"column":25,"offset":11318},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you are running in prod, you willwant all master services in ","position":{"start":{"line":363,"column":1,"offset":11320},"end":{"line":363,"column":65,"offset":11384},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"high availability","position":{"start":{"line":363,"column":67,"offset":11386},"end":{"line":363,"column":84,"offset":11403},"indent":[]}}],"position":{"start":{"line":363,"column":65,"offset":11384},"end":{"line":363,"column":86,"offset":11405},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":363,"column":86,"offset":11405},"end":{"line":363,"column":87,"offset":11406},"indent":[]}}],"position":{"start":{"line":363,"column":1,"offset":11320},"end":{"line":363,"column":87,"offset":11406},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Setup","position":{"start":{"line":365,"column":5,"offset":11412},"end":{"line":365,"column":10,"offset":11417},"indent":[]}}],"position":{"start":{"line":365,"column":1,"offset":11408},"end":{"line":365,"column":10,"offset":11417},"indent":[]}},{"type":"list","ordered":true,"start":1,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Clustering etcd:","position":{"start":{"line":367,"column":6,"offset":11424},"end":{"line":367,"column":22,"offset":11440},"indent":[]}}],"position":{"start":{"line":367,"column":4,"offset":11422},"end":{"line":367,"column":24,"offset":11442},"indent":[]}},{"type":"text","value":" at least run 3 etcd nodes.","position":{"start":{"line":367,"column":24,"offset":11442},"end":{"line":367,"column":51,"offset":11469},"indent":[]}}],"position":{"start":{"line":367,"column":4,"offset":11422},"end":{"line":367,"column":51,"offset":11469},"indent":[]}}],"position":{"start":{"line":367,"column":1,"offset":11419},"end":{"line":367,"column":51,"offset":11469},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Replicated API servers:","position":{"start":{"line":368,"column":6,"offset":11475},"end":{"line":368,"column":29,"offset":11498},"indent":[]}}],"position":{"start":{"line":368,"column":4,"offset":11473},"end":{"line":368,"column":31,"offset":11500},"indent":[]}},{"type":"text","value":" with a a LoadBalancer","position":{"start":{"line":368,"column":31,"offset":11500},"end":{"line":368,"column":53,"offset":11522},"indent":[]}}],"position":{"start":{"line":368,"column":4,"offset":11473},"end":{"line":368,"column":53,"offset":11522},"indent":[]}}],"position":{"start":{"line":368,"column":1,"offset":11470},"end":{"line":368,"column":53,"offset":11522},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Running multiple instances of the ","position":{"start":{"line":369,"column":4,"offset":11526},"end":{"line":369,"column":38,"offset":11560},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"scheduler","position":{"start":{"line":369,"column":40,"offset":11562},"end":{"line":369,"column":49,"offset":11571},"indent":[]}}],"position":{"start":{"line":369,"column":38,"offset":11560},"end":{"line":369,"column":51,"offset":11573},"indent":[]}},{"type":"text","value":" and the ","position":{"start":{"line":369,"column":51,"offset":11573},"end":{"line":369,"column":60,"offset":11582},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"controllers","position":{"start":{"line":369,"column":62,"offset":11584},"end":{"line":369,"column":73,"offset":11595},"indent":[]}}],"position":{"start":{"line":369,"column":60,"offset":11582},"end":{"line":369,"column":75,"offset":11597},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":369,"column":75,"offset":11597},"end":{"line":369,"column":76,"offset":11598},"indent":[]}}],"position":{"start":{"line":369,"column":4,"offset":11526},"end":{"line":369,"column":76,"offset":11598},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"only one of them will be the leader, the others are on stand-by.","position":{"start":{"line":370,"column":6,"offset":11604},"end":{"line":370,"column":70,"offset":11668},"indent":[]}}],"position":{"start":{"line":370,"column":6,"offset":11604},"end":{"line":370,"column":70,"offset":11668},"indent":[]}}],"position":{"start":{"line":370,"column":4,"offset":11602},"end":{"line":370,"column":70,"offset":11668},"indent":[]}}],"position":{"start":{"line":370,"column":4,"offset":11602},"end":{"line":370,"column":70,"offset":11668},"indent":[]}}],"position":{"start":{"line":369,"column":1,"offset":11523},"end":{"line":370,"column":70,"offset":11668},"indent":[1]}}],"position":{"start":{"line":367,"column":1,"offset":11419},"end":{"line":370,"column":70,"offset":11668},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://res.cloudinary.com/gitgoodclub/image/upload/v1540183580/Screen_Shot_2018-10-22_at_3.46.05_pm.png","alt":"HA Overview","position":{"start":{"line":372,"column":1,"offset":11670},"end":{"line":372,"column":121,"offset":11790},"indent":[]}}],"position":{"start":{"line":372,"column":1,"offset":11670},"end":{"line":372,"column":121,"offset":11790},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"https://res.cloudinary.com/gitgoodclub/image/upload/v1540183671/Screen_Shot_2018-10-22_at_3.46.52_pm.png","alt":"HA diagram","position":{"start":{"line":374,"column":1,"offset":11792},"end":{"line":374,"column":120,"offset":11911},"indent":[]}}],"position":{"start":{"line":374,"column":1,"offset":11792},"end":{"line":374,"column":120,"offset":11911},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Kops with multiple masters for HA","position":{"start":{"line":376,"column":5,"offset":11917},"end":{"line":376,"column":38,"offset":11950},"indent":[]}}],"position":{"start":{"line":376,"column":1,"offset":11913},"end":{"line":376,"column":38,"offset":11950},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"kops create cluster --name=... --zones=eu-west-1a,eu-west-1b,eu-west-1c --master-zones=eu-west-1a,eu-west-1b,eu-west-1c","position":{"start":{"line":378,"column":1,"offset":11952},"end":{"line":380,"column":4,"offset":12083},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This becomes more complex for volumes since EBS volumes are based within zones.","position":{"start":{"line":382,"column":1,"offset":12085},"end":{"line":382,"column":80,"offset":12164},"indent":[]}}],"position":{"start":{"line":382,"column":1,"offset":12085},"end":{"line":382,"column":80,"offset":12164},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"4.8 TLS on ELB using Annotations","position":{"start":{"line":384,"column":4,"offset":12169},"end":{"line":384,"column":36,"offset":12201},"indent":[]}}],"position":{"start":{"line":384,"column":1,"offset":12166},"end":{"line":384,"column":36,"offset":12201},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can setup ","position":{"start":{"line":386,"column":1,"offset":12203},"end":{"line":386,"column":15,"offset":12217},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"cloud specific features","position":{"start":{"line":386,"column":17,"offset":12219},"end":{"line":386,"column":40,"offset":12242},"indent":[]}}],"position":{"start":{"line":386,"column":15,"offset":12217},"end":{"line":386,"column":42,"offset":12244},"indent":[]}},{"type":"text","value":" (like TLS termination) on AWS LoadBalancers that you create in Kubernetes using services of type LoadBalancer.","position":{"start":{"line":386,"column":42,"offset":12244},"end":{"line":386,"column":153,"offset":12355},"indent":[]}}],"position":{"start":{"line":386,"column":1,"offset":12203},"end":{"line":386,"column":153,"offset":12355},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"You can do this using ","position":{"start":{"line":388,"column":1,"offset":12357},"end":{"line":388,"column":23,"offset":12379},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"annotations","position":{"start":{"line":388,"column":25,"offset":12381},"end":{"line":388,"column":36,"offset":12392},"indent":[]}}],"position":{"start":{"line":388,"column":23,"offset":12379},"end":{"line":388,"column":38,"offset":12394},"indent":[]}},{"type":"text","value":" to pass some flags for cloud configuration eg aws-load-balancer-ssl-cert, aws-load-balancer-backend-protocol etc.","position":{"start":{"line":388,"column":38,"offset":12394},"end":{"line":388,"column":152,"offset":12508},"indent":[]}}],"position":{"start":{"line":388,"column":1,"offset":12357},"end":{"line":388,"column":152,"offset":12508},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"# helloworld-elb-tls-service.yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: helloworld-service\n  annotations:\n    service.beta.kubernetes.io/aws-load-balancer-ssl-cert: 'arn:aws:acm:region:accountid:certificate/...' #replace this value\n    service.beta.kubernetes.io/aws-load-balancer-backend-protocol: 'http'\n    service.beta.kubernetes.io/aws-load-balancer-ssl-ports: '443'\n    service.beta.kubernetes.io/aws-load-balancer-connection-draining-enabled: 'true'\n    service.beta.kubernetes.io/aws-load-balancer-connection-draining-timeout: '60'\n    service.beta.kubernetes.io/aws-load-balancer-additional-resource-tags: 'environment=dev,app=helloworld'\nspec:\n  ports:\n    - name: http\n      port: 80\n      targetPort: nodejs-port\n      protocol: TCP\n    - name: https\n      port: 443\n      targetPort: nodejs-port\n      protocol: TCP\n  selector:\n    app: helloworld\n  type: LoadBalancer","position":{"start":{"line":390,"column":1,"offset":12510},"end":{"line":416,"column":4,"offset":13412},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":419,"column":1,"offset":13415},"end":{"line":419,"column":31,"offset":13445},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":419,"column":31,"offset":13445}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"4-kubernetes-administration\"\n    }}>{`4. Kubernetes Administration`}</h1>\n    <h2 {...{\n      \"id\": \"resources\"\n    }}>{`Resources`}</h2>\n    <ol>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://github.com/etcd-io/etcd/issues/2512\"\n        }}>{`Why etcd is etcd?`}</a></li>\n    </ol>\n    <h2 {...{\n      \"id\": \"administration\"\n    }}>{`Administration`}</h2>\n    <p><img alt=\"Kubernetes Master Overview\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1540175278/Screen_Shot_2018-10-22_at_1.26.57_pm.png\" /></p>\n    <ul>\n      <li parentName=\"ul\">{`When you deploy a new Pod, the information is stored in `}<inlineCode parentName=\"li\">{`etcd`}</inlineCode>{`. (etcd = `}<inlineCode parentName=\"li\">{`/etc`}</inlineCode>{` config folder and `}<inlineCode parentName=\"li\">{`d`}</inlineCode>{` = distributed)`}</li>\n      <li parentName=\"ul\">{`Schedular talks to REST api.`}</li>\n      <li parentName=\"ul\">{`REST api is used to handle tasks.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Interfaces with Kubelets on the nodes.`}</li>\n        </ul></li>\n    </ul>\n    <h2 {...{\n      \"id\": \"41-resource-quotas\"\n    }}>{`4.1 Resource Quotas`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`Resource management is useful when giving access to a person or a team.`}</li>\n      <li parentName=\"ul\">{`You don't want one person or team `}<strong parentName=\"li\">{`taking up all the resources`}</strong>{` (e.g. CPU/Memory) of the cluster.`}</li>\n      <li parentName=\"ul\">{`You can divide the cluster into `}<strong parentName=\"li\">{`namespaces`}</strong>{` and enable resource quotas on it.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`You can do this using the `}<strong parentName=\"li\">{`ResourceQuota`}</strong>{` and `}<strong parentName=\"li\">{`ObjectQuota`}</strong>{` objects.`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`Each container can specify `}<strong parentName=\"li\">{`request capacity`}</strong>{` and `}<strong parentName=\"li\">{`capacity limits`}</strong>{`.`}<ul parentName=\"li\">\n          <li parentName=\"ul\"><strong parentName=\"li\">{`Request capacity`}</strong>{` is an `}<strong parentName=\"li\">{`explicit request`}</strong>{` for resources.`}<ul parentName=\"li\">\n              <li parentName=\"ul\">{`The scheduler can use the `}<strong parentName=\"li\">{`request capacity`}</strong>{` to make decisions on where to put the pod on.`}</li>\n              <li parentName=\"ul\">{`You can see it as a `}<strong parentName=\"li\">{`minimum amount of resources the pod needs`}</strong>{`.`}</li>\n            </ul></li>\n          <li parentName=\"ul\"><strong parentName=\"li\">{`Resource limit`}</strong>{` is a limit imposed to the container.`}<ul parentName=\"li\">\n              <li parentName=\"ul\">{`Container will not be able to utilize more resources than specified.`}</li>\n            </ul></li>\n        </ul></li>\n    </ul>\n    <h3 {...{\n      \"id\": \"resource-quota-examples\"\n    }}>{`Resource Quota Examples`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`You run a `}<strong parentName=\"li\">{`deployment`}</strong>{` with a `}<strong parentName=\"li\">{`pod`}</strong>{` with a `}<strong parentName=\"li\">{`CPU resource`}</strong>{` request of `}<strong parentName=\"li\">{`200m`}</strong>{`. (200 millicpu/milliocores).`}</li>\n      <li parentName=\"ul\">{`200m = 0.2 = 20% of CPU core of running node.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`If node has 2 cores, still 20% of a single core.`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`You can also put a limit eg 400m.`}</li>\n      <li parentName=\"ul\">{`Memory quotes defined in MB or GB.`}</li>\n      <li parentName=\"ul\">{`Each pod needs the capacity quota defined during creation.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Admin can specify default request values for pods that don't specify any values for capacity.`}</li>\n          <li parentName=\"ul\">{`The same is valid for limit quotas.`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`If resource is requested more than the allowed capacity, the server API will give an error 403 FORBIDDEN and `}<inlineCode parentName=\"li\">{`kubectl`}</inlineCode>{` will show an error.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"resource-quote-options\"\n    }}>{`Resource Quote options`}</h3>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Resource`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`requests.cpu`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Sum of CPU reqs of all pos cannot exceed this value`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`requests.mem`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Sum of MEM reqs of all pods cannot exceed this value`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`requests.storage`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Sum of storage reqs of all persistent volume claims cannot exceed this value`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`limits.cpu`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Sum of CPU limits of all pods cannot exceed this value`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`limits.memory`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Sum of MEM limits of all pods cannot exceed this value`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`You can also set limits on:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`configmaps`}</li>\n      <li parentName=\"ul\">{`persistentvolumeclaims`}</li>\n      <li parentName=\"ul\">{`pods`}</li>\n      <li parentName=\"ul\">{`replicationcontrollers`}</li>\n      <li parentName=\"ul\">{`resourcequotas`}</li>\n      <li parentName=\"ul\">{`services`}</li>\n      <li parentName=\"ul\">{`services.loadbalancer`}</li>\n      <li parentName=\"ul\">{`services.nodeports`}</li>\n      <li parentName=\"ul\">{`secrets`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"42-namespaces\"\n    }}>{`4.2 Namespaces`}</h2>\n    <p>{`Namespaces allow you to create `}<strong parentName=\"p\">{`virtual clusters`}</strong>{` within the same physical cluster.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Namespaces `}<strong parentName=\"li\">{`logically separates`}</strong>{` your cluster.`}</li>\n      <li parentName=\"ul\">{`The standard namespace is called `}<strong parentName=\"li\">{`\"default\"`}</strong>{` and that's where all the resources are launched by default.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`There is also `}<strong parentName=\"li\">{`kube-system`}</strong>{` - a namespace for kubernetes specific resources.`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`Namespaces are intended when you have `}<strong parentName=\"li\">{`multiple teams/projects`}</strong>{` using the Kubernetes cluster.`}</li>\n      <li parentName=\"ul\">{`Resource names within namespace must be unique.`}</li>\n      <li parentName=\"ul\">{`You can divide resources of a Kubernetes cluster using namespaces.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`You can limit resources on a per namespace basis.`}</li>\n          <li parentName=\"ul\">{`E.g. Marketing team can only use a maximum of 10GiB of memory, 2 loadbalancers, 2 CPU cores.`}</li>\n        </ul></li>\n    </ul>\n    <h3 {...{\n      \"id\": \"namespace-commands\"\n    }}>{`Namespace commands`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`$ kubectl create namespace myspace # create namespace myspace\n$ kubectl get namespaces # list all namespaces\n# Set default namespace to launch resources in\n$ export CONTEXT=$(kubectl config view | awk '/current-context/{print $2}')\n$ kubectl config set-context $CONTEXT --namespace=myspace\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`apiVersion: 1\nkind: ResourceQuota\nmetadata:\n  name: objects-counts\nnamespace: myspace\nspec:\n  hard:\n    configmaps: '10'\npersistentvolumesclaim: '4'\nreplicationcontrollers: '20'\nsecrets: '10'\nservices: '10'\nservices.loadbalancers: '2'\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"demo-resourcequotas\"\n    }}>{`Demo ResourceQuotas`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# resourcequota.yml\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: myspace\n---\napiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: compute-quota\n  namespace: myspace\nspec:\n  hard:\n    requests.cpu: '1'\n    requests.memory: 1Gi\n    limits.cpu: '2'\n    limits.memory: 2Gi\n---\napiVersion: v1\nkind: ResourceQuota\nmetadata:\n  name: object-quota\n  namespace: myspace\nspec:\n  hard:\n    configmaps: '10'\n    persistentvolumeclaims: '4'\n    replicationcontrollers: '20'\n    secrets: '10'\n    services: '10'\n    services.loadbalancers: '2'\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# helloworld-with-quotas.yaml\napiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  name: helloworld-deployment\n  namespace: myspace\nspec:\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: helloworld\n    spec:\n      containers:\n        - name: k8s-demo\n          image: wardviaene/k8s-demo\n          ports:\n            - name: nodejs-port\n              containerPort: 3000\n          resources:\n            requests:\n              cpu: 200m\n              memory: 0.5Gi\n            limits:\n              cpu: 400m\n              memory: 1Gi\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# helloworld-no-quotas.yaml\napiVersion: extensions/v1beta1\nkind: Deployment\nmetadata:\n  name: helloworld-deployment\n  namespace: myspace\nspec:\n  replicas: 3\n  template:\n    metadata:\n      labels:\n        app: helloworld\n    spec:\n      containers:\n        - name: k8s-demo\n          image: wardviaene/k8s-demo\n          ports:\n            - name: nodejs-port\n              containerPort: 3000\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# default.yaml\napiVersion: v1\nkind: LimitRange\nmetadata:\n  name: limits\n  namespace: myspace\nspec:\n  limits:\n    - default:\n        cpu: 200m\n        memory: 512Mi\n      defaultRequest:\n        cpu: 100m\n        memory: 256Mi\n      type: Container\n`}</code></pre>\n    <p>{`The following commands can be used to get check resources:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`$ kubectl get <% pod_name %> --namespace=myspace\n$ kubectl describe <% pod_name %> --namespace=myspace\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"43-user-management\"\n    }}>{`4.3 User Management`}</h2>\n    <p>{`There are two user types:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Normal user (used to access the cluster externally) ie through kubctl.`}</li>\n      <li parentName=\"ol\">{`Service user (which is managed by an object in Kubernetes).`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Used to authenticate within the cluster ie from inside pod of kubelet.`}</li>\n          <li parentName=\"ul\">{`These creds are managed like `}<strong parentName=\"li\">{`secrets`}</strong>{`.`}</li>\n        </ul></li>\n    </ol>\n    <h3 {...{\n      \"id\": \"normal-users\"\n    }}>{`Normal Users`}</h3>\n    <p>{`Auth strategies include:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Client certificates`}</li>\n      <li parentName=\"ul\">{`Bearer Tokens`}</li>\n      <li parentName=\"ul\">{`Authentication Proxy`}</li>\n      <li parentName=\"ul\">{`HTTP Basic Authentication`}</li>\n      <li parentName=\"ul\">{`OpenID`}</li>\n      <li parentName=\"ul\">{`Webhooks`}</li>\n    </ul>\n    <p>{`They have the following attributes:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Username (e.g. user123 or email@email.com)`}</li>\n      <li parentName=\"ul\">{`A UID`}</li>\n      <li parentName=\"ul\">{`Groups`}</li>\n      <li parentName=\"ul\">{`Extra fields to store extra info`}</li>\n    </ul>\n    <p>{`After a normal user authenticates, it was hav access to everything.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`To limit, you need to configure auth.`}</li>\n      <li parentName=\"ul\">{`There are multiple offerings:`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`AlwaysAllow / AlwaysDeny`}</li>\n          <li parentName=\"ul\">{`ABAC (Attribute-Based Access Control)`}</li>\n          <li parentName=\"ul\">{`RBAC (Role Based Access Control)`}</li>\n          <li parentName=\"ul\">{`Webhook (auth by remote service)`}</li>\n        </ul></li>\n    </ul>\n    <h3 {...{\n      \"id\": \"service-users\"\n    }}>{`Service Users`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`Service Users are using `}<strong parentName=\"li\">{`Service Account Tokens`}</strong>{`.`}</li>\n      <li parentName=\"ul\">{`They are stored as `}<strong parentName=\"li\">{`credentials using Secrets`}</strong>{`.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Those Secrets are also mounted in pods to allow communication between the services.`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`Service Users are `}<strong parentName=\"li\">{`specific to a namespace`}</strong>{`.`}</li>\n      <li parentName=\"ul\">{`They are created automatically by the API or manually using `}<strong parentName=\"li\">{`objects`}</strong>{`.`}</li>\n      <li parentName=\"ul\">{`Any API call `}<strong parentName=\"li\">{`not authenticated`}</strong>{` is considered as an `}<strong parentName=\"li\">{`anonymous`}</strong>{` user.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"other-notes-on-user-management\"\n    }}>{`Other notes on User Management`}</h3>\n    <p>{`Auth is still a work in progress. The demo itself shows the creation of a asymmetric key and updating Minikube to allow that as the user.`}</p>\n    <h2 {...{\n      \"id\": \"44-rbac-role-based-access-control\"\n    }}>{`4.4 RBAC (Role Based Access Control)`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`Regulates access using `}<strong parentName=\"li\">{`roles`}</strong>{`.`}</li>\n      <li parentName=\"ul\">{`Allows admins to dynamically configure permission policies.`}</li>\n      <li parentName=\"ul\">{`This is what I'll use in the demo.`}</li>\n    </ul>\n    <p>{`You add RBAC resources with `}<inlineCode parentName=\"p\">{`kubectl`}</inlineCode>{` from a yaml format file.`}</p>\n    <p>{`First, define a role, then assign users/groups to that role.`}</p>\n    <p>{`You can create roles limited to a namespace or that applies across all namespaces.`}</p>\n    <ul>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`Role`}</strong>{` (single namespace) and `}<strong parentName=\"li\">{`ClusterRole`}</strong>{` (cluster-wide).`}</li>\n      <li parentName=\"ul\"><strong parentName=\"li\">{`RoleBinding`}</strong>{` (single namespace) and `}<strong parentName=\"li\">{`ClusterRoleBinding`}</strong>{` (cluster-wide).`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"45-networking\"\n    }}>{`4.5 Networking`}</h2>\n    <p>{`Communication topics already covered:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Container to container: communication within a pod.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Through `}<strong parentName=\"li\">{`localhost`}</strong>{` and the `}<strong parentName=\"li\">{`port number`}</strong>{`.`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`Pod-To-Service comms`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Using `}<strong parentName=\"li\">{`NodePort`}</strong>{` and `}<strong parentName=\"li\">{`DNS`}</strong>{`.`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`External-To-Service`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Using `}<strong parentName=\"li\">{`LoadBalancer`}</strong>{`, `}<strong parentName=\"li\">{`NodePort`}</strong>{`.`}</li>\n        </ul></li>\n    </ul>\n    <h3 {...{\n      \"id\": \"pods\"\n    }}>{`Pods`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`The pod should always be routable.`}</li>\n      <li parentName=\"ul\">{`Kubernetes assumes that pods should be able to communicate to other pods, regardless of which node they are running.`}</li>\n      <li parentName=\"ul\">{`Kubernetes assumes that pods should be able to communicate to other pods, regardless of which node they are running.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Every pod has its `}<strong parentName=\"li\">{`own IP address`}</strong>{`.`}</li>\n          <li parentName=\"ul\">{`Pods on different nodes need to be able to communicate to each other using those IP addresses.`}<ul parentName=\"li\">\n              <li parentName=\"ul\">{`This is implemented differently depending on your networking setup.`}</li>\n              <li parentName=\"ul\">{`On AWS: kubenet networking (kops default).`}</li>\n            </ul></li>\n        </ul></li>\n    </ul>\n    <h3 {...{\n      \"id\": \"kubenet-networking\"\n    }}>{`Kubenet Networking`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`Every pod can get an IP that is `}<strong parentName=\"li\">{`routable`}</strong>{` using the AWS Virtual Private Network (VPC).`}</li>\n      <li parentName=\"ul\">{`The kubernetes master allocates a /24 subnet to each node (254 IP addresses).`}</li>\n      <li parentName=\"ul\">{`The subnet is added to the VPCs route table.`}</li>\n      <li parentName=\"ul\">{`There is a limit of `}<strong parentName=\"li\">{`50 entries`}</strong>{`, which means you can't have more than 50 nodes in a single AWS cluster.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"vpc-alternatives\"\n    }}>{`VPC Alternatives`}</h3>\n    <p>{`Not every cloud provider has VPC-tech (GCE and Azure do).`}</p>\n    <p>{`The alternatives for things like on-prem etc are:`}</p>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Container Network Interface (CNI)`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\">\n            <p parentName=\"li\">{`Software that provides libraries/plugins for network interfaces within containers.`}</p>\n          </li>\n          <li parentName=\"ul\">\n            <p parentName=\"li\">{`Popular solutions are `}<strong parentName=\"p\">{`Calico, Weave`}</strong>{` (standalone or with CNI).`}</p>\n          </li>\n        </ul>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`An Overlay Network`}</p>\n        <ul parentName=\"li\">\n          <li parentName=\"ul\"><strong parentName=\"li\">{`Flannel`}</strong>{` is an easy and popular way.`}</li>\n        </ul>\n      </li>\n    </ol>\n    <h2 {...{\n      \"id\": \"46-node-maintenance\"\n    }}>{`4.6 Node Maintenance`}</h2>\n    <p>{`It is the `}<strong parentName=\"p\">{`Node Controller`}</strong>{` that is responsible for managing the Node object.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`It assigns `}<strong parentName=\"li\">{`IP Space`}</strong>{` to the node when a new node is launched.`}</li>\n      <li parentName=\"ul\">{`It keeps the `}<strong parentName=\"li\">{`node list`}</strong>{` up to date with the available machines.`}</li>\n      <li parentName=\"ul\">{`The node controller is also monitoring the `}<strong parentName=\"li\">{`health of the node`}</strong>{`.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`If a node is `}<strong parentName=\"li\">{`unhealthy it gets deleted`}</strong>{`.`}</li>\n          <li parentName=\"ul\">{`Pods running on the unhealthy node will then get `}<strong parentName=\"li\">{`rescheduled`}</strong>{`.`}</li>\n        </ul></li>\n    </ul>\n    <h3 {...{\n      \"id\": \"adding-a-new-node\"\n    }}>{`Adding a new node`}</h3>\n    <p>{`When adding a new node, the `}<strong parentName=\"p\">{`kubelet`}</strong>{` will attempt to register itself. This is called `}<strong parentName=\"p\">{`self-registration`}</strong>{` and is the default behaviour.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`It allows you to `}<strong parentName=\"li\">{`easily add more nodes`}</strong>{` to the cluster without making API changes yourself.`}</li>\n      <li parentName=\"ul\">{`A new node object is `}<strong parentName=\"li\">{`automatically`}</strong>{` created with:`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`The metadata (with a name: IP or hostname).`}</li>\n          <li parentName=\"ul\">{`Labels (e.g. cloud region / availability zone / instance size).`}</li>\n        </ul></li>\n      <li parentName=\"ul\">{`Has `}<strong parentName=\"li\">{`node condition`}</strong>{` (e.g. Ready, OutOfDisk).`}</li>\n      <li parentName=\"ul\">{`When you want to `}<strong parentName=\"li\">{`decomission`}</strong>{` a node, you want to do it gracefully.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`Drain a node before you shut it down or take it out of the cluster.`}</li>\n        </ul></li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`# drain a node\n$ kubectl drain nodename --grace-period=600\n\n# if node runs pods not managed by a controller but just a single pod\n$ kubectl drain nodename --force\n`}</code></pre>\n    <p><img alt=\"Terminal draining\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1540183374/Screen_Shot_2018-10-22_at_3.42.29_pm.png\" /></p>\n    <h2 {...{\n      \"id\": \"47-high-availability\"\n    }}>{`4.7 High Availability`}</h2>\n    <p>{`If you are running in prod, you willwant all master services in `}<strong parentName=\"p\">{`high availability`}</strong>{`.`}</p>\n    <h3 {...{\n      \"id\": \"setup\"\n    }}>{`Setup`}</h3>\n    <ol>\n      <li parentName=\"ol\"><strong parentName=\"li\">{`Clustering etcd:`}</strong>{` at least run 3 etcd nodes.`}</li>\n      <li parentName=\"ol\"><strong parentName=\"li\">{`Replicated API servers:`}</strong>{` with a a LoadBalancer`}</li>\n      <li parentName=\"ol\">{`Running multiple instances of the `}<strong parentName=\"li\">{`scheduler`}</strong>{` and the `}<strong parentName=\"li\">{`controllers`}</strong>{`.`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`only one of them will be the leader, the others are on stand-by.`}</li>\n        </ul></li>\n    </ol>\n    <p><img alt=\"HA Overview\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1540183580/Screen_Shot_2018-10-22_at_3.46.05_pm.png\" /></p>\n    <p><img alt=\"HA diagram\" src=\"https://res.cloudinary.com/gitgoodclub/image/upload/v1540183671/Screen_Shot_2018-10-22_at_3.46.52_pm.png\" /></p>\n    <h3 {...{\n      \"id\": \"kops-with-multiple-masters-for-ha\"\n    }}>{`Kops with multiple masters for HA`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`kops create cluster --name=... --zones=eu-west-1a,eu-west-1b,eu-west-1c --master-zones=eu-west-1a,eu-west-1b,eu-west-1c\n`}</code></pre>\n    <p>{`This becomes more complex for volumes since EBS volumes are based within zones.`}</p>\n    <h2 {...{\n      \"id\": \"48-tls-on-elb-using-annotations\"\n    }}>{`4.8 TLS on ELB using Annotations`}</h2>\n    <p>{`You can setup `}<strong parentName=\"p\">{`cloud specific features`}</strong>{` (like TLS termination) on AWS LoadBalancers that you create in Kubernetes using services of type LoadBalancer.`}</p>\n    <p>{`You can do this using `}<strong parentName=\"p\">{`annotations`}</strong>{` to pass some flags for cloud configuration eg aws-load-balancer-ssl-cert, aws-load-balancer-backend-protocol etc.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# helloworld-elb-tls-service.yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: helloworld-service\n  annotations:\n    service.beta.kubernetes.io/aws-load-balancer-ssl-cert: 'arn:aws:acm:region:accountid:certificate/...' #replace this value\n    service.beta.kubernetes.io/aws-load-balancer-backend-protocol: 'http'\n    service.beta.kubernetes.io/aws-load-balancer-ssl-ports: '443'\n    service.beta.kubernetes.io/aws-load-balancer-connection-draining-enabled: 'true'\n    service.beta.kubernetes.io/aws-load-balancer-connection-draining-timeout: '60'\n    service.beta.kubernetes.io/aws-load-balancer-additional-resource-tags: 'environment=dev,app=helloworld'\nspec:\n  ports:\n    - name: http\n      port: 80\n      targetPort: nodejs-port\n      protocol: TCP\n    - name: https\n      port: 443\n      targetPort: nodejs-port\n      protocol: TCP\n  selector:\n    app: helloworld\n  type: LoadBalancer\n`}</code></pre>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}