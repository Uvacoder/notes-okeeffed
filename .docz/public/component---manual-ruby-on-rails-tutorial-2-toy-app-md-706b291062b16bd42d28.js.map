{"version":3,"sources":["webpack:///../manual/Ruby-On-Rails-Tutorial/2-Toy-App.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---manual-ruby-on-rails-tutorial-2-toy-app-md-706b291062b16bd42d28.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"toy-app\"\n    }}>{`Toy App`}</h1>\n    <h2 {...{\n      \"id\": \"the-users-resource\"\n    }}>{`The Users Resource`}</h2>\n    <p>{`We can scaffold the users resource with the following:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`rails generate scaffold User name:string email:string\n`}</code></pre>\n    <blockquote>\n      <p parentName=\"blockquote\">{`Note: There is no need to create a parameter for `}<inlineCode parentName=\"p\">{`id`}</inlineCode>{` - it is created for you.`}</p>\n    </blockquote>\n    <p>{`Generally speaking, it is not a great idea to get too deep into scaffolding.`}</p>\n    <p>{`That generation will create a migration in `}<inlineCode parentName=\"p\">{`db/migrate`}</inlineCode>{`.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\">{`In Rails 6, you should use `}<inlineCode parentName=\"p\">{`rails`}</inlineCode>{` in place of `}<inlineCode parentName=\"p\">{`rake`}</inlineCode>{`.`}</p>\n    </blockquote>\n    <p>{`That generation of the `}<inlineCode parentName=\"p\">{`User`}</inlineCode>{` will create the routing for the following:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`URL`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Action`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Purpose`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/users`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`index`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`page to list all users`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/users/1`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`show`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`page to show user with id 1`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/users/new`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`new`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`page to make a new user`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/users/1/edit`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`edit`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`page to edit user with id 1`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`In the `}<inlineCode parentName=\"p\">{`config/routes.rb`}</inlineCode>{`, this comes under `}<inlineCode parentName=\"p\">{`resources :users`}</inlineCode></p>\n    <h2 {...{\n      \"id\": \"mvc-in-action\"\n    }}>{`MVC in action`}</h2>\n    <p>{`At first, the users are fetched from the Rails Router as step (1) which finds the resource in the controller and correct action to take as step (2).`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`class UsersController < ApplicationController\n  before_action :set_user, only: %i[ show edit update destroy ]\n\n  # GET /users or /users.json\n  def index\n    @users = User.all\n  end\n\n  # GET /users/1 or /users/1.json\n  def show\n  end\n\n  # GET /users/new\n  def new\n    @user = User.new\n  end\n\n  # GET /users/1/edit\n  def edit\n  end\n\n  # POST /users or /users.json\n  def create\n    @user = User.new(user_params)\n\n    respond_to do |format|\n      if @user.save\n        format.html { redirect_to @user, notice: \"User was successfully created.\" }\n        format.json { render :show, status: :created, location: @user }\n      else\n        format.html { render :new, status: :unprocessable_entity }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /users/1 or /users/1.json\n  def update\n    respond_to do |format|\n      if @user.update(user_params)\n        format.html { redirect_to @user, notice: \"User was successfully updated.\" }\n        format.json { render :show, status: :ok, location: @user }\n      else\n        format.html { render :edit, status: :unprocessable_entity }\n        format.json { render json: @user.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /users/1 or /users/1.json\n  def destroy\n    @user.destroy\n    respond_to do |format|\n      format.html { redirect_to users_url, notice: \"User was successfully destroyed.\" }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_user\n      @user = User.find(params[:id])\n    end\n\n    # Only allow a list of trusted parameters through.\n    def user_params\n      params.require(:user).permit(:name, :email)\n    end\nend\n`}</code></pre>\n    <p>{`For the `}<inlineCode parentName=\"p\">{`index`}</inlineCode>{` route, we get an instance variable assigned:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`# GET /users or /users.json\ndef index\n  @users = User.all\nend\n`}</code></pre>\n    <p>{`Step (3) is to talk to the `}<inlineCode parentName=\"p\">{`User`}</inlineCode>{` model, which you will notice is empty (but inherits all the functionality from `}<inlineCode parentName=\"p\">{`ApplicationRecord`}</inlineCode>{`):`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`class User < ApplicationRecord\nend\n`}</code></pre>\n    <p>{`Step (4), the user model will then talk to the database.\nStep (5), the result is passed back to the controller.\nStep (6) is passing that data to the view.\nStep (7) returns HTML to the controller.\nStep (8) is the controller returning that HTML to the browser.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\">{`He admits that step (8) may not happen - the view may be returned directly to the user. He likes the think the controller is in between.`}</p>\n    </blockquote>\n    <blockquote>\n      <p parentName=\"blockquote\">{`It is conventional in Rails for the controller to be plural.`}</p>\n    </blockquote>\n    <p>{`Just know, that the set of URLs that Rails supplies is known as a `}<inlineCode parentName=\"p\">{`resource`}</inlineCode>{`.`}</p>\n    <h2 {...{\n      \"id\": \"the-weaknesses-of-our-current-users-resource\"\n    }}>{`The weaknesses of our current Users resource`}</h2>\n    <ol>\n      <li parentName=\"ol\">{`No validation.`}</li>\n      <li parentName=\"ol\">{`No authentication (and no way to prevent operations).`}</li>\n      <li parentName=\"ol\">{`No tests.`}</li>\n      <li parentName=\"ol\">{`No style or layout.`}</li>\n      <li parentName=\"ol\">{`No real understanding. If you understand the scaffold codem you probably shouldn't do this course/book.`}</li>\n    </ol>\n    <h2 {...{\n      \"id\": \"adding-the-microposts\"\n    }}>{`Adding the Microposts`}</h2>\n    <p>{`We will use the scaffold again to create the microposts. Something worth noting here is that we are not going to use the \"foreign key\" type connection.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`rails generate scaffold Micropost content:text user_id:integer\n# again, run the migration\nrails db:migrate\n`}</code></pre>\n    <p>{`Note, if you mess up the initial generate, you can roll things back like so:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`# If you migrated the db\nrails db:migrate\n# Destory scaffold files\nrails destroy scaffold Micropost\n`}</code></pre>\n    <p>{`We want the content to be short (140 chars). To do this, we can do this in the `}<inlineCode parentName=\"p\">{`Micropost`}</inlineCode>{` model:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`class Micropost < ApplicationRecord\n  validates :content, length: { maximum: 140 }\nend\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"a-user-has_many-microposts\"\n    }}>{`A user \"has_many\" microposts`}</h2>\n    <p>{`To associate, we head to the User model and let is know is has many microposts:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`# app/models/user.rb\nclass User < ApplicationRecord\n  has_many :microposts\nend\n\n# app/models/micropost.rb\nclass Micropost < ApplicationRecord\n  belongs_to :user\n  validates :content, length: { maximum: 140 }\nend\n`}</code></pre>\n    <p>{`Later on, we can express that relationship through the web interface. For now, we will see how it works on the Rails Console.`}</p>\n    <p>{`This can be accessed with `}<inlineCode parentName=\"p\">{`rails console`}</inlineCode>{` (or `}<inlineCode parentName=\"p\">{`rails c`}</inlineCode>{` for short).`}</p>\n    <p>{`We can find the first user in the console with `}<inlineCode parentName=\"p\">{`User.first`}</inlineCode>{`.`}</p>\n    <blockquote>\n      <p parentName=\"blockquote\">{`Note: you can assign the previous result with `}<inlineCode parentName=\"p\">{`_`}</inlineCode>{` so `}<inlineCode parentName=\"p\">{`first_user = _`}</inlineCode>{`.`}</p>\n    </blockquote>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`irb(main):001:0> User.first\n   (0.6ms)  SELECT sqlite_version(*)\n  User Load (0.1ms)  SELECT \"users\".* FROM \"users\" ORDER BY \"users\".\"id\" ASC LIMIT ?  [[\"LIMIT\", 1]]\n=> #<User id: 1, name: \"Dennis O'Keeffe\", email: \"hello@dennisokeeffe.com\", created_at: \"2021-02-02 04:36:03.016350000 +0000\", updated_at: \"2021-02-02 04:36:41.666319000 +0000\">\nirb(main):002:0> first_user = _\n=> #<User id: 1, name: \"Dennis O'Keeffe\", email: \"hello@dennisokeeffe.com\", created_at: \"2021-02-02 04:36:03.016350000 +0000\", updated_at: \"2021-02-02 04:36:41.666319000 +0000\">\nirb(main):008:0> first_user.microposts\n  Micropost Load (0.2ms)  SELECT \"microposts\".* FROM \"microposts\" WHERE \"microposts\".\"user_id\" = ? /* loading for inspect */ LIMIT ?  [[\"user_id\", 1], [\"LIMIT\", 11]]\n=> #<ActiveRecord::Associations::CollectionProxy [#<Micropost id: 1, content: \"Hello, world!\", user_id: 1, created_at: \"2021-02-02 05:19:30.508188000 +0000\", updated_at: \"2021-02-02 05:19:30.508188000 +0000\">]>\nirb(main):010:0> first_micropost = first_user.microposts.first\n  Micropost Load (0.2ms)  SELECT \"microposts\".* FROM \"microposts\" WHERE \"microposts\".\"user_id\" = ? ORDER BY \"microposts\".\"id\" ASC LIMIT ?  [[\"user_id\", 1], [\"LIMIT\", 1]]\n=> #<Micropost id: 1, content: \"Hello, world!\", user_id: 1, created_at: \"2021-02-02 05:19:30.508188000 +0000\", updated_at: \"2021-02-02 05:19:30.508188000 +0000\">\nirb(main):011:0> first_micropost.user\n=> #<User id: 1, name: \"Dennis O'Keeffe\", email: \"hello@dennisokeeffe.com\", created_at: \"2021-02-02 04:36:03.016350000 +0000\", updated_at: \"2021-02-02 04:36:41.666319000 +0000\">\n`}</code></pre>\n    <p>{`As a final input (back in regards to our forms to create a new micropost), you can also validate that fields have a value present using `}<inlineCode parentName=\"p\">{`presence`}</inlineCode>{` in the data model:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-rb\"\n      }}>{`class Micropost < ApplicationRecord\n  belongs_to :user\n  validates :content, length: { maximum: 140 },\n                      presence: true\nend\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"inheritance-hierarchies\"\n    }}>{`Inheritance hierarchies`}</h2>\n    <p>{`This is mainly for those with backgrounds in OOP.`}</p>\n    <p>{`This section just speaks to the inheritance heirarchy for the controllers, models, etc.`}</p>\n    <p>{`For the `}<inlineCode parentName=\"p\">{`ApplicationController`}</inlineCode>{` that everything else inherits from, it is due to the convenience of adding things to the `}<inlineCode parentName=\"p\">{`ApplicationController`}</inlineCode>{` that apply to all the other controllers in the application.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}