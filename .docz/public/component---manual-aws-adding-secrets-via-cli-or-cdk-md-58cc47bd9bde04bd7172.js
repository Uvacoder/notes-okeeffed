(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{GJyZ:function(e,t,r){"use strict";r.r(t),r.d(t,"_frontmatter",(function(){return c})),r.d(t,"default",(function(){return l}));r("1c7q"),r("abGl"),r("gZHo"),r("Fdmb"),r("Ir+3"),r("2mQt"),r("mXGw");var n=r("/FXl"),a=r("TjRS");r("aD51");function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var c={};void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!c.hasOwnProperty("__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"manual/AWS/Adding-Secrets-Via-CLI-or-CDK.md"}});var o={_frontmatter:c},i=a.a;function l(e){var t=e.components,r=function(e,t){if(null==e)return{};var r,n,a={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["components"]);return Object(n.b)(i,s({},o,r,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h1",{id:"adding-secrets-via-cli-or-cdk"},"Adding Secrets Via CLI or CDK"),Object(n.b)("h2",{id:"resources"},"Resources"),Object(n.b)("ol",null,Object(n.b)("li",{parentName:"ol"},Object(n.b)("a",s({parentName:"li"},{href:"https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html"}),"AWS Tutorial")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("a",s({parentName:"li"},{href:"https://docs.aws.amazon.com/cli/latest/reference/secretsmanager/index.html"}),"AWS CLI secretsmanager")),Object(n.b)("li",{parentName:"ol"},Object(n.b)("a",s({parentName:"li"},{href:"https://docs.aws.amazon.com/cdk/api/latest/docs/aws-secretsmanager-readme.html"}),"AWS CDK Secrets Manager"))),Object(n.b)("h2",{id:"creating-the-secret"},"Creating the Secret"),Object(n.b)("pre",null,Object(n.b)("code",s({parentName:"pre"},{className:"language-s"}),'aws secretsmanager create-secret --name tutorials/MyFirstTutorialSecret --description "The secret I created for the first tutorial"\n')),Object(n.b)("p",null,"The response will look something like so:"),Object(n.b)("pre",null,Object(n.b)("code",s({parentName:"pre"},{className:"language-json"}),'{\n  "ARN": "&region-arn;secretsmanager:us-west-2:123456789012:secret:tutorials/MyFirstTutorialSecret-a1b2c3",\n  "Name": "tutorials/MyFirstTutorialSecret"\n}\n')),Object(n.b)("h2",{id:"describing-the-secret"},"Describing the Secret"),Object(n.b)("pre",null,Object(n.b)("code",s({parentName:"pre"},{className:"language-s"}),"aws secretsmanager describe-secret --secret-id tutorials/MyFirstTutorialSecret\n")),Object(n.b)("p",null,"You'll get back:"),Object(n.b)("pre",null,Object(n.b)("code",s({parentName:"pre"},{className:"language-json"}),'{\n  "ARN": "&region-arn;secretsmanager:region:123456789012:secret:tutorials/MyFirstTutorialSecret-jiObOV",\n  "Name": "tutorials/MyFirstTutorialSecret",\n  "Description": "My First Secret",\n  "LastChangedDate": 1522680794.8,\n  "LastAccessedDate": 1522627200.0,\n  "VersionIdsToStages": {\n    "EXAMPLE1-90ab-cdef-fedc-ba987EXAMPLE": ["AWSCURRENT"]\n  }\n}\n')),Object(n.b)("h2",{id:"retrieving-the-secret"},"Retrieving the Secret"),Object(n.b)("pre",null,Object(n.b)("code",s({parentName:"pre"},{className:"language-s"}),"aws secretsmanager get-secret-value --secret-id tutorials/MyFirstTutorialSecret --version-stage AWSCURRENT\n")),Object(n.b)("p",null,"You'll get back:"),Object(n.b)("pre",null,Object(n.b)("code",s({parentName:"pre"},{className:"language-json"}),'{\n  "ARN": "&region-arn;secretsmanager:region:123456789012:secret:tutorials/MyFirstTutorialSecret-jiObOV",\n  "Name": "tutorials/MyFirstTutorialSecret",\n  "VersionId": "EXAMPLE1-90ab-cdef-fedc-ba987EXAMPLE",\n  "SecretString": "{\\"username\\":\\"myserviceusername\\",\\"password\\":\\"MyVerySecureP@ssw0rd!\\"}",\n  "VersionStages": ["AWSCURRENT"],\n  "CreatedDate": 1522680764.668\n}\n')),Object(n.b)("h2",{id:"with-the-cdk"},"With the CDK"),Object(n.b)("pre",null,Object(n.b)("code",s({parentName:"pre"},{className:"language-ts"}),"import secretsManager = require('@aws-cdk/aws-secretsmanager');\n\n// ... further down\nnew Function(this, `teams-bot-${props.farm}`, {\n  projectName: props.projectName,\n  functionName: `${props.projectName}-teams-bot-${props.farm}`,\n  code: lambda.Code.fromAsset('../path/to/func.zip'),\n  runtime: lambda.Runtime.NODEJS_12_X,\n  handler: 'index.handler',\n  environment: {\n    ...props.functionEnvVars,\n    MICROSOFT_APP_ID: `${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'ms-app-id',\n        `/${props.projectName}/ms-app-id`,\n      ).secretValue\n    }`,\n    MICROSOFT_APP_PASSWORD: `${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'ms-app-password',\n        `/${props.projectName}/ms-app-password`,\n      ).secretValue\n    }`,\n    OAUTH_CLIENT_ID: `${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'oauth-client-id',\n        `/${props.projectName}/oauth-client-id`,\n      ).secretValue\n    }`,\n    OAUTH_CLIENT_SECRET: `${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'oauth-client-secret',\n        `/${props.projectName}/oauth-client-secret`,\n      ).secretValue\n    }`,\n    NEW_RELIC_APP_NAME: `${props.projectName}-teams-bot-${props.farm}`,\n  },\n  timeout: cdk.Duration.seconds(60),\n  memorySize: 256,\n  vpc: this.cultureAmpEnvironment.vpcRef(this, SubnetType.Services),\n  securityGroups: [sg],\n});\n")))}l&&l===Object(l)&&Object.isExtensible(l)&&!l.hasOwnProperty("__filemeta")&&Object.defineProperty(l,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"manual/AWS/Adding-Secrets-Via-CLI-or-CDK.md"}}),l.isMDXComponent=!0}}]);
//# sourceMappingURL=component---manual-aws-adding-secrets-via-cli-or-cdk-md-58cc47bd9bde04bd7172.js.map