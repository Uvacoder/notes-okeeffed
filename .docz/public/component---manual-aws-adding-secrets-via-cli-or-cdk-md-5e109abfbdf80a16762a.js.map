{"version":3,"sources":["webpack:///../manual/AWS/Adding-Secrets-Via-CLI-or-CDK.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"mfAMO,IAAMA,EAAe,Q,6NAE5B,IAKMC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,KAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,iBAAQ,CACN,GAAM,iCADR,iCAGA,iBAAQ,CACN,GAAM,aADR,aAGA,sBACE,kBAAIC,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,qFADQ,iBAGpB,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,+EADQ,2BAGpB,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,mFADQ,6BAItB,iBAAQ,CACN,GAAM,uBADR,uBAGA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,eADZ,8XAYL,iBAAQ,CACN,GAAM,yBADR,yBAGA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,eADZ,qFAIL,yCACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,6WAaL,iBAAQ,CACN,GAAM,yBADR,yBAGA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,eADZ,iHAIL,yCACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,0YAWL,iBAAQ,CACN,GAAM,gBADR,gBAGA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,gBADZ,y5C,oNAqDTJ,EAAWK,gBAAiB","file":"component---manual-aws-adding-secrets-via-cli-or-cdk-md-5e109abfbdf80a16762a.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"adding-secrets-via-cli-or-cdk\"\n    }}>{`Adding Secrets Via CLI or CDK`}</h1>\n    <h2 {...{\n      \"id\": \"resources\"\n    }}>{`Resources`}</h2>\n    <ol>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.aws.amazon.com/secretsmanager/latest/userguide/tutorials_basic.html\"\n        }}>{`AWS Tutorial`}</a></li>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.aws.amazon.com/cli/latest/reference/secretsmanager/index.html\"\n        }}>{`AWS CLI secretsmanager`}</a></li>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.aws.amazon.com/cdk/api/latest/docs/aws-secretsmanager-readme.html\"\n        }}>{`AWS CDK Secrets Manager`}</a></li>\n    </ol>\n    <h2 {...{\n      \"id\": \"creating-the-secret\"\n    }}>{`Creating the Secret`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`aws secretsmanager create-secret --name tutorials/MyFirstTutorialSecret --description \"The secret I created for the first tutorial\" --secret-string SUPERSECRET\n\nThe response will look something like so:\n\n\\`\\`\\`json\n{\n  \"ARN\": \"&region-arn;secretsmanager:us-west-2:123456789012:secret:tutorials/MyFirstTutorialSecret-a1b2c3\",\n  \"Name\": \"tutorials/MyFirstTutorialSecret\"\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"describing-the-secret\"\n    }}>{`Describing the Secret`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`aws secretsmanager describe-secret --secret-id tutorials/MyFirstTutorialSecret\n`}</code></pre>\n    <p>{`You'll get back:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"ARN\": \"&region-arn;secretsmanager:region:123456789012:secret:tutorials/MyFirstTutorialSecret-jiObOV\",\n  \"Name\": \"tutorials/MyFirstTutorialSecret\",\n  \"Description\": \"My First Secret\",\n  \"LastChangedDate\": 1522680794.8,\n  \"LastAccessedDate\": 1522627200.0,\n  \"VersionIdsToStages\": {\n    \"EXAMPLE1-90ab-cdef-fedc-ba987EXAMPLE\": [\"AWSCURRENT\"]\n  }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"retrieving-the-secret\"\n    }}>{`Retrieving the Secret`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-s\"\n      }}>{`aws secretsmanager get-secret-value --secret-id tutorials/MyFirstTutorialSecret --version-stage AWSCURRENT\n`}</code></pre>\n    <p>{`You'll get back:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"ARN\": \"&region-arn;secretsmanager:region:123456789012:secret:tutorials/MyFirstTutorialSecret-jiObOV\",\n  \"Name\": \"tutorials/MyFirstTutorialSecret\",\n  \"VersionId\": \"EXAMPLE1-90ab-cdef-fedc-ba987EXAMPLE\",\n  \"SecretString\": \"{\\\\\"username\\\\\":\\\\\"myserviceusername\\\\\",\\\\\"password\\\\\":\\\\\"MyVerySecureP@ssw0rd!\\\\\"}\",\n  \"VersionStages\": [\"AWSCURRENT\"],\n  \"CreatedDate\": 1522680764.668\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"with-the-cdk\"\n    }}>{`With the CDK`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-ts\"\n      }}>{`import secretsManager = require('@aws-cdk/aws-secretsmanager');\n\n// ... further down\nnew Function(this, \\`teams-bot-\\${props.farm}\\`, {\n  projectName: props.projectName,\n  functionName: \\`\\${props.projectName}-teams-bot-\\${props.farm}\\`,\n  code: lambda.Code.fromAsset('../path/to/func.zip'),\n  runtime: lambda.Runtime.NODEJS_12_X,\n  handler: 'index.handler',\n  environment: {\n    ...props.functionEnvVars,\n    MICROSOFT_APP_ID: \\`\\${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'ms-app-id',\n        \\`/\\${props.projectName}/ms-app-id\\`,\n      ).secretValue\n    }\\`,\n    MICROSOFT_APP_PASSWORD: \\`\\${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'ms-app-password',\n        \\`/\\${props.projectName}/ms-app-password\\`,\n      ).secretValue\n    }\\`,\n    OAUTH_CLIENT_ID: \\`\\${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'oauth-client-id',\n        \\`/\\${props.projectName}/oauth-client-id\\`,\n      ).secretValue\n    }\\`,\n    OAUTH_CLIENT_SECRET: \\`\\${\n      secretsManager.Secret.fromSecretArn(\n        this,\n        'oauth-client-secret',\n        \\`/\\${props.projectName}/oauth-client-secret\\`,\n      ).secretValue\n    }\\`,\n    NEW_RELIC_APP_NAME: \\`\\${props.projectName}-teams-bot-\\${props.farm}\\`,\n  },\n  timeout: cdk.Duration.seconds(60),\n  memorySize: 256,\n  vpc: this.cultureAmpEnvironment.vpcRef(this, SubnetType.Services),\n  securityGroups: [sg],\n});\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}