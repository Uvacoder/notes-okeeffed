{"version":3,"sources":["webpack:///../manual/COMP3520-OS/3-Threads.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---manual-comp-3520-os-3-threads-md-ad5c8ecd9b262d59d546.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"week-3---threads\"\n    }}>{`Week 3 - Threads`}</h1>\n    <h2 {...{\n      \"id\": \"processes-and-threads\"\n    }}>{`Processes and Threads`}</h2>\n    <p>{`Processes have two characteristics:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Resource Ownership `}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`process includes a virtual address space to hold the process image `}</li>\n          <li parentName=\"ul\">{`the OS performs a protection function to prevent unwanted interference between processes with respect to resources`}</li>\n        </ul></li>\n      <li parentName=\"ol\">{`Scheduling/Execution`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`follows an execution path that may be interleaved with other processes `}</li>\n          <li parentName=\"ul\">{`a process has an execution state (Running, Ready, etc.) and a dispatching priority and is scheduled and dispatched by the OS`}</li>\n        </ul></li>\n    </ol>\n    <p>{`These two characteristics are treated independently by modern operating systems:\n- the unit of dispatching is referred to as a `}<inlineCode parentName=\"p\">{`thread`}</inlineCode>{` or lightweight process\n- the unit of resource ownership is referred to as a `}<inlineCode parentName=\"p\">{`process`}</inlineCode>{` or `}<inlineCode parentName=\"p\">{`task`}</inlineCode></p>\n    <h2 {...{\n      \"id\": \"multithreading\"\n    }}>{`Multithreading`}</h2>\n    <p>{`The ability of an OS to support multiple, concurrect paths of execution within a single process`}</p>\n    <h2 {...{\n      \"id\": \"process\"\n    }}>{`Process`}</h2>\n    <p>{`The unit of resource allocation and a unit of protection.`}</p>\n    <p>{`A process is associated with: `}</p>\n    <ul>\n      <li parentName=\"ul\">{`A virtual address space which holds the process image `}</li>\n      <li parentName=\"ul\">{`Protected access to\n- Processors\n- Other processes\n- Files\n- I/O resources `}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"multiple-threads-in-process\"\n    }}>{`Multiple threads in Process`}</h2>\n    <p>{`Each thread has:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Access to the memory and resources of its process (all threads of a process share this)`}</li>\n      <li parentName=\"ul\">{`An execution state (running, ready, etc.)`}</li>\n      <li parentName=\"ul\">{`Saved thread context when not running `}</li>\n      <li parentName=\"ul\">{`An execution stack `}</li>\n      <li parentName=\"ul\">{`Some per-thread static storage for local variables`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"single-threaded-vs-multi-threaded\"\n    }}>{`Single-Threaded vs multi threaded`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`Both have `}<inlineCode parentName=\"li\">{`Process Control Block`}</inlineCode></li>\n      <li parentName=\"ul\">{`Both have `}<inlineCode parentName=\"li\">{`User Address Space`}</inlineCode></li>\n      <li parentName=\"ul\">{`Single thread has a `}<inlineCode parentName=\"li\">{`User Stack`}</inlineCode>{` and `}<inlineCode parentName=\"li\">{`Kernel Stack`}</inlineCode></li>\n      <li parentName=\"ul\">{`Multithread process has a `}<inlineCode parentName=\"li\">{`User Stack`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`Kernel Stack`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`Thread Control Block`}</inlineCode>{` within each thread`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"threads\"\n    }}>{`Threads`}</h2>\n    <p>{`In OS that supports threads: scheduling and dispatching done on thread basis `}</p>\n    <ul>\n      <li parentName=\"ul\">{`Most of the state info dealing with execution is maintained in thread-level data structures `}</li>\n      <li parentName=\"ul\">{`Several actions that affect all of the threads in a process and that the OS must manage at the process level\n- Suspending process means all threads of a process\n- Terminates a process terminates all threads within the process `}</li>\n      <li parentName=\"ul\">{`Similar to processes, threads have execution states and may synchronize with one another.`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"thread-execution-states\"\n    }}>{`Thread Execution States`}</h2>\n    <p>{`Three basic states`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Running `}</li>\n      <li parentName=\"ol\">{`Ready `}</li>\n      <li parentName=\"ol\">{`Blocked `}</li>\n    </ol>\n    <p>{`Operations associated with a change in thread state `}</p>\n    <ul>\n      <li parentName=\"ul\">{`Spawn (another thread)\n- allocate register context and stacks `}</li>\n      <li parentName=\"ul\">{`Block\n- move to an event queue waiting for the event\n- issue: will blocking a thread block other, or all, threads within the same process?`}</li>\n      <li parentName=\"ul\">{`Unblock\n- moved the the `}<inlineCode parentName=\"li\">{`Ready`}</inlineCode>{` queue for execution`}</li>\n      <li parentName=\"ul\">{`Finish (thread)\n- de-allocate register context and stacks `}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"thread-synchronization\"\n    }}>{`Thread Synchronization`}</h2>\n    <p>{`Necessity to sync activities of all threads and prevent interference between each other.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`all threads of a process share the same address space and other resources `}</li>\n      <li parentName=\"ul\">{`any alteration of a resource by one thread affects the other threads in the same process `}</li>\n    </ul>\n    <p>{`In general, the techniques used for thread sync are the same as those for process sync.`}</p>\n    <h2 {...{\n      \"id\": \"types-of-threads\"\n    }}>{`Types of Threads`}</h2>\n    <ol>\n      <li parentName=\"ol\">{`User Level Thread (ULT)`}</li>\n      <li parentName=\"ol\">{`Kernel Level Thread (KLT) `}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`also called kernel-supported threads or lightweight threads`}</li>\n        </ul></li>\n    </ol>\n    <h2 {...{\n      \"id\": \"user-level-threads\"\n    }}>{`User-Level Threads`}</h2>\n    <p>{`Thread management all done by application.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Multithreading is managed by a runtime threads lib `}</li>\n    </ul>\n    <p>{`The kernel is not aware of the existence of threads `}</p>\n    <ul>\n      <li parentName=\"ul\">{`Only schedule the process as a unit and assigns a single execution state to that process `}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"disadvantages-of-ult\"\n    }}>{`Disadvantages of ULT`}</h2>\n    <p>{`In a typical OS many system calls are blocking `}</p>\n    <ul>\n      <li parentName=\"ul\">{`as a result, when a ULT executes a system call, not only is the thread blocked, but all within the process are blocked `}</li>\n    </ul>\n    <p>{`In a pure ULT strategy, multithreaded applications cannot take advantage of multiprocessing.`}</p>\n    <h2 {...{\n      \"id\": \"kernel-level-threads\"\n    }}>{`Kernel-Level Threads`}</h2>\n    <p>{`Kernel maintains context information for the process and the threads. `}</p>\n    <ul>\n      <li parentName=\"ul\">{`No thread management done by application `}</li>\n    </ul>\n    <p>{`Scheduling is done on a thread basis.`}</p>\n    <p>{`Windows is an example of this approach.`}</p>\n    <h2 {...{\n      \"id\": \"advantages-of-klt\"\n    }}>{`Advantages of KLT`}</h2>\n    <p>{`The kernel can simultaneously schedule multiple threads from the same process on multiple processors.`}</p>\n    <p>{`If one thread is blocked, the kernel schedules another thread of the same process.`}</p>\n    <p>{`Kernel routines themselves can be multithreaded.`}</p>\n    <h2 {...{\n      \"id\": \"multicore--multithreading\"\n    }}>{`Multicore & Multithreading`}</h2>\n    <p>{`Achieves concurrency without the overhead of using multiple processes.`}</p>\n    <p>{`Threads within the same process can exchange information through their common address space and have access to the shared resources of the process.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Threads of any process can run on any processor`}</li>\n      <li parentName=\"ul\">{`Soft affinity:\n- dispatcher tries to assign a ready thread to the same processor it last ran on\n- helps reuse data still in that processor's memory caches from the previous execution of the thread `}</li>\n      <li parentName=\"ul\">{`Hard affinity:\n- an application restricts thread execution to certain processors`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"multicore-challenges\"\n    }}>{`Multicore Challenges`}</h2>\n    <ul>\n      <li parentName=\"ul\">{`Dividing activities `}</li>\n      <li parentName=\"ul\">{`Balance `}</li>\n      <li parentName=\"ul\">{`Data splitting `}</li>\n      <li parentName=\"ul\">{`Data dependency `}</li>\n      <li parentName=\"ul\">{`Testing and debugging `}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"linux-threads\"\n    }}>{`Linux Threads`}</h2>\n    <p>{`Linux uses the same internal representation for processes and threads; a thread is simply a new process (or task) that happens to share the same address space as its parent.`}</p>\n    <p>{`A distinction is only made when a new thread is created by the `}<inlineCode parentName=\"p\">{`clone`}</inlineCode>{` system call\n- `}<inlineCode parentName=\"p\">{`fork`}</inlineCode>{` creates a new process with its own entirely new process context\n- `}<inlineCode parentName=\"p\">{`clone`}</inlineCode>{` creates a new process with its own identity, but that is allowed to share the data structures of its parent`}</p>\n    <p>{`Using `}<inlineCode parentName=\"p\">{`clone`}</inlineCode>{` gives the application fine-grained control over exactly what is shared between two threads.`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`flag`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`meaning`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`CLONE_FS`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`File-system info is shared`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`CLONE_VM`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The same mem space is shared`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`CLONE_SIGHAND`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Signal handlers are shared`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`CLONE_FILES`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The set of open files are shared`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <h2 {...{\n      \"id\": \"windows-threads\"\n    }}>{`Windows Threads`}</h2>\n    <p>{`Processes and servies provided by the Windows Kernel are relatively simple and general purpose.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`implemented as objects `}</li>\n      <li parentName=\"ul\">{`created as new process or a copy of an existing process `}</li>\n      <li parentName=\"ul\">{`exec proc may contain one or more threads `}</li>\n      <li parentName=\"ul\">{`both procs and thread objects have built-in sync capabilities`}</li>\n    </ul>\n    <p>{`Windows makes use of two types of process-related objects:`}</p>\n    <p><strong parentName=\"p\">{`Processes`}</strong>{`\n– an entity corresponding to a user job or application that owns resources`}</p>\n    <p><strong parentName=\"p\">{`Threads`}</strong>{`\n– a dispatchable unit of work that executes sequentially and is interruptible`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}