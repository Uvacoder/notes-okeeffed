(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{"/6aV":function(n,e,t){"use strict";t.r(e),t.d(e,"_frontmatter",(function(){return o})),t.d(e,"default",(function(){return u}));t("1c7q"),t("abGl"),t("gZHo"),t("Fdmb"),t("Ir+3"),t("2mQt"),t("mXGw");var i=t("/FXl"),r=t("TjRS");t("aD51");function a(){return(a=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n}).apply(this,arguments)}var o={};void 0!==o&&o&&o===Object(o)&&Object.isExtensible(o)&&!o.hasOwnProperty("__filemeta")&&Object.defineProperty(o,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"manual/AWS/Lambda-Edge-CDK.md"}});var s={_frontmatter:o},c=r.a;function u(n){var e=n.components,t=function(n,e){if(null==n)return{};var t,i,r={},a=Object.keys(n);for(i=0;i<a.length;i++)t=a[i],e.indexOf(t)>=0||(r[t]=n[t]);return r}(n,["components"]);return Object(i.b)(c,a({},s,t,{components:e,mdxType:"MDXLayout"}),Object(i.b)("h1",{id:"lambda-edge-cdk"},"Lambda Edge CDK"),Object(i.b)("pre",null,Object(i.b)("code",a({parentName:"pre"},{className:"language-ts"}),"// Origin request handler.\nconst myOriginRequestHandler = new lambdaNodejs.NodejsFunction(\n  this,\n  'OriginRequestHandler',\n  {\n    entry: 'src/lambda/myOriginRequestHandler.ts',\n    handler: 'myOriginRequestHandler',\n    runtime: lambda.Runtime.NODEJS_10_X,\n  },\n);\n\n// A numbered version to give to cloudfront\nconst myOriginRequestHandlerVersion = new lambda.Version(\n  this,\n  'OriginRequestHandlerVersion',\n  {\n    lambda: myOriginRequestHandler,\n  },\n);\n\n// A bucket to serve content from\nconst myBucket = new s3.Bucket(this, 'OriginBucket');\n\n// Origin access identity for cloudfront to access the bucket\nconst myCdnOai = new cloudfront.OriginAccessIdentity(this, 'CdnOai');\nmyBucket.grantRead(myCdnOai);\n\n// The CDN web distribution\nnew cloudfront.CloudFrontWebDistribution(this, 'Cdn', {\n  originConfigs: [\n    {\n      s3OriginSource: {\n        s3BucketSource: myBucket,\n        originAccessIdentity: myCdnOai,\n      },\n      behaviors: [\n        {\n          isDefaultBehavior: true,\n          lambdaFunctionAssociations: [\n            {\n              eventType: cloudfront.LambdaEdgeEventType.ORIGIN_REQUEST,\n              lambdaFunction: myOriginRequestHandlerVersion,\n            },\n          ],\n        },\n      ],\n    },\n  ],\n});\n")),Object(i.b)("p",null,"I believe you need to mix it in with this to get things going:"),Object(i.b)("pre",null,Object(i.b)("code",a({parentName:"pre"},{className:"language-ts"}),"new cdk.CfnOutput(this, 'DistributionId', {\n  value: distribution.distributionId,\n});\n\n// Route53 alias record for the CloudFront distribution\nnew route53.ARecord(this, 'SiteAliasRecord', {\n  recordName: siteDomain,\n  target: route53.RecordTarget.fromAlias(\n    new targets.CloudFrontTarget(distribution),\n  ),\n  zone,\n});\n")),Object(i.b)("h2",{id:"resources"},"Resources"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},Object(i.b)("a",a({parentName:"li"},{href:"https://github.com/aws/aws-cdk/issues/6259"}),"AWS Issue - Docs on Lambda@edge"))))}u&&u===Object(u)&&Object.isExtensible(u)&&!u.hasOwnProperty("__filemeta")&&Object.defineProperty(u,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"manual/AWS/Lambda-Edge-CDK.md"}}),u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---manual-aws-lambda-edge-cdk-md-1cd7c51e74847ba2225b.js.map