{"version":3,"sources":["webpack:///../manual/Dotnet/Adding-Models.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---manual-dotnet-adding-models-md-65368368f7328330d497.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"adding-models\"\n    }}>{`Adding Models`}</h1>\n    <h2 {...{\n      \"id\": \"resources\"\n    }}>{`Resources`}</h2>\n    <ol>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-mvc-app/adding-model?view=aspnetcore-3.1&tabs=visual-studio\"\n        }}>{`Microsoft Docs: Add a model to an ASP.NET Core MVC app`}</a></li>\n      <li parentName=\"ol\"><a parentName=\"li\" {...{\n          \"href\": \"https://docs.microsoft.com/en-us/dotnet/api/system.componentmodel.dataannotations?view=netframework-4.8\"\n        }}>{`DataAnnotatons used in tutorial`}</a></li>\n    </ol>\n    <h2 {...{\n      \"id\": \"add-a-data-model-class\"\n    }}>{`Add a data model class`}</h2>\n    <p>{`Update the `}<inlineCode parentName=\"p\">{`Models/Movie.cs`}</inlineCode>{` file with the following code:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-csharp\"\n      }}>{`using System;\nusing System.ComponentModel.DataAnnotations;\n\nnamespace MvcMovie.Models\n{\n    public class Movie\n    {\n        public int Id { get; set; }\n        public string Title { get; set; }\n\n        [DataType(DataType.Date)]\n        public DateTime ReleaseDate { get; set; }\n        public string Genre { get; set; }\n        public decimal Price { get; set; }\n    }\n}\n`}</code></pre>\n    <ul>\n      <li parentName=\"ul\">{`The Movie class contains an `}<inlineCode parentName=\"li\">{`Id`}</inlineCode>{` field, which is required by the database for the primary key.`}</li>\n      <li parentName=\"ul\">{`The DataType attribute on ReleaseDate specifies the type of the data (Date). With this attribute:`}<ol parentName=\"li\">\n          <li parentName=\"ol\">{`The user is not required to enter time information in the date field.`}</li>\n          <li parentName=\"ol\">{`Only the date is displayed, not time information.`}</li>\n        </ol></li>\n    </ul>\n    <p>{`DataAnnotations are covered in a later tutorial.`}</p>\n    <h2 {...{\n      \"id\": \"add-nuget-packages\"\n    }}>{`Add NuGet Packages`}</h2>\n    <p>{`Reference `}<strong parentName=\"p\">{`Resource `}{`[1]`}</strong>{` in order to see installation examples for Visual Studio for Mac.`}</p>\n    <p><em parentName=\"p\">{`Note: I haven't confirmed, but you may be able to get away with installing through dotnet CLI. From what I see later in the tutorial, NuGet may be required.`}</em></p>\n    <p>{`Packages required in this tutorial:`}</p>\n    <ol>\n      <li parentName=\"ol\">{`Microsoft.EntityFrameworkCore.SQLite`}</li>\n      <li parentName=\"ol\">{`Microsoft.VisualStudio.Web.CodeGeneration.Design (likely not needed if installing by CLI)`}</li>\n      <li parentName=\"ol\">{`Microsoft.EntityFrameworkCore.SqlServer`}</li>\n      <li parentName=\"ol\">{`Microsoft.EntityFrameworkCore.Design`}</li>\n    </ol>\n    <h2 {...{\n      \"id\": \"create-database-context-class\"\n    }}>{`Create database context class`}</h2>\n    <p>{`A database context class is needed to coordinate EF Core functionality (Create, Read, Update, Delete) for the Movie model. The database context is derived from `}<inlineCode parentName=\"p\">{`Microsoft.EntityFrameworkCore.DbContext`}</inlineCode>{` and specifies the entities to include in the data model.`}</p>\n    <p>{`Create a Data folder.`}</p>\n    <p>{`Add a Data/MvcMovieContext.cs file with the following code:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-cs\"\n      }}>{`using Microsoft.EntityFrameworkCore;\nusing MvcMovie.Models;\n\nnamespace MvcMovie.Data\n{\n    public class MvcMovieContext : DbContext\n    {\n        public MvcMovieContext (DbContextOptions<MvcMovieContext> options)\n            : base(options)\n        {\n        }\n\n        public DbSet<Movie> Movie { get; set; }\n    }\n}\n`}</code></pre>\n    <p>{`The preceding code creates a `}<inlineCode parentName=\"p\">{`DbSet<Movie>`}</inlineCode>{` property for the entity set. In Entity Framework terminology, an entity set typically corresponds to a database table. An entity corresponds to a row in the table.`}</p>\n    <h2 {...{\n      \"id\": \"register-the-database-context\"\n    }}>{`Register the database context`}</h2>\n    <p>{`ASP.NET Core is built with dependency injection (DI). Services (such as the EF Core DB context) must be registered with DI during application startup. Components that require these services (such as Razor Pages) are provided these services via constructor parameters. The constructor code that gets a DB context instance is shown later in the tutorial. In this section, you register the database context with the DI container.`}</p>\n    <p>{`Add to the top of Startup.cs:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-cs\"\n      }}>{`using MvcMovie.Data;\nusing Microsoft.EntityFrameworkCore;\n`}</code></pre>\n    <p>{`Add the following for `}<inlineCode parentName=\"p\">{`Startup.ConfigureServices`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-cs\"\n      }}>{`public void ConfigureServices(IServiceCollection services)\n{\n    services.AddControllersWithViews();\n\n    services.AddDbContext<MvcMovieContext>(options =>\n            options.UseSqlite(Configuration.GetConnectionString(\"MvcMovieContext\")));\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"add-a-database-connection-string\"\n    }}>{`Add a database connection string`}</h2>\n    <p>{`Add `}<inlineCode parentName=\"p\">{`ConnectionStrings`}</inlineCode>{` config to `}<inlineCode parentName=\"p\">{`appsettings.json`}</inlineCode>{`:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n  \"Logging\": {\n    \"LogLevel\": {\n      \"Default\": \"Information\",\n      \"Microsoft\": \"Warning\",\n      \"Microsoft.Hosting.Lifetime\": \"Information\"\n    }\n  },\n  \"AllowedHosts\": \"*\",\n  \"ConnectionStrings\": {\n    \"MvcMovieContext\": \"Data Source=MvcMovie.db\"\n  }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"scaffold-movie-pages\"\n    }}>{`Scaffold movie pages`}</h2>\n    <p>{`Use the scaffolding tool to produce Create, Read, Update, and Delete (CRUD) pages for the movie model.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`dotnet aspnet-codegenerator controller -name MoviesController -m Movie -dc MvcMovieContext --relativeFolderPath Controllers --useDefaultLayout --referenceScriptLibraries\n`}</code></pre>\n    <p>{`The following table details the ASP.NET Core code generator parameters:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Parameter`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`-m`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The name of the model.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`-dc`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The data context.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`-udl`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Use the default layout.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`--relativeFolderPath`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The relative output folder path to create the files.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`--useDefaultLayout`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`The default layout should be used for the views.`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`--referenceScriptLibraries`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Adds `}{`_`}{`ValidationScriptsPartial to Edit and Create pages`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`Note: for more help run `}<inlineCode parentName=\"p\">{`dotnet aspnet-codegenerator controller -h`}</inlineCode></p>\n    <h2 {...{\n      \"id\": \"initial-migration\"\n    }}>{`Initial migration`}</h2>\n    <p>{`Use the EF Core Migrations feature to create the database. Migrations is a set of tools that let you create and update a database to match your data model.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`dotnet ef migrations add InitialCreate\ndotnet ef database update\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"the-initialcreate-class\"\n    }}>{`The InitialCreate class`}</h2>\n    <p>{`Examine the `}<inlineCode parentName=\"p\">{`Migrations/{timestamp}_InitialCreate.cs`}</inlineCode>{` migration file:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-cs\"\n      }}>{`public partial class Initial : Migration\n{\n    protected override void Up(MigrationBuilder migrationBuilder)\n    {\n        migrationBuilder.CreateTable(\n            name: \"Movie\",\n            columns: table => new\n            {\n                Id = table.Column<int>(nullable: false)\n                    .Annotation(\"SqlServer:ValueGenerationStrategy\",\n                                 SqlServerValueGenerationStrategy.IdentityColumn),\n                Title = table.Column<string>(nullable: true),\n                ReleaseDate = table.Column<DateTime>(nullable: false),\n                Genre = table.Column<string>(nullable: true),\n                Price = table.Column<decimal>(nullable: false)\n            },\n            constraints: table =>\n            {\n                table.PrimaryKey(\"PK_Movie\", x => x.Id);\n            });\n    }\n\n    protected override void Down(MigrationBuilder migrationBuilder)\n    {\n        migrationBuilder.DropTable(\n            name: \"Movie\");\n    }\n}\n`}</code></pre>\n    <p>{`The `}<inlineCode parentName=\"p\">{`Up`}</inlineCode>{` method creates the `}<inlineCode parentName=\"p\">{`Movie`}</inlineCode>{` table and configures `}<inlineCode parentName=\"p\">{`Id`}</inlineCode>{` as the primary key. The `}<inlineCode parentName=\"p\">{`Down`}</inlineCode>{` method reverts the schema changes made by the `}<inlineCode parentName=\"p\">{`Up`}</inlineCode>{` migration.`}</p>\n    <h2 {...{\n      \"id\": \"dependency-injection-in-the-controller\"\n    }}>{`Dependency injection in the controller`}</h2>\n    <p>{`Finish off the tutorial notes `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-mvc-app/adding-model?view=aspnetcore-3.1&tabs=visual-studio-mac#dependency-injection-in-the-controller\"\n      }}>{`from here`}</a></p>\n    <p>{`Note: Stopping since the context is enough for other work to be completed.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}