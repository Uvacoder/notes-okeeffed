(window.webpackJsonp=window.webpackJsonp||[]).push([[271],{XEUw:function(e,n,a){"use strict";a.r(n),a.d(n,"_frontmatter",(function(){return o})),a.d(n,"default",(function(){return p}));a("1c7q"),a("abGl"),a("gZHo"),a("Fdmb"),a("Ir+3"),a("2mQt"),a("mXGw");var t=a("/FXl"),r=a("TjRS");a("aD51");function s(){return(s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])}return e}).apply(this,arguments)}var o={};void 0!==o&&o&&o===Object(o)&&Object.isExtensible(o)&&!o.hasOwnProperty("__filemeta")&&Object.defineProperty(o,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"manual/iOS/PassKit.md"}});var i={_frontmatter:o},l=r.a;function p(e){var n=e.components,a=function(e,n){if(null==e)return{};var a,t,r={},s=Object.keys(e);for(t=0;t<s.length;t++)a=s[t],n.indexOf(a)>=0||(r[a]=e[a]);return r}(e,["components"]);return Object(t.b)(l,s({},i,a,{components:n,mdxType:"MDXLayout"}),Object(t.b)("h1",{id:"passkit"},"PassKit"),Object(t.b)("ul",null,Object(t.b)("li",{parentName:"ul"},Object(t.b)("a",s({parentName:"li"},{href:"#passkit"}),"PassKit"),"\n- ",Object(t.b)("a",s({parentName:"li"},{href:"#adding-the-certificate"}),"Adding the certificate"),"\n- ",Object(t.b)("a",s({parentName:"li"},{href:"#php-server"}),"PHP Server"),"\n- ",Object(t.b)("a",s({parentName:"li"},{href:"#plan-ticket-example"}),"Plan ticket example"),"\n- ",Object(t.b)("a",s({parentName:"li"},{href:"#store-card-example"}),"Store card example"),"\n- ",Object(t.b)("a",s({parentName:"li"},{href:"#more-info"}),"More info"))),Object(t.b)("h2",{id:"adding-the-certificate"},"Adding the certificate"),Object(t.b)("p",null,"Head to the iOS dev portal and add the appropriate certificate."),Object(t.b)("p",null,"You may need to open Keychain access to generate a new key using ",Object(t.b)("inlineCode",{parentName:"p"},"Keychain Access > Certificate Assistant > Req Cert from Cert Auth")," and generate a new cert. This cert will be used to generate what you need to import into Keychain Access from the dev portal."),Object(t.b)("p",null,"Once created, export it to a folder for the server."),Object(t.b)("h2",{id:"php-server"},"PHP Server"),Object(t.b)("p",null,"Using ",Object(t.b)("inlineCode",{parentName:"p"},"composer"),", you can build out a scaffold using the Slim Framework:"),Object(t.b)("p",null,Object(t.b)("inlineCode",{parentName:"p"},"composer create-project slim/slim-skeleton [project-name]"),"."),Object(t.b)("p",null,"To install the PHP PassKit helper, run ",Object(t.b)("inlineCode",{parentName:"p"},"composer require pkpass/pkpass"),"."),Object(t.b)("p",null,"Once built, you can then hit the routes and just require the pkpass and the routes file may end up looking like this:"),Object(t.b)("h3",{id:"plan-ticket-example"},"Plan ticket example"),Object(t.b)("pre",null,Object(t.b)("code",s({parentName:"pre"},{className:"language-php"}),"<?php\n// Routes\nuse PKPass\\PKPass;\n\n$app->get('/', function ($request, $response, $args) {\n    // Sample log message\n    $this->logger->info(\"Slim-Skeleton '/' route\");\n\n    // Render index view\n    return $this->renderer->render($response, 'sample.phtml', $args);\n});\n\n$app->get('/pass', function ($request, $response, $args) {\n    // Sample log message\n    $this->logger->info(\"Slim-Skeleton '/pass' route\");\n\n    $pass = new PKPass('<name>.p12', '<insert-password>');\n\n    // Pass content\n    $data = [\n        'description' => 'Demo pass',\n        'formatVersion' => 1,\n        'organizationName' => 'Flight Express',\n        'passTypeIdentifier' => 'pass.com.<teamname>.<passname>', // Change this!\n        'serialNumber' => '12345678',\n        'teamIdentifier' => '<insert-team-id>', // Change this! Found on Apple Dev Portal\n        'boardingPass' => [\n            'primaryFields' => [\n                [\n                    'key' => 'origin',\n                    'label' => 'San Francisco',\n                    'value' => 'SFO',\n                ],\n                [\n                    'key' => 'destination',\n                    'label' => 'London',\n                    'value' => 'LHR',\n                ],\n            ],\n            'secondaryFields' => [\n                [\n                    'key' => 'gate',\n                    'label' => 'Gate',\n                    'value' => 'F12',\n                ],\n                [\n                    'key' => 'date',\n                    'label' => 'Departure date',\n                    'value' => '07/11/2012 10:22',\n                ],\n            ],\n            'backFields' => [\n                [\n                    'key' => 'passenger-name',\n                    'label' => 'Passenger',\n                    'value' => 'John Appleseed',\n                ],\n            ],\n            'transitType' => 'PKTransitTypeAir',\n        ],\n        'barcode' => [\n            'format' => 'PKBarcodeFormatQR',\n            'message' => 'Flight-GateF12-ID6643679AH7B',\n            'messageEncoding' => 'iso-8859-1',\n        ],\n        'backgroundColor' => 'rgb(32,110,247)',\n        'logoText' => 'Flight info',\n        'relevantDate' => date('Y-m-d\\TH:i:sP')\n    ];\n\n    $pass->setWWDRcertPath('<path to wwdr.pem>');\n    $pass->setData($data);\n\n    // Add files to the pass package\n    $pass->addFile('public/icon.png');\n    $pass->addFile('public/icon@2x.png');\n    $pass->addFile('public/logo.png');\n\n    if($pass->checkError($error) == true) {\n        // echo $error;\n        // exit('An error occured: ' . $error);\n    }\n\n    // echo 'Here';\n\n    $result = $pass->create(true);\n    if($result == false) {\n        echo $pass->getError();\n    }\n    // Render index view\n    return $result;\n});\n")),Object(t.b)("h3",{id:"store-card-example"},"Store card example"),Object(t.b)("pre",null,Object(t.b)("code",s({parentName:"pre"},{className:"language-php"}),"<?php\n// Routes\nuse PKPass\\PKPass;\n\n$app->get('/', function ($request, $response, $args) {\n    // Sample log message\n    $this->logger->info(\"Slim-Skeleton '/' route\");\n\n    // Render index view\n    return $this->renderer->render($response, 'sample.phtml', $args);\n});\n\n$app->get('/pass', function ($request, $response, $args) {\n    // Sample log message\n    $this->logger->info(\"Slim-Skeleton '/pass' route\");\n\n    $pass = new PKPass('<key-path>', 'password');\n\n    // Pass content\n    $data = [\n        'formatVersion' => 1,\n        'organizationName' => 'Testing',\n        'passTypeIdentifier' => 'pass.com.<id>.<app>', // Change this!\n        'serialNumber' => '12345678',\n        'teamIdentifier' => '<team-id>', // Change this!\n        'logoText' => 'Loyalty',\n        'description' => 'Rewards card',\n        'storeCard' => [\n            'secondaryFields' => [\n                [\n                    'key' => 'balance',\n                    'label' => 'BALANCE',\n                    'value' => '$250.00'\n                ],\n                [\n                    'key' => 'name',\n                    'label' => 'NICKNAME',\n                    'value' => 'Denno'\n                ],\n            ],\n            'backFields' => [\n                [\n                    'key' => 'owner-name',\n                    'label' => 'Rewards Card',\n                    'value' => 'John Appleseed'\n                ],\n            ]\n        ],\n        'barcode' => [\n            'format' => 'PKBarcodeFormatPDF417',\n            'message' => 'ID6643679AH7B',\n            'messageEncoding' => 'iso-8859-1',\n            'altText' => 'ID6643679AH7B'\n        ],\n        'backgroundColor' => 'rgb(32,110,247)',\n        'logoText' => 'Dummy card info'\n    ];\n\n    $pass->setWWDRcertPath('<wwdr-key>');\n    $pass->setData($data);\n\n    // Add files to the pass package\n    $pass->addFile('public/icon.png');\n    $pass->addFile('public/icon@2x.png');\n    $pass->addFile('public/logo.png');\n\n    if($pass->checkError($error) == true) {\n        // echo $error;\n        // exit('An error occured: ' . $error);\n    }\n\n    // echo 'Here';\n\n    $result = $pass->create(true);\n    if($result == false) {\n        echo $pass->getError();\n    }\n    // Render index view\n    return $result;\n});\n\n?>\n")),Object(t.b)("h2",{id:"more-info"},"More info"),Object(t.b)("p",null,"If you need to generate a wwdr cert, you can globally install ",Object(t.b)("inlineCode",{parentName:"p"},"passbook")," eg. ",Object(t.b)("inlineCode",{parentName:"p"},"node install -g passbook")," and run a command like ",Object(t.b)("inlineCode",{parentName:"p"},"node-passbook prepare-keys -p <folder-hosting-exported-keys>")," and it can do the conversion for you. Make sure you don't forget the password, though."),Object(t.b)("p",null,"Some changes you may need to make are passing ",Object(t.b)("inlineCode",{parentName:"p"},"POST")," variables to change it for each user."),Object(t.b)("p",null,"If you need to change the JSON structure above, refer to ",Object(t.b)("a",s({parentName:"p"},{href:"https://developer.apple.com/library/content/documentation/UserExperience/Reference/PassKit_Bundle/Chapters/Introduction.html"}),"https://developer.apple.com/library/content/documentation/UserExperience/Reference/PassKit_Bundle/Chapters/Introduction.html")," for more info."))}p&&p===Object(p)&&Object.isExtensible(p)&&!p.hasOwnProperty("__filemeta")&&Object.defineProperty(p,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"manual/iOS/PassKit.md"}}),p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---manual-i-os-pass-kit-md-3f13869c9ad2be2cc860.js.map