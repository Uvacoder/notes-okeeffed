(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{zFFg:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return l})),n.d(t,"default",(function(){return s}));n("1c7q"),n("abGl"),n("gZHo"),n("Fdmb"),n("Ir+3"),n("2mQt"),n("mXGw");var a=n("/FXl"),o=n("TjRS");n("aD51");function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var l={};void 0!==l&&l&&l===Object(l)&&Object.isExtensible(l)&&!l.hasOwnProperty("__filemeta")&&Object.defineProperty(l,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"manual/AWS/AWS-CloudFormation-MasterClass.md"}});var i={_frontmatter:l},c=o.a;function s(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["components"]);return Object(a.b)(c,r({},i,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h1",{id:"cloudformation-master-class"},"CloudFormation Master Class"),Object(a.b)("h2",{id:"what-is-cloudformation"},"What is CloudFormation"),Object(a.b)("p",null,"Having >50 services, CloudFormation was brought in to help develops scaffold out the requires AWS stack."),Object(a.b)("p",null,"Eg. I want a security group, two EC2 machines with it, two elastic IPs, an S3 bucket + a load balancer in front."),Object(a.b)("p",null,"CloudFormation will create all of this in the right order with the exact config."),Object(a.b)("h2",{id:"benefits"},"Benefits"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Infrastructure as code",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"No manual creation"),Object(a.b)("li",{parentName:"ul"},"Can be version controlled"),Object(a.b)("li",{parentName:"ul"},"Changes to infrastructure are reviewed through code"))),Object(a.b)("li",{parentName:"ol"},"Cost",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"Each resource will be tagged so you can estimate the costs and figure out which costs what"),Object(a.b)("li",{parentName:"ul"},"Great savings strategy"))),Object(a.b)("li",{parentName:"ol"},"Productivity",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"Ability to destroy and re-create an infrastructure"),Object(a.b)("li",{parentName:"ul"},"Automated generation of Diagram for templates"),Object(a.b)("li",{parentName:"ul"},"All declarative"))),Object(a.b)("li",{parentName:"ol"},"Separation of concern",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"Many different stacks for many different layers"))),Object(a.b)("li",{parentName:"ol"},"Don't re-invent the wheel",Object(a.b)("ul",{parentName:"li"},Object(a.b)("li",{parentName:"ul"},"Already so many templates"),Object(a.b)("li",{parentName:"ul"},"Leverage the docs")))),Object(a.b)("h2",{id:"cloudformation-vs-ansible--terraform"},"CloudFormation vs Ansible / Terraform"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"CF is native, and also contain the latest"),Object(a.b)("li",{parentName:"ul"},"CF is state based"),Object(a.b)("li",{parentName:"ul"},"The others are instruction based - difficult to orchestrate"),Object(a.b)("li",{parentName:"ul"},"For new services, Ansible / Terraform can take a long time")),Object(a.b)("h2",{id:"first-template"},"First template"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"---\nResources:\n  MyInstance:\n    Type: AWS::EC2::Instance\n    Properties:\n      AvailabilityZone: us-east-1a\n      ImageId: ami-a4c7edb2\n      InstanceType: t2.micro\n")),Object(a.b)("p",null,"The stack instance can be created, updated or destroyed."),Object(a.b)("p",null,"You cannot edit the stack itself later, you need to just re-update the stack by uploading a new file."),Object(a.b)("p",null,"The stack itself can clean up instances after itself too."),Object(a.b)("h2",{id:"yaml-intro"},"YAML Intro"),Object(a.b)("p",null,"You can use YAML or JSON for writing it - but JSON is tough for it"),Object(a.b)("p",null,"Array support:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),"product:\n    - test  : 1\n      quantity: 2\n    - test  : 2\n      quantity: 4\n")),Object(a.b)("h2",{id:"creating-a-s3-bucket"},"Creating a S3 Bucket"),Object(a.b)("p",null,"Googling for the type, you will get the in depth docs from AWS."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{}),'---\nResources: # always the start\n    MyS3Bucket: # template name\n        Type: "AWS::S3::Bucket"\n        Properties:\n            AccessControl: PublicRead\n            BucketName: "www.site.com"\n')),Object(a.b)("h3",{id:"types-of-updates"},"Types of updates"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Updates with no interruption"),Object(a.b)("li",{parentName:"ol"},"Replacements are breaking and need to replace the resource")),Object(a.b)("h3",{id:"properties"},"Properties"),Object(a.b)("p",null,"On the properties under the docs, you can see info about the properties."),Object(a.b)("h3",{id:"deleting-the-stack"},"Deleting the stack"),Object(a.b)("p",null,"Just right click on the CloudFormation and delete the resources."),Object(a.b)("h2",{id:"cloudformation-template-options"},"CloudFormation template options"),Object(a.b)("p",null,"You have a few template options:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Tags"),Object(a.b)("li",{parentName:"ol"},"Permissions (IAM role)"),Object(a.b)("li",{parentName:"ol"},"Notifications Options (SNS topic)"),Object(a.b)("li",{parentName:"ol"},"Timeouts (minutes before calling failure)"),Object(a.b)("li",{parentName:"ol"},"Rollback on Failure"),Object(a.b)("li",{parentName:"ol"},"Stack Policy")),Object(a.b)("p",null,'These (if you manually do it) all show up on the "create stack" part of CloudFormation.'),Object(a.b)("p",null,"The template review also gives you an opportunity to estimate cost."),Object(a.b)("h2",{id:"cloudformation-designer"},"CloudFormation Designer"),Object(a.b)("p",null,"A visual aid to help build the CF Stack. Ensure the template is also well written."),Object(a.b)("p",null,"You can drag and drop basically everything. Dropping it will give you options to selecting documentation etc."),Object(a.b)("p",null,"It's great for dragging and dropping templates and giving information on that template as well."),Object(a.b)("h2",{id:"building-blocks"},"Building Blocks"),Object(a.b)("p",null,"There are a number of building blocks for each template:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Resources: your AWS resources declared in the template"),Object(a.b)("li",{parentName:"ol"},"Parameters: the dynamic inputs for your template"),Object(a.b)("li",{parentName:"ol"},"Mappings: the static variables for your template"),Object(a.b)("li",{parentName:"ol"},"Outputs: References to what has been created"),Object(a.b)("li",{parentName:"ol"},"Conditionals: List of conditions to perform resource creation"),Object(a.b)("li",{parentName:"ol"},"Metadata")),Object(a.b)("h2",{id:"template-helpers"},"Template helpers"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"References"),Object(a.b)("li",{parentName:"ol"},"Functions")),Object(a.b)("h2",{id:"cloudformation-parameters"},"CloudFormation Parameters"),Object(a.b)("h3",{id:"overview"},"Overview"),Object(a.b)("p",null,"What are they? The way to provide inputs to your AWS CloudFormation template."),Object(a.b)("p",null,"They're important to know about it:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"You want to reuse your templates across the company"),Object(a.b)("li",{parentName:"ol"},"Some inputs can not be determined ahead of time")),Object(a.b)("p",null,"The major benefit: you won't have to re-upload a template to change its content."),Object(a.b)("h3",{id:"theory-and-hands-on"},"Theory and hands on"),Object(a.b)("p",null,"Parameters can be controlled by all these settings:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Type:")),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"String"),Object(a.b)("li",{parentName:"ul"},"Number"),Object(a.b)("li",{parentName:"ul"},"CommaDelimitedList"),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"List<Type>")),Object(a.b)("li",{parentName:"ul"},"AWS Parameter (to help catch invalid values - match against existing values in the AWS Account)")),Object(a.b)("ol",{start:2},Object(a.b)("li",{parentName:"ol"},"Description"),Object(a.b)("li",{parentName:"ol"},"Constraints"),Object(a.b)("li",{parentName:"ol"},"ConstraintDescription (String)"),Object(a.b)("li",{parentName:"ol"},"Min/MaxLength"),Object(a.b)("li",{parentName:"ol"},"Min/MaxValue"),Object(a.b)("li",{parentName:"ol"},"Defaults"),Object(a.b)("li",{parentName:"ol"},"AllowedValues (array)"),Object(a.b)("li",{parentName:"ol"},"AllowedPattern (regexp)"),Object(a.b)("li",{parentName:"ol"},"NoEcho (Boolean)")),Object(a.b)("p",null,"This can be found in the ",Object(a.b)("inlineCode",{parentName:"p"},"0-parameters-hands-on.yaml"),"."),Object(a.b)("p",null,"Again - check the docs."),Object(a.b)("p",null,"To reference a parameter, you then go with ",Object(a.b)("inlineCode",{parentName:"p"},"Key: !Ref Reference"),"."),Object(a.b)("p",null,"If you have ",Object(a.b)("inlineCode",{parentName:"p"},"!Select")," for a CommaDelimitedList, you need to go ",Object(a.b)("inlineCode",{parentName:"p"},"Key: !Select [ArrayNumber, !Ref Reference]"),"."),Object(a.b)("h2",{id:"how-to-reference-a-parameter"},"How to reference a parameter"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Using the Fn::Ref function."),Object(a.b)("li",{parentName:"ul"},"Shorthand in YAML is !Ref."),Object(a.b)("li",{parentName:"ul"},"Can reference block, not just parameter")),Object(a.b)("h2",{id:"resources"},"Resources"),Object(a.b)("p",null,"Resources are the core of your CloudFormation template. They represent the different AWS Components that will be created and configured."),Object(a.b)("p",null,"They are declared and can be references by eachother. AWS figures out creation, updates, deletes etc."),Object(a.b)("p",null,"There are over 224 types of resources."),Object(a.b)("p",null,"They are identified using the form ",Object(a.b)("inlineCode",{parentName:"p"},"AWS::aws-product-name::data-type-name"),"."),Object(a.b)("h3",{id:"reading-the-docs-for-an-es2-instance"},"Reading the docs for an ES2 Instance"),Object(a.b)("p",null,"If you look at the docs, if comes up with both JSON and YAML docs."),Object(a.b)("h3",{id:"optional-attributes-for-resources"},"Optional Attributes for Resources"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"DependsOn: very useful to draw a dependency between two resources. For example, only create an ECS cluster after creating an ASG (auto scaling group)."),Object(a.b)("li",{parentName:"ol"},"DeletionPolicy: protect resource from being deleted even if cloudformation is deleted."),Object(a.b)("li",{parentName:"ol"},"CreationPolicy: more info on CFN"),Object(a.b)("li",{parentName:"ol"},"Metadata: anything you want!")),Object(a.b)("h3",{id:"faq-for-resources"},"FAQ for resources"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Can I create a dynamic a dynamic amount of resources? No you can perform code generation. The work around is the ",Object(a.b)("inlineCode",{parentName:"li"},"troposphere")," Python library."),Object(a.b)("li",{parentName:"ol"},"Is every AWS Service supported? Almost. Only a select few niches are not there.")),Object(a.b)("h2",{id:"mappings"},"Mappings"),Object(a.b)("p",null,"What are mappings? Fixed ariables within your CF Template. Great for dev vs prod, regions, AMI types etc."),Object(a.b)("p",null,"Every mapping has top, middle and bottom."),Object(a.b)("p",null,"Great to use when you know in advance:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Region"),Object(a.b)("li",{parentName:"ul"},"AZ"),Object(a.b)("li",{parentName:"ul"},"AWSAccount"),Object(a.b)("li",{parentName:"ul"},"Environment (dev vs prod)")),Object(a.b)("p",null,"They allow safer control over the template. Use parameters when the values are ",Object(a.b)("em",{parentName:"p"},"really")," user specific."),Object(a.b)("h3",{id:"fnfindinmap---accessing-mapping-values"},"Fn::FindInMap - Accessing Mapping Values"),Object(a.b)("p",null,"Use Fn::FindInMap to return a named value from a specific key."),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"!FindInMap ","[ MapName, TopLevelKey, SecondLevelKey ]")),Object(a.b)("p",null,"Example:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWSTemplateFormatVersion: '2010-09-09'\nMappings:\n  RegionMap:\n    us-east-1:\n      '32': 'ami-6411e20d'\n      '64': 'ami-7a11e213'\nResources:\n  myEC2Instance:\n    Type: 'AWS::EC2::Instance'\n    Properties:\n      ImageId: !FindInMap [RegionMap, !Ref 'AWS::Region', 32]\n      InstanceType: m1.small\n")),Object(a.b)("h3",{id:"mappings-in-practise"},"Mappings in practise"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"Parameters:\n  EnvironmentName:\n    Description: Environment Name\n    Type: String\n    AllowedValues: [development, production]\n    ConstraintDescription: must be development or production\n\nMappings:\n  AWSRegionArch2AMI:\n    us-east-1:\n      HVM64: ami-6869aa05\n  EnvironmentToInstantType:\n    development:\n      instanceType: t2.micro\n    production:\n      instanceType: t2.small\n\nResources:\n  EC2Instance:\n    Type: AWS::EC2::Instance\n    Properties:\n      InstanceType:\n        !FindInMap [\n          EnvironmentToInstanceType,\n          !Ref 'EnvironmentName',\n          instanceType,\n        ]\n      ImageId: !FindInMap [AWSRegionArch2AMI, !Ref 'AWS::Region', HVM64]\n")),Object(a.b)("h2",{id:"concept-pseudo-parameters"},"Concept: Pseudo Parameters"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"AWS offers us pseudo params in any CF template."),Object(a.b)("li",{parentName:"ul"},"These can be used at any time and are enabled by default.")),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"AWS::AccountId"),Object(a.b)("li",{parentName:"ol"},"AWS::NotificationsARNs"),Object(a.b)("li",{parentName:"ol"},"AWS::NoValue"),Object(a.b)("li",{parentName:"ol"},"AWS::Region"),Object(a.b)("li",{parentName:"ol"},"AWS::StackId"),Object(a.b)("li",{parentName:"ol"},"AWS::StackName")),Object(a.b)("h2",{id:"cloudformation-outputs"},"CloudFormation Outputs"),Object(a.b)("p",null,"What are they? They are ",Object(a.b)("em",{parentName:"p"},"optional")," values that we can import into other stacks."),Object(a.b)("p",null,"You can also view the outputs in the AWS Console or in using the AWS CLI."),Object(a.b)("p",null,"They're very useful for example if you define a network CloudFormation, and output the variables such as VPC ID and your Subnet IDs."),Object(a.b)("p",null,"It's the best way to perform some collaboration cross stack. Let the expert handle their part and you handle yours."),Object(a.b)("h3",{id:"outputs-hands-on"},"Outputs Hands-On"),Object(a.b)("p",null,"Creating a SSH Security Group as part of one template. We can create an output that references that security group."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"Outputs:\n  <Logical ID>:\n    Description: Information about the value\n    Value: Value to return\n    Export:\n      Name: Value to export\n")),Object(a.b)("p",null,"In 0-create-ssh-security-group.yaml"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"Resources:\n  # here we define a SSH security group that will be used in the entire company\n  MyCompanyWideSSHSecurityGroup:\n    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: Enable SSH access via port 22\n      SecurityGroupIngress:\n        # we have a lot of rules because it's a perfect security group\n        # finance team network\n        - CidrIp: 10.0.48.0/24\n          FromPort: 22\n          IpProtocol: tcp\n          ToPort: 22\n          # marketing team network\n        - CidrIp: 10.0.112.0/24\n          FromPort: 22\n          IpProtocol: tcp\n          ToPort: 22\n          # application team support network\n        - CidrIp: 10.0.176.0/24\n          FromPort: 22\n          IpProtocol: tcp\n          ToPort: 22\n\nOutputs:\n  StackSSHSecurityGroup:\n    Description: The SSH Security Group for our Company\n    Value: !Ref MyCompanyWideSSHSecurityGroup\n    Export:\n      Name: SSHSecurityGroup\n")),Object(a.b)("p",null,"It is important to note that for an ",Object(a.b)("inlineCode",{parentName:"p"},"output")," to be used anywhere, you need to define an ",Object(a.b)("inlineCode",{parentName:"p"},"export")," value."),Object(a.b)("h3",{id:"cross-stack-reference"},"Cross Stack Reference"),Object(a.b)("p",null,"We use ",Object(a.b)("inlineCode",{parentName:"p"},"Fn::ImportValue")," in a simple block:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"Resources:\n  MySecureInstance:\n    # http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html\n    Type: AWS::EC2::Instance\n    Properties:\n      AvailabilityZone: us-east-1a\n      ImageId: ami-a4c7edb2\n      InstanceType: t2.micro\n      SecurityGroups:\n        # we reference the output here, using the Fn::ImportValue function\n        - !ImportValue SSHSecurityGroup\n")),Object(a.b)("h2",{id:"conditions"},"Conditions"),Object(a.b)("p",null,"Conditionals are used to control the creation of resources or outputs based on a condition."),Object(a.b)("p",null,"Conditions can be whatever you want them to be, but common ones are:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Environment (dev/test/prod)"),Object(a.b)("li",{parentName:"ul"},"AWS Region"),Object(a.b)("li",{parentName:"ul"},"Any parameter value")),Object(a.b)("p",null,"Each condition can reference another condition, parameter value or mapping."),Object(a.b)("h3",{id:"how-to-define-a-condition"},"How to define a condition?"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"Conditions:\n  [Logical ID]: [Intrinsic function]\n")),Object(a.b)("p",null,"Logical ID is for you to choose. It's how you name the condition."),Object(a.b)("p",null,"The intrinsic function (logical) can be any of the following: - Fn::And - Fn::Equals - Fn::If - Fn::Not - Fn::Or"),Object(a.b)("h2",{id:"conditional-hands-on"},"Conditional Hands On"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},'Let\'s analyze a CF template that optionally creates a volume and mount point only if "prod" is specified as a parameter.'),Object(a.b)("li",{parentName:"ul"},"It utilizes params, mappings, conditionals, outputs")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWSTemplateFormatVersion: '2010-09-09'\nMappings:\n  RegionMap:\n    us-east-1:\n      AMI: 'ami-a4c7edb2'\n      TestAz: 'us-east-1a'\n    us-west-1:\n      AMI: 'ami-6df1e514'\n      TestAz: 'us-west-1a'\n    us-west-2:\n      AMI: 'ami-327f5352'\n      TestAz: 'us-west-2a'\n    eu-west-1:\n      AMI: 'ami-d7b9a2b1'\n      TestAz: 'eu-west-1a'\n    sa-east-1:\n      AMI: 'ami-87dab1eb'\n      TestAz: 'sa-east-1a'\n    ap-southeast-1:\n      AMI: 'ami-77af2014'\n      TestAz: 'ap-southeast-1a'\n    ap-southeast-2:\n      AMI: 'ami-10918173'\n      TestAz: 'ap-southeast-2a'\n    ap-northeast-1:\n      AMI: 'ami-e21cc38c'\n      TestAz: 'ap-northeast-1a'\nParameters:\n  EnvType:\n    Description: Environment type.\n    Default: test\n    Type: String\n    AllowedValues:\n      - prod\n      - test\n    ConstraintDescription: must specify prod or test.\n\nConditions:\n  CreateProdResources: !Equals [!Ref EnvType, prod]\n\nResources:\n  EC2Instance:\n    Type: 'AWS::EC2::Instance'\n    Properties:\n      ImageId: !FindInMap [RegionMap, !Ref 'AWS::Region', AMI]\n      InstanceType: t2.micro\n      AvailabilityZone: !FindInMap [RegionMap, !Ref 'AWS::Region', TestAz]\n\n  MountPoint:\n    Type: 'AWS::EC2::VolumeAttachment'\n    Condition: CreateProdResources\n    Properties:\n      InstanceId: !Ref EC2Instance\n      VolumeId: !Ref NewVolume\n      Device: /dev/sdh\n\n  NewVolume:\n    Type: 'AWS::EC2::Volume'\n    Condition: CreateProdResources\n    Properties:\n      Size: 100\n      AvailabilityZone: !GetAtt EC2Instance.AvailabilityZone\n\nOutputs:\n  VolumeId:\n    Condition: CreateProdResources\n    Value: !Ref NewVolume\n")),Object(a.b)("p",null,"Note that ",Object(a.b)("inlineCode",{parentName:"p"},"conditions")," can not be applied to ",Object(a.b)("inlineCode",{parentName:"p"},"parameters"),"."),Object(a.b)("h2",{id:"fngetatt"},"Fn::GetAtt"),Object(a.b)("p",null,"Get an attribute attached to any resource that exists. To know the attributes, check the docs."),Object(a.b)("h2",{id:"cf-metadata"},"CF Metadata"),Object(a.b)("p",null,"This is any optional metadata section to include arbitrary YAML that provide details about the template or resource."),Object(a.b)("p",null,"There are 3 metadata keys that have special meaning:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"AWS::CloudFormation::Designer")),Object(a.b)("p",null,"Describes how the resources are laid out in your template. This is automatically added by the AWS Designer. This helps the UI (x and y)"),Object(a.b)("ol",{start:2},Object(a.b)("li",{parentName:"ol"},"AWS::CloudFormation::Interface")),Object(a.b)("p",null,"Define grouping and ordering of input parameters when they are displayed in the AWS Console."),Object(a.b)("ol",{start:3},Object(a.b)("li",{parentName:"ol"},"AWS::CloudFormation::Init")),Object(a.b)("p",null,"Define configuration tasks for cfn-init. It's the most powerful usage of the metadata. This is very important and a lot to learn about it below."),Object(a.b)("h3",{id:"awscloudformationdesigner-hands-on"},"AWS::CloudFormation::Designer hands on"),Object(a.b)("p",null,"This is automatically added for you but worth deleting for online sharing and usage. When dragging and dropping each resource you will see a huge set of metadata left there. The metadata can also be added to each resource."),Object(a.b)("h3",{id:"awscloudformationinterface-hands-on"},"AWS::CloudFormation::Interface hands on"),Object(a.b)("p",null,"Define grouping and ordering of input parameteres when they are displayed in the AWS Console. This is meant when users must input params manually."),Object(a.b)("p",null,"You provide them with grouping, or sorting, that allow them to input parameters efficiently."),Object(a.b)("p",null,"Example: Group all the EC2 related params together."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"---\nParameters:\n  KeyName:\n    Description: Name of an existing EC2 key pair for SSH access to the EC2 instance.\n    Type: AWS::EC2::KeyPair::KeyName\n  InstanceType:\n    Description: EC2 instance type.\n    Type: String\n    Default: t2.micro\n    AllowedValues:\n      - t2.micro\n      - t2.small\n      - t2.medium\n      - m3.medium\n      - m3.large\n      - m3.xlarge\n      - m3.2xlarge\n  SSHLocation:\n    Description: The IP address range that can SSH to the EC2 instance.\n    Type: String\n    MinLength: '9'\n    MaxLength: '18'\n    Default: 0.0.0.0/0\n    AllowedPattern: \"(\\\\d{1,3})\\\\.(\\\\d{1,3})\\\\.(\\\\d{1,3})\\\\.(\\\\d{1,3})/(\\\\d{1,2})\"\n    ConstraintDescription: Must be a valid IP CIDR range of the form x.x.x.x/x.\n  VPCID:\n    Description: VPC to operate in\n    Type: AWS::EC2::VPC::Id\n  SubnetID:\n    Description: Subnet ID\n    Type: AWS::EC2::Subnet::Id\n  SecurityGroupID:\n    Description: Security Group\n    Type: AWS::EC2::SecurityGroup::Id\n\nResources:\n  MyEC2Instance:\n    Type: 'AWS::EC2::Instance'\n    Properties:\n      AvailabilityZone: us-east-1a\n      ImageId: ami-a4c7edb2\n      InstanceType: !Ref InstanceType\n      SecurityGroups:\n        - !Ref SecurityGroupID\n      SubnetID: !Ref SubnetID\n\nMetadata:\n  # This is the important part\n  AWS::CloudFormation::Interface:\n    ParameterGroups:\n      - Label:\n          default: 'Network Configuration'\n        Parameters:\n          - VPCID\n          - SubnetID\n          - SecurityGroupID\n      - Label:\n          default: 'Amazon EC2 Configuration'\n        Parameters:\n          - InstanceType\n          - KeyName\n    ParameterLabels:\n      VPCID:\n        default: 'Which VPC should this be deployed to?'\n")),Object(a.b)("p",null,"If you deploy a new stack using the above, you will see that the ",Object(a.b)("inlineCode",{parentName:"p"},"Parameters")," block will then drop you to questions about what configuration you are looking for."),Object(a.b)("h2",{id:"cfn-init-and-ec2-user-data"},"CFN Init and EC2 User Data"),Object(a.b)("h3",{id:"ec2-user-data-overview"},"EC2 User Data Overview"),Object(a.b)("p",null,"Many CF templates will be about provisioning computer resources in your AWS Cloud eg. EC2 instances, autoscaling."),Object(a.b)("p",null,"Usually, you want to the instances to be self configured so that they can perform the job they are supposed to perform."),Object(a.b)("p",null,"You can fully automate the EC2 fleet with CF init."),Object(a.b)("p",null,"Example: an EC2 instance that has php and mysql installed on it."),Object(a.b)("p",null,"We want a user-data script to get this up and going. From the EC2 management console, you can basically use the advanced section to add a ",Object(a.b)("inlineCode",{parentName:"p"},"/bin/bash")," section. This is already started to become more tedious than what we want."),Object(a.b)("p",null,"How can we do this in CloufFormation?"),Object(a.b)("p",null,"The following script can use ",Object(a.b)("inlineCode",{parentName:"p"},"UserData")," to add the script:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"Parameters:\n  KeyName:\n    Description: Name of an existing EC2 key pair for SSH access to the EC2 instance.\n    Type: AWS::EC2::KeyPair::KeyName\n  SSHLocation:\n    Description: The IP address range that can be used to SSH to the EC2 instances\n    Type: String\n    MinLength: '9'\n    MaxLength: '18'\n    Default: 0.0.0.0/0\n    AllowedPattern: \"(\\\\d{1,3})\\\\.(\\\\d{1,3})\\\\.(\\\\d{1,3})\\\\.(\\\\d{1,3})/(\\\\d{1,2})\"\n    ConstraintDescription: must be a valid IP CIDR range of the form x.x.x.x/x.\n\nResources:\n  WebServer:\n    Type: AWS::EC2::Instance\n    Properties:\n      ImageId: ami-a4c7edb2\n      InstanceType: t2.micro\n      KeyName: !Ref KeyName\n      SecurityGroups:\n        - !Ref WebServerSecurityGroup\n      UserData:\n        Fn::Base64: | # everything after will be kept as is\n          #!/bin/bash\n          yum update -y\n          yum install -y httpd24 php56 mysql55-server php56-mysqlnd\n          service httpd start\n          chkconfig httpd on\n          groupadd www\n          usermod -a -G www ec2-user\n          chown -R root:www /var/www\n          chmod 2775 /var/www\n          find /var/www -type d -exec chmod 2775 {} +\n          find /var/www -type f -exec chmod 0664 {} +\n          echo \"<?php phpinfo(); ?>\" > /var/www/html/phpinfo.php\n\n  WebServerSecurityGroup:\n    Type: AWS::EC2::SecurityGroup\n    Properties:\n      GroupDescription: 'Enable HTTP access via port 80 + SSH access'\n      SecurityGroupIngress:\n        - CidrIp: 0.0.0.0/0\n          FromPort: '80'\n          IpProtocol: tcp\n          ToPort: '80'\n        - CidrIp: !Ref SSHLocation\n          FromPort: '22'\n          IpProtocol: tcp\n          ToPort: '22'\n")),Object(a.b)("p",null,"Now that we see the power of this, let's have a look at CF Init."),Object(a.b)("h3",{id:"cloudformation-init"},"CloudFormation Init"),Object(a.b)("p",null,"What is the problem with EC2 user data? Well, what happens if we have a large configuration? What if we want to evolve the state without terminating it? How do we make it readable? How do we know or signal that our EC2 user-data script actually completed successfully?"),Object(a.b)("p",null,"Amazon creating CF helper scripts."),Object(a.b)("p",null,"There are 4 python scripts that come directly with Amazon Linux AMI or can be installed using ",Object(a.b)("inlineCode",{parentName:"p"},"yum")," on non-Amazon Linux. They are:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"cfn-init: Used to retrieve and interprety the resouce metadata, installing packages, creating files and starting services."),Object(a.b)("li",{parentName:"ol"},"cfn-signal: A simple wrapper to signal an AWS CloudFormation CreationPolicy or WaitCondition, enabling you to sync other resources in the stack with the application being ready. This can give us the yes/no if succssful."),Object(a.b)("li",{parentName:"ol"},"cfn-get-metadata: A wrapper script making it easy to retrieve either all metadata defined for a resource or path to a specific key or subtree of the resource metadata."),Object(a.b)("li",{parentName:"ol"},"cfn-hup: A daemon to check for updates to metadata and execute custom hooks when the changes are detected.")),Object(a.b)("p",null,"The usual flow? cfn-init, then cfn-signal, then optionally cfn-hup."),Object(a.b)("h3",{id:"awscloudformationinit"},"AWS::CloudFormation::Init"),Object(a.b)("p",null,"A config contains the following and is executed in that order:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Packages: install a list of packages on the Linux OS (mysql, wordpress, etc)"),Object(a.b)("li",{parentName:"ol"},"Groups: define user groups"),Object(a.b)("li",{parentName:"ol"},"Users: define users, and which group they belong to"),Object(a.b)("li",{parentName:"ol"},"Sources: download an archive file and place it on the ec2 instance (tar, zip, bz2)"),Object(a.b)("li",{parentName:"ol"},"Files: create files on the ec2 instance, using inline or can be pulled from a URL"),Object(a.b)("li",{parentName:"ol"},"Commands: run a series of commands"),Object(a.b)("li",{parentName:"ol"},"Services: launch a list of sysvinit")),Object(a.b)("p",null,"You can also have multiple configs and you can run them sequentially etc."),Object(a.b)("h3",{id:"packages"},"Packages"),Object(a.b)("p",null,"You can install packages from the following repositories:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"apt"),Object(a.b)("li",{parentName:"ul"},"msi"),Object(a.b)("li",{parentName:"ul"},"python"),Object(a.b)("li",{parentName:"ul"},"rpm"),Object(a.b)("li",{parentName:"ul"},"rubygems"),Object(a.b)("li",{parentName:"ul"},"yum")),Object(a.b)("p",null,"Packages are processed in the following order: rpm, yum/apt, and then rubygems and python."),Object(a.b)("p",null,"You can also specify a version if you want."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWS::CloudFormation::Init:\n  config:\n    packages:\n      rpm:\n        epel: 'http://download....'\n      yum:\n        httpd: [] # means latest\n        php: []\n        wordpress: []\n      rubygems:\n        chef:\n          - '0.10.2' # get this version\n")),Object(a.b)("h3",{id:"groups-and-users"},"Groups and Users"),Object(a.b)("p",null,"If you want to have multiple users and groups (with optional gid) in your ec2 instance, you can add groups and users to CF and metadata."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWS::CloudFormation::Init:\n  config:\n    groups:\n      groupeOne: {}\n      groupTwo:\n        gid: '45' #gid = group ID\n    users:\n      myUser:\n        groups:\n          - 'groupOne'\n          - 'groupTwo'\n        uid: '50'\n        homeDir: '/tmp'\n")),Object(a.b)("p",null,"In the larger example..."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWS::CloudFormation::Init:\n  config:\n    groups:\n      apache: {} # assign any group ID\n    users:\n      'apache':\n        groups:\n          - 'apache' # user apache belongs to apache\n")),Object(a.b)("h3",{id:"sources"},"Sources"),Object(a.b)("p",null,"These are conveninence for a compressed archieve."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWS::CloudFormation::Init:\n  config:\n    # where to unpack and from where\n    sources:\n      '/home/ec2-user/aws-cli': 'https://github.com/aws/aws-cli/tarball/master'\n")),Object(a.b)("h3",{id:"files"},"Files"),Object(a.b)("p",null,"Files can be the most used section. Almost all the full power. It can be a specific URL or written inline for what you are doing."),Object(a.b)("p",null,"Base example:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWS::CloudFormation::Init:\n  config:\n    # where to unpack and from where\n    files:\n      /tmp/setup.mysql:\n        content: !Sub |\n          CREATE DATABASE ${DBName};\n          CREATE USER '${DBUsername}'@'localhost' IDENTIFIED BY '${DBPassword}';\n          GRANT ALL ON ${DBName}.* TO '${DBUsername}'@'localhost';\n          FLUSH PRIVILEDGES;\n        mode: '000644'\n        owner: 'root'\n        group: 'root'\n")),Object(a.b)("p",null,"Full example:"),Object(a.b)("p",null,"Note: !Sub is a function used for making substitution. ie where you see ",Object(a.b)("inlineCode",{parentName:"p"},"${AWS::StackName}"),"."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWS::CloudFormation::Init:\n  config:\n    # where to unpack and from where\n    files:\n      '/tmp/cwlogs/apacheaccess.conf':\n        content: !Sub |\n          [general]\n          state_file= /var/awslogs/agent-state\n          [/var/log/httpd/access_log]\n          file = /var/log/httpd/access_log\n          log_group_name = ${AWS::StackName}\n          log_stream_name = {instance_id}/apache.log\n          datetime_format = %d/%b/%Y:%H:%M:%S\n        mode: '000400'\n        owner: apache\n        group: apache\n      '/var/www/html/index.php':\n        content: !Sub |\n          <?php\n          echo '<h1>AWS CloudFormation sample PHP application for ${AWS::StackName}</h1>';\n          ?>\n        mode: '000644'\n        owner: apache\n        group: apache\n      '/etc/cfn/cfn-hup.conf':\n        content: !Sub |\n          [main]\n          stack=${AWS::StackId}\n          region=${AWS::Region}\n        mode: '000400'\n        owner: 'root'\n        group: 'root'\n      '/etc/cfn/hooks.d/cfn-auto-reloader.conf':\n        content: !Sub |\n          [cfn-auto-reloader-hook]\n          triggers=post.update\n          path=Resources.WebServerHost.Metadata.AWS::CloudFormation::Init\n          action=/opt/aws/bin/cfn-init -v --stack ${AWS::StackName} --resource WebServerHost --region ${AWS::Region}\n        mode: '000400'\n        owner: 'root'\n        group: 'root'\n")),Object(a.b)("h3",{id:"fnsub"},"Fn::Sub"),Object(a.b)("p",null,"(Or as !Sub) is used to substitute variables from a text. It's a very handy function that will allow you to fully customize your templates."),Object(a.b)("p",null,"For example, you can combine !Sub with References or AWS Pseudo variables."),Object(a.b)("p",null,"Must be in the form ",Object(a.b)("inlineCode",{parentName:"p"},"${VarName}"),"."),Object(a.b)("p",null,"Forms:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"# You can do this\n!Sub\n  - String\n  - { Var1Name: Var1Value, Var2Name: Var2Value }\n\n# or (more complicated and rarely seen)\n!Sub String\n")),Object(a.b)("h3",{id:"commands"},"Commands"),Object(a.b)("p",null,"You can run commands one at a time in the ",Object(a.b)("inlineCode",{parentName:"p"},"alphabetical order"),"."),Object(a.b)("p",null,"You can set a directory from which that command is run, environment variables etc."),Object(a.b)("p",null,"You can also provide a test to control whether the command is executed or not."),Object(a.b)("p",null,"This should be a last resort. You can execute any of the scripts from the above files in this section."),Object(a.b)("p",null,"Example: call the echo command only if the file doesn't exist"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"commands:\n  test:\n    command: 'echo \"$MAGIC\" > test.txt'\n    env:\n      MAGIC: 'I come from the environment!'\n    cwd: '~'\n    test: 'test ! -e ~/test.txt' # check file exists\n    ignoreErrors: 'false' # fail if is doesn't work\n")),Object(a.b)("h3",{id:"services"},"Services"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"AWS::CloudFormation::Init:\n  config:\n    services:\n      sysvinit:\n        httpd:\n          enabled: 'true'\n          ensureRunning: 'true'\n        sendmail:\n          enabled: 'false'\n          ensureRunning: 'false'\n")),Object(a.b)("h3",{id:"cfn-init-and-signal"},"CFN Init and Signal"),Object(a.b)("p",null,"First, we use ",Object(a.b)("inlineCode",{parentName:"p"},"cfn-init")," to launch the config."),Object(a.b)("p",null,"Then we use ",Object(a.b)("inlineCode",{parentName:"p"},"cfn-signal")," to tell when the config is complete, which will let CF know that the resource creation has been successful."),Object(a.b)("p",null,"This has to be used in conjuction with a ",Object(a.b)("inlineCode",{parentName:"p"},"CreationPolicy"),"."),Object(a.b)("p",null,"This example means waiting a max of 5 minutes for the instance to come online and be self configured. If we don't hear back by ",Object(a.b)("inlineCode",{parentName:"p"},"cfn-signal")," by the, CF will fail and rollback."),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"CreationPolicy:\n  ResourceSignal:\n    Timeout: PT5M\n")),Object(a.b)("p",null,"This is useful in case of a bad update."),Object(a.b)("h3",{id:"cfn-hup"},"cfn-hup"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"Cfn-hup can be used to tell your EC2 instance to look for Metadata changes every 15 minutes and apply the metadata configuration again."),Object(a.b)("li",{parentName:"ul"},"It's very powerful but you really need to try it out to understand how it works.")),Object(a.b)("p",null,'Example from the "files" declation:'),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"'/etc/cfn/cfn-hup.conf':\n  content: !Sub |\n    [main]\n    stack=${AWS::StackId}\n    region=${AWS::Region}\n  mode: '000400'\n  owner: 'root'\n  group: 'root'\n'/etc/cfn/hooks.d/cfn-auto-reloader.conf':\n  content: !Sub |\n    [cfn-auto-reloader-hook]\n    triggers=post.update\n    path=Resources.WebServerHost.Metadata.AWS::CloudFormation::Init\n    action=/opt/aws/bin/cfn-init -v --stack ${AWS::StackName} --resource WebServerHost --region ${AWS::Region}\n  mode: '000400'\n  owner: 'root'\n")),Object(a.b)("h3",{id:"cfn-init-hands-on"},"CFN Init Hands-On"),Object(a.b)("p",null,"After loading the CFN Init yaml file into CF, it will go through a series of different events."),Object(a.b)("p",null,'You can under "status reason" if there is a success message sent back.'),Object(a.b)("p",null,"You need to practise your !Init skilles. It will be extremely handy for creating EC2 Instances or AutoScaling groups."),Object(a.b)("p",null,"Remember logs for ec2-user data are in ",Object(a.b)("inlineCode",{parentName:"p"},"/var/log/cloud-init-output.log")," and logs for cfn-init are in ",Object(a.b)("inlineCode",{parentName:"p"},"/var/log/cfn-init.log"),", which is really helpful if commands don't complete like you want them to."),Object(a.b)("h2",{id:"advanced-cf-concepts"},"Advanced CF Concepts"),Object(a.b)("p",null,"Review of current standing:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"You can check AWS labs templates from ",Object(a.b)("inlineCode",{parentName:"li"},"https://github/com/awslabs/aws-cloudformation-templates")," to see what you can understand/see good practise.")),Object(a.b)("p",null,"The example with WordPress is what is shown in the course."),Object(a.b)("h3",{id:"using-the-aws-cli"},"Using the AWS CLI"),Object(a.b)("p",null,"We can use the AWS CLI to create, update or delete CF templates."),Object(a.b)("p",null,"Super conventient for when you start automating your deployments."),Object(a.b)("p",null,"Once you've downloaded the AWS config, use ",Object(a.b)("inlineCode",{parentName:"p"},"aws configure --profile <profile_name>")," to configure a profile with the ID and Secret Access key."),Object(a.b)("p",null,"To run a CF command, you can use something like the following ",Object(a.b)("inlineCode",{parentName:"p"},"aws cloudformation create-stack --stack-name example-cli-stack --template-body file://0-sample-template.yaml --parameters file://0-parameters.json --profile cf-course --region us-east-1")),Object(a.b)("p",null,"We can use the ",Object(a.b)("inlineCode",{parentName:"p"},"parameters.json")," file to set ParameterKey and ParameterValue for all the keys and values we are looking to share."),Object(a.b)("p",null,"After running the command, what you get back is the ",Object(a.b)("inlineCode",{parentName:"p"},"StackId"),"."),Object(a.b)("h3",{id:"using-troposphere-python-to-generate-cloudformation-templates"},"Using Troposphere (Python) to generate CloudFormation templates"),Object(a.b)("p",null,"Troposhere allows you to leverage Python write the templates."),Object(a.b)("p",null,"This means you can start using types in your templates for safety."),Object(a.b)("p",null,"You will also have valid CF and can dynamically generate CloudFormation."),Object(a.b)("p",null,"This means you can also have very complex conditions."),Object(a.b)("p",null,"The disadvantage is that the Python needs to generate the JSON for it to be."),Object(a.b)("h3",{id:"deletionpolicy"},"DeletionPolicy"),Object(a.b)("p",null,"This policy can prevent resources from being deleted, or in some cases, back them up before the deletion. This will help prevent doing something really, really bad."),Object(a.b)("p",null,"Deletion Policy can take up the following values:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Delete: AWS CloudFormation will delete the resource and all its content if applicable during stack deletion (does not apply to S3)"),Object(a.b)("li",{parentName:"ol"},"Retain: AWS CloudFormation keeps the resource without deleting the resource or its contents when its stack is deleted. You can add this deletion policy to any resource type."),Object(a.b)("li",{parentName:"ol"},"Snapshot: For resources that support snapshots (AWS::EC2::Volume, AWS::ElasticCache::CacheCluster etc)")),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"Resources:\n  myS3Bucket:\n    Type: AWS::S3::Bucket\n    DeletionPolicy: Retain\n")),Object(a.b)("p",null,"In the above example, it will create the S3 Bucket, you will see the bucket created."),Object(a.b)("p",null,"Now if we delete that stack and the deletion policy is retain, you will still have that bucket there."),Object(a.b)("h3",{id:"custom-resources-with-aws-lambda"},"Custom Resources with AWS Lambda"),Object(a.b)("p",null,"Custom resources enable you to write custom provisioning logic in templates that AWS CloudFormation runs anytime you create, update (if you changed the custom resource) or delete stacks."),Object(a.b)("p",null,"For example, you might want to include resources that aren't available as AWS CloudFormation resource types."),Object(a.b)("p",null,"Check online for a walkthrough of custom resources."),Object(a.b)("h3",{id:"best-practises-to-organize-your-cloudformation-templates"},"Best practises to organize your CloudFormation templates"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"How to organise templates: you can have a layered architecture (horizontal layers) vs service oriented architecture (vertical layers)."),Object(a.b)("li",{parentName:"ol"},"Use cross stack references eg. to reference a VPC or subnet."),Object(a.b)("li",{parentName:"ol"},"Make sure the template is environment agnostic to do dev / test / prod and across regions / accounts seemlessly."),Object(a.b)("li",{parentName:"ol"},"Never embed credentials (use parameters with NoEcho or KMS)."),Object(a.b)("li",{parentName:"ol"},"Use specific parameters types and constraints."),Object(a.b)("li",{parentName:"ol"},"Use CFN Init (& latest version of the helper scripts)"),Object(a.b)("li",{parentName:"ol"},"Validate templates"),Object(a.b)("li",{parentName:"ol"},"Don't do anything manual on the elements of the stack - that can cause a state mismatch."),Object(a.b)("li",{parentName:"ol"},"Verify changes with changesets (and avoid disasters)."),Object(a.b)("li",{parentName:"ol"},"Use stack policies to prevent critical components from being deleted after create (such as your most valuable RDS database).")),Object(a.b)("h3",{id:"cost-estimate-for-templates"},"Cost estimate for templates"),Object(a.b)("p",null,"You can estimate the cost of a stack very easily."),Object(a.b)("p",null,'For this, just upload the stack onto the AWS console, enter the params and click "cost".'))}s&&s===Object(s)&&Object.isExtensible(s)&&!s.hasOwnProperty("__filemeta")&&Object.defineProperty(s,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"manual/AWS/AWS-CloudFormation-MasterClass.md"}}),s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---manual-aws-aws-cloud-formation-master-class-md-197cddf0d6d0698e474d.js.map